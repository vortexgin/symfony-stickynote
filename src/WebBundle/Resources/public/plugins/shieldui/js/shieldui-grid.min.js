/* Shield UI 1.7.18 Trial Version | Copyright 2013-2015 Shield UI Ltd. | http://www.shieldui.com/eula */
!function(a,b,y,h){"use strict";function ka(a){var b,c=" ";if(a){if(D(a))return a;for(b in a)a.hasOwnProperty(b)&&(c+=b+'="'+a[b]+'"')}return c}function Ia(e,f){var b=a(e.target).closest(".sui-cell",f);if(!b.length)return null;var c=b[0].parentNode,d=b[0];return null==c||null==d?null:{row:c,cell:d}}var ha,T=b.ui.Widget,m=b.Class,U=b.DataSource,k=b.format,p=b.support,F=b.exp,A=b.get,w=b.iid,q=b.is,r=q.func,D=q.string,M=q.object,ja=q["boolean"],i=q.defined,Ga=q.number,g=q.undefined,L=q["null"],d=document,v=Math.abs,o=Math.min,n=Math.max,B=a.each,c=a.proxy,f=a.extend,I=a.map,Ca=a.grep,E=a.inArray,R=navigator.userAgent,ya=y.opera,C=/msie/i.test(R)&&!ya,z=C&&7===d.documentMode,xa=C&&8===d.documentMode,ua=(C&&10===d.documentMode,8===d.documentMode,/AppleWebKit/.test(R)),Q=(/Firefox/.test(R),"height"),ta="sui-selectable",l="sui-selected",ia="change",sa="start",oa="scroll",e="command",na="selectionChanged",W="selectstart",X="dataBound",s="mousedown",t="mousemove",G="mouseup",_="resize",j="click",ra="dblclick",ca="sort",da="detailCreated",ea="columnReorder",fa="groupsReorder",ga="group",H="ungroup",K="editorCreating",S="filterWidgetCreating",qa="getCustomFilterValue",za="clearFilter",pa="expandButtonCreate",N="cancel",J="edit",la="insert",O="save",ba="delete",P="error",aa="collapse",Z="expand",va="editWindowOpen",wa="insertWindowOpen",x="display",u="none";ha={columns:[],rowHover:!0,scrolling:!1,paging:!1,columnReorder:!1,showHeader:!0,grouping:{showGroupHeader:!1,allowDragToGroup:!1,message:"Drag a column header here to group by a column"}};var Ja=m.extend({init:function(h,d){var b,i,c,f,e,g=this;for(g._grid=d,e=0;e<h.length;e++)b=h[e],i=b.position?b.position:"top",c=a("<div class='sui-toolbar'></div>"),"top"===i?(f=d.element.find(".sui-toolbar"),f.length>0?a(f[0]).after(c):d.element.prepend(c)):(c.addClass("sui-toolbar-bottom"),c.appendTo(d.element)),b.template?g._initializeTemplate(b,c):b.buttons.length>0&&g._buildButtons(c,b)},_buildButtons:function(c,d){var a,e=this,b=d.buttons;for(a=0;a<b.length;a++)e._buildButton(b[a],c)},_buildButton:function(g,i){var h,j,d=this,f=g.commandName,e=g.click;b.ui.Button&&(h=a('<button type="button">'+g.caption+"</button>").appendTo(i),"insert"==f?e=d._insertButtonClicked:"save"==f?e=d._saveButtonClicked:"cancel"==f?e=d._cancelButtonClicked:"excel"==f?e=d._excelButtonClicked:"pdf"==f&&(e=d._pdfButtonClicked),j=new b.ui.Button(h,{cls:g.cls,events:{click:c(e,d._grid)}}))},_excelButtonClicked:function(){this._doExcelExport()},_pdfButtonClicked:function(){this._doPdfExport()},_insertButtonClicked:function(m,j){var d,h,f,i,g,a=this,k=a.options,l=k.editing.insertNewRowAt,b=a.dataSource;if(j||(i=a.trigger(e,{commandName:la,cancel:!1}),!i.cancel)){if(b.sort&&b.sort.length>0)return b.sort=[],a._sortingInProgress=!0,a.pager&&(b.skip=0,b.take=a.pager.pageSize(),a.pager.refresh(!0)),void b.read().always(c(a._toolbar._insertButtonClicked,a,m,!0));a._editingInProcess=!0,f="pagebottom"===l?n(0,a.contentTable.find("tbody > tr").length-1):0,d=b.insertView(f,{});for(g in d.fields)d.fields.hasOwnProperty(g)&&(d.data[g]=null);a._editing._insertedItems.push(d),h=a.contentTable.find("tbody > tr").eq(f),"popup"!=a.options.editing.mode?a._editing._putRowInEditMode(h,0):a._initializePopupForm(0,!0),a.trigger(la)}},_saveButtonClicked:function(f){var b,c,a=this,d=a.contentTable.find(".sui-editable-cell");return d.length>0&&(b=d.get(0).parentNode.rowIndex,a._updateItem(b,null),a._errorDuringEdit)?void(a._errorDuringEdit=!1):(c=a.trigger(e,{commandName:O,cancel:!1}),void(c.cancel||(a.dataSource.save(),a.trigger(O))))},_cancelButtonClicked:function(c){var a=this,b=a.trigger(e,{commandName:N,cancel:!1});b.cancel||(a.dataSource.cancel(),a.trigger(N))},_initializeTemplate:function(d,b){var e=this,c=d.template;if(r(c)){var a=c.call(e._grid,b);i(a)&&!L(a)&&""!==a&&b.html(a)}else b.html(c)},destroy:function(){this._grid=null}}),Aa=m.extend({init:function(b,d){var a=this;a._grid=d,a.options=b,a._eventNS=".shieldGridEditing"+w(),a._editors={},a._insertedItems=[],b.enabled&&a._initEditing(),a._grid.dataSource.on(P+a._eventNS,c(a._dsError,a))},_dsError:function(a){var b=this,c=b._editors[a.path];b._grid.trigger(P,{type:a.type,path:a.path,value:a.value,editor:c,reason:a.reason}),b._errorDuringEdit=!0},_initEditing:function(){var b=this,h=b.options,e=h.event,f=b._eventNS;g(e)||("click"===e?b._grid.element.on(j+f,".sui-cell",c(b._editingTriggered,b)):"doubleclick"===e&&b._grid.element.on(ra+f,".sui-cell",c(b._editingTriggered,b)),a(d).on(j+f,c(b._documentClicked,b)))},_editingTriggered:function(p){var k,j,c=this,h=p.target,f=a(p.target).parent(),d=f.get(0).rowIndex,n=c.options,o=n.mode,i=n.type,l=c._grid.dataSource,q=n.batch,r=c._grid.trigger(e,{commandName:J,cancel:!1,row:f,cell:h});if(!r.cancel){if(q){if(k=c._grid.contentTable.find(".sui-editable-cell"),k.length>0){if(d=k.get(0).parentNode.rowIndex,"TR"!==f.get(0).nodeName.toUpperCase()||f.get(0).rowIndex==d&&"row"==i)return;var m=c._grid._updateItem(d,h);if(c._errorDuringEdit)return c._errorDuringEdit=!1,void(m=null);j=f.get(0).rowIndex,c._grid._putRowInViewMode(d,null),!c._grid._populateInsertedItem&&m&&m.length>0&&c._grid._renderUpdateMarkers(m,d),c._grid._populateInsertedItem=!1,j===d&&(h=c._grid.contentTable.find("tbody > tr").eq(d).get(0).cells[h.cellIndex]),d=j}g(i)||"cell"===i?c._putCellInEditMode(h,d):"row"===i?c._putRowInEditMode(f,h.cellIndex):b.error("Invalid editing.type declaration. The editing.type must be 'row' or 'cell'.",this.options.dieOnError)}else if(l.tracker&&l.tracker.changes&&l.tracker.changes.added&&l.tracker.changes.added.length>0)"TR"!==f.get(0).nodeName.toUpperCase()||f.get(0).rowIndex==d&&"row"==i||l.cancel();else if(g(o)||"inline"===o){if(k=c._grid.contentTable.find(".sui-editable-cell"),k.length>0){if(d=k.get(0).parentNode.rowIndex,"TR"!==f.get(0).nodeName.toUpperCase()||f.get(0).rowIndex==d&&"row"==i)return;if(c._grid._updateItem(d,h),c._errorDuringEdit)return void(c._errorDuringEdit=!1);j=f.get(0).rowIndex,c._grid._closeAllEditedRows(),j===d&&(h=c._grid.contentTable.find("tbody > tr").eq(d).get(0).cells[h.cellIndex]),d=j}g(i)||"cell"===i?c._putCellInEditMode(h,d):"row"===i?c._putRowInEditMode(f,h.cellIndex):b.error("Invalid editing.type declaration. The editing.type must be 'row' or 'cell'.",this.options.dieOnError)}c._grid.trigger(J,{row:f,cell:h})}},_documentClicked:function(g){var e,c,b=this,h=b.options.batch,d=a(g.target);if(b._grid._editingInProcess||b._grid._preventClosingEditors)return void(b._grid._editingInProcess=!1);if(!(d.hasClass("sui-cell")||d.parents().hasClass("sui-cell")||d.parents().hasClass("sui-calendar")||d.parents().hasClass("sui-listbox"))&&(e=this._grid.contentTable.find(".sui-editable-cell"),e.length>0)){c=e.get(0).parentNode.rowIndex;var f=b._grid._updateItem(c,null);if(b._errorDuringEdit)return void(b._errorDuringEdit=!1);b._grid._putRowInViewMode(c,null),h&&!b._grid._populateInsertedItem&&f&&f.length>0&&b._grid._renderUpdateMarkers(f,c),b._grid._populateInsertedItem=!1}},_getColumnIndex:function(b){return b.cellIndex-a(b.parentNode).find(".sui-indent-cell, .sui-expand-cell, .sui-expand-cell-disabled, .sui-collapse-cell").length},_putCellInEditMode:function(b,j){var i,h,e,a=this,l=a._getColumnIndex(b),k=a._grid,f=k.dataSource,d=k.columns[l];if(d&&d.field){if(f.group&&f.group.length>0)for(h=a._grid.contentTable.find(".sui-row, .sui-alt-row"),e=0;e<h.length;e++)if(h[e]==b.parentNode){j=e;break}i=f.editView(j).data;var m=f.schema.options.fields[d.field].type,g=A(i,d.field),c=!1;if(arguments.length>2?arguments[2]==l&&(c=!0):c=!0,d.editor)a._instantiateCustomEditor(d,b,i,j,c);else switch(m){case Number:a._instantiateNumeric(b,g,c);break;case Date:a._instantiateDatePicker(b,g,c);break;case String:a._instantiateTextBox(b,g,c);break;case Boolean:a._instantiateCheckBox(b,g,c)}}},_prepareCell:function(b){a(b).empty().addClass("sui-editable-cell")},_instantiateCustomEditor:function(h,c,i,j,k,e){var f,d,g,b=this;e?d=e:(f=b._getColumnIndex(c),d=b._grid.columns[f].field,b._prepareCell(c)),g=h.editor.call(b._grid,c,i,j,k),a(c).html(g),b._editors[d]="custom"},_instantiateNumeric:function(g,k,l,j){var h,e,i,d,c=this;j?d=j:(i=c._getColumnIndex(g),d=c._grid.columns[i].field,c._prepareCell(g)),e=a("<input name='"+d+"' />"),e.appendTo(g);var m=c._grid.trigger(K,{field:d,options:{}}),n=f({},m.options,{value:k});b.ui.NumericTextBox&&(h=new b.ui.NumericTextBox(e,n),l&&h.focus(),c._editors[d]=h)},_instantiateDatePicker:function(g,k,l,j){var h,e,i,d,c=this;j?d=j:(i=c._getColumnIndex(g),d=c._grid.columns[i].field,c._prepareCell(g)),e=a("<input name='"+d+"' />"),e.appendTo(g);var m=c._grid.trigger(K,{field:d,options:{}}),n=f({},m.options,{value:k});b.ui.DatePicker&&(h=new b.ui.DatePicker(e,n),l&&h.focus(),c._editors[d]=h)},_instantiateTextBox:function(g,k,l,j){var h,e,i,d,c=this;j?d=j:(i=c._getColumnIndex(g),d=c._grid.columns[i].field,c._prepareCell(g)),e=a("<input type='text' name='"+d+"' />"),e.appendTo(g);var m=c._grid.trigger(K,{field:d,options:{}}),n=f({},m.options,{value:k,cls:"sui-input-textbox"});b.ui.TextBox&&(h=new b.ui.TextBox(e,n),l&&h.focus(),c._editors[d]=h)},_instantiateCheckBox:function(h,i,l,k){var e,g,j,d,c=this;k?d=k:(j=c._getColumnIndex(h),d=c._grid.columns[j].field,c._prepareCell(h)),g=a("<input type='checkbox' name='"+d+"' />"),g.appendTo(h);var m=c._grid.trigger(K,{field:d,options:{}}),n=f({},m.options,{value:i});b.ui.CheckBox&&(e=new b.ui.CheckBox(g,n),l&&e.focus(),e.checked(i),c._editors[d]=e)},_putRowInEditMode:function(b,g){var d,c,e=this,f=b.find(".sui-cell");for(c=0;c<f.length;c++)e._putCellInEditMode(f[c],b.get(0).rowIndex,g-b.find(".sui-indent-cell, .sui-expand-cell, .sui-expand-cell-disabled, .sui-collapse-cell").length);d=b.find(".sui-edit"),d.length>0&&e._grid._changeEditColumnButtons(b.get(0).rowIndex,a(b.find(".sui-button-cell")[0]))},_destroyRow:function(f){var a,d,b=this,e=b._grid,g=e.contentTable.find("tbody > tr").eq(f),c=e.columns;for(a=0;a<c.length;a++)d=b._editors[c[a].field],d&&(r(d.destroy)&&b._editors[c[a].field].destroy(),delete b._editors[c[a].field]);g.remove()},destroy:function(){var c,f,b=this,e=b._eventNS;if(b._grid.dataSource.off(P+e),b._grid.element.off(e,".sui-cell"),a(d).off(j+e),b._editors)for(c=0;c<b._editors.length;c++)f=b._editors[c].editor.element(),b._editors[c].editor.destroy(),f.remove();b._grid=b._errorDuringEdit=b.options=null}}),Ba=m.extend({init:function(a){var b=this;D(a)?(b.field=a,b.resizable=!0,b.sortable=!0,b.filterable=!0):M(a)&&(b.field=a.field,b.title=a.title,b.format=a.format,b.width=a.width,b.minWidth=a.minWidth,b.maxWidth=a.maxWidth,b.resizable=i(a.resizable)?!!a.resizable:!0,b.attributes=a.attributes,b.headerAttributes=a.headerAttributes,b.headerTemplate=a.headerTemplate,b.columnTemplate=a.columnTemplate,b.footerTemplate=a.footerTemplate,b.groupFooterTemplate=a.groupFooterTemplate,b.buttons=a.buttons,b.editor=a.editor,b.customFilter=a.customFilter,b.sortable=i(a.sortable)?!!a.sortable:!0,b.filterable=i(a.filterable)?!!a.filterable:!0),b.visible=!0},destroy:function(){var a=this;a.buttons&&(a.buttons.length=0),a.field=a.title=a.editor=a.format=a.width=a.minWidth=a.maxWidth=a.resizable=a.attributes=a.headerAttributes=a.headerTemplate=a.buttons=a.customFilter=a.footerTemplate=a.groupFooterTemplate=a.sortable=a.filterable=a.columnTemplate=null}}),Y=m.extend({options:{ns:".shieldGridColumnResizing",width:12,offset:6,min:12},init:function(b){var a=this;a.grid=b,a.options=f(!0,{},Y.fn.options),a._eventNS=a.options.ns+w(),b.headerTable.on(t+a._eventNS,".sui-headercell",c(a._showHandle,a))},_showHandle:function(h){if(!this.resizing){var d=this,g=d.options,e=(d.grid,d.handle),f=h.pageX,b=d.params=d._params(a(h.currentTarget)),i=f>=b.offset.left&&f<=b.offset.left+g.offset&&b.headerIndex>0;b.isRtl&&(i=f>=b.offset.left+b.width-g.offset&&f<=b.offset.left+b.width&&b.headerIndex>0),i&&(b=d.params=d._params(b.header.prev())),b.column&&b.column.resizable&&(f>=b.threshold&&f<=b.edge+g.offset?(e||(e=d.handle=a('<div class="sui-resizable-handle"/>').on(s+d._eventNS,c(d._down,d)).appendTo(b.header.parents(".sui-headercontent"))),e.css({top:b.position.top,left:e.parent()[0].scrollLeft+b.handleLeft,width:g.width,height:b.height}).show()):e&&e.hide())}},_params:function(a){var f=this,b=f.options,j=a.offset(),h=a.position(),d=p.isRtl(f.grid.element),e=a.outerWidth(),i=j.left+(d?b.width:e),l=a.index(),g=a.parent().children("th.sui-headercell").index(a),c=g>-1?f.grid.columns[g]:null,k=c?c.minWidth>=0?+c.minWidth:b.min:null,m=c&&c.maxWidth>=k?+c.maxWidth:null;return{header:a,headerIndex:l,colIndex:g,column:c,min:k,max:m,offset:j,isRtl:d,width:e,current:e,height:a.outerHeight(),edge:i,threshold:i-b.width+(d?-1:1)*b.offset,position:h,handleLeft:h.left+(d?b.width:e)-b.width+(d?-1:1)*b.offset}},_down:function(h){var g,e=this,i=e.grid,f=e.params;if(!(h.button>1)&&f)return g="> colgroup col:nth-child("+(f.headerIndex+1)+")",f.origin=h.pageX,f.cols=a().add(i.headerTable.find(g)).add(i.contentTable.find(g)),e.resizing=!0,e.handle.hide(),a(d).on(t+e._eventNS,c(e._move,e)).on(G+e._eventNS,c(e._up,e)),b.selection(!1),!1},_move:function(d){var c=this,a=c.params,e=(a.isRtl?-1:1)*(d.pageX-a.origin),b=n(a.width+e,a.min);return a.max&&(b=o(b,a.max)),c.resizing?void(b!==a.current&&a.cols.width(a.current=b)):void c._up()},_up:function(){var c=this,e=c.grid,f=c.params.colIndex,g=c.params.current,h=e.columns[f]||{},i=(e.options.columns||[])[f]||{};c.resizing=!1,c.params=null,h.width=i.width=g+"px",a(d).off(c._eventNS),b.selection(!0)},destroy:function(){var a=this;a._up(),a.grid.headerTable.off(a._eventNS),a.grid=null,a.handle&&(a.handle.off(a._eventNS).remove(),a.handle=null)}}),Da=m.extend({init:function(b){var a=this;a.grid=b,a._filters={},a._eventNS=".shieldGridFiltering"+w(),a._createFilterRow()},_createFilterRow:function(){var o,k,h,g,b,f=this,i=f.grid,q=i.headerTable,n=q.find(">thead"),m=a("<tr class='sui-filter-row' />"),p=n.find(".sui-indent-cell").length,l=i.dataSource.schema,e=i.columns;for(b=0;p>b;b++)a('<th class="sui-indent-cell">').appendTo(m);for(l&&l.options.fields&&(g=l.options.fields),b=0;b<e.length;b++)o=g&&g[e[b].field]?g[e[b].field].type:null,k=e[b].field?e[b].field.replace(/[\"\']/g,"@"):"",h=a('<th class="sui-filter-cell"  data-field="'+k+'"/>').appendTo(m),e[b].filterable!==!1&&k.length>0&&(f._initializeEditor(h,o,e[b].field,e[b]),f._appendFilterButton(h));m.appendTo(n),a(d).on(j+f._eventNS,c(f._documentClicked,f))},_documentClicked:function(e){var c,f,d=this;if(d.listBox&&!a(e.target).hasClass("sui-filter-button")&&!a(e.target).hasClass("sui-filter-button-content")){var b=d.listBox.element.parent();if("none"==b.css("display"))return;d._filterByField=null,c=b.height(),f=b.offset().top,d._slideUp?b.animate({height:0,top:f+c},150,function(){b.css({display:u,height:c})}):b.animate({height:0},150,function(){b.css({display:u,height:c})})}},_appendFilterButton:function(d){if(b.ui.Button){var e=a('<button type="button"><span class="sui-sprite sui-filter-button-content"></span></button>').appendTo(d);new b.ui.Button(e,{cls:"sui-filter-button",events:{click:c(this._filterButtonClicked,this)}})}},_filterButtonClicked:function(g){var l,h,p,e=this,n=e.grid,m=n.dataSource.schema,i=n.options.filtering,o=i.stringFunc?i.stringFunc:[{func:"eq",name:"Equal to"},{func:"neq",name:"Not equal to"},{func:"con",name:"Contains"},{func:"notcon",name:"Not contains"},{func:"starts",name:"Starts with"},{func:"ends",name:"Ends with"},{func:"gt",name:"Greater than"},{func:"lt",name:"Less than"},{func:"gte",name:"Greater than or equal"},{func:"lte",name:"Less than or equal"},{func:"isnull",name:"Is null"},{func:"notnull",name:"Is not null"}],q=i.nonStingFunc?i.nonStingFunc:[{func:"eq",name:"Equal to"},{func:"neq",name:"Not equal to"},{func:"gt",name:"Greater than"},{func:"lt",name:"Less than"},{func:"gte",name:"Greater than or equal"},{func:"lte",name:"Less than or equal"},{func:"isnull",name:"Is null"},{func:"notnull",name:"Is not null"}],k=g.target.element.parent().attr("data-field").replace(/[@]/g,"'");if(e._filterByField=k,m&&m.options.fields){var j=m.options.fields;l=j&&j[k]&&j[k].type===String?o:q}else l=o;b.ui.ListBox&&(e.listBox||(e._menuWrapper=a('<div style="display: none;" />').appendTo(d.body),e.listBox=new b.ui.ListBox(e._menuWrapper,f({},{},{dataSource:{data:l},textTemplate:"{name}",valueTemplate:"{func}",multiple:!1,width:150,maxHeight:300,events:{select:c(e._selectFilterFunction,e)}})),e.grid.element.parent().hasClass("sui-rtl")?e.listBox.element.parent().addClass("sui-rtl"):e.listBox.element.parent().css(x,u)),h=e.listBox.element.parent().height(),e._positionListBox(g),e._slideUp?(p=g.target.element.offset().top-h,e.listBox.element.parent().css({top:g.target.element.offset().top}),e.listBox.element.parent().animate({height:h,top:p-e.listBox.element.parent().innerHeight()},150)):e.listBox.element.parent().animate({height:h},150)),e._selectFilterMenuValue()},_selectFilterMenuValue:function(){var a,e,b=this,f=b._filterByField,c=b.grid.dataSource.filter;if(c&&c.and&&c.and.length>0){a=c.and;for(var d=0;d<a.length;d++)a[d].path===f&&(e=a[d].filter)}e?b.listBox.values(e):b.listBox.clearSelection()},_selectFilterFunction:function(i){var c,g,a=this,h=!0,b="@@custom"==a._filters[a._filterByField]?"@@custom":a._filters[a._filterByField].value(),d=i.item.func,e={path:a._filterByField,filter:d,value:b};if("@@custom"==b&&(g=a.grid.trigger(qa,{field:a._filterByField,value:null}),b=g.value,e={path:a._filterByField,filter:d,value:b}),""!==b&&null!==b||"notnull"==d||"isnull"==d){if(a.grid.dataSource.filter&&a.grid.dataSource.filter.and){c=a.grid.dataSource.filter.and;for(var f=0;f<c.length;f++)c[f].path===a._filterByField&&(c[f]=e,h=!1);h&&c.push(e)}else a.grid.dataSource.filter={and:[e]};a.grid.dataSource.read(),a._addRemoveFilterButton()}},_addRemoveFilterButton:function(){var d,e,g,h=this;if(b.ui.Button){d=h.grid.headerTable.find(".sui-filter-row > th");for(var f=0;f<d.length;f++)if(e=a(d[f]),e.attr("data-field")&&e.attr("data-field").replace(/[@]/g,"'")==h._filterByField){g=d[f];break}if(0===e.find(".sui-clear-filter-button").length){var i=a('<button type="button"><span class="sui-sprite sui-clear-filter-button-content"></span></button>').appendTo(g);new b.ui.Button(i,{cls:"sui-clear-filter-button",events:{click:c(this._clearFilterButtonClicked,this)}})}}},_clearFilterButtonClicked:function(d){for(var f,a=this,b=d.target.element.parent().attr("data-field").replace(/[@]/g,"'"),e=a.grid.dataSource.filter.and,c=0;c<e.length;c++)e[c].path==b&&e.splice(c,1);f=d.target.element,d.target.destroy(),f.remove(),"@@custom"!=a._filters[b]?a._filters[b].value(null):a.grid.trigger(za,{field:b,value:null}),a.grid.dataSource.read()},_positionListBox:function(i){var a=this,d=i.target.element,e=d.offset(),b=e.top,c=e.left,g=a.listBox.element.parent().innerWidth(),h=a.listBox.element.parent().innerHeight(),f=(d.innerWidth(),d.innerHeight());0>c&&(c=1),c+g>y.innerWidth&&(c=y.innerWidth-g-20),a._slideUp=!1,b+h>y.innerHeight&&(b-=h,f=0,a._slideUp=!0),0>b&&(b=e.top,f=d.innerHeight(),a._slideUp=!1),a.listBox.element.parent().css({position:"absolute",zIndex:10002,top:b+f,left:c,height:0,display:""})},_initializeEditor:function(b,e,c,d){var a=this;if(d.customFilter)a._filters[c]="@@custom",d.customFilter.call(a,b);else switch(e){case Number:a._instantiateNumeric(b,c);break;case Date:a._instantiateDatePicker(b,c);break;case String:a._instantiateTextBox(b,c);break;default:a._instantiateTextBox(b,c)}},_instantiateNumeric:function(h,c){var d,e=this,g=a("<input />");g.appendTo(h);var i=e.grid.trigger(S,{field:c,options:{}}),j=f({},i.options);b.ui.NumericTextBox&&(d=new b.ui.NumericTextBox(g,j),e._filters[c]=d)},_instantiateDatePicker:function(h,c){var d,e=this,g=a("<input />");g.appendTo(h);var i=e.grid.trigger(S,{field:c,options:{}}),j=f({},i.options);b.ui.DatePicker&&(d=new b.ui.DatePicker(g,j),e._filters[c]=d)},_instantiateTextBox:function(h,c){var d,e=this,g=a("<input type='text' />");g.appendTo(h);var i=e.grid.trigger(S,{field:c,options:{}}),j=f({},i.options);b.ui.TextBox&&(d=new b.ui.TextBox(g,j),e._filters[c]=d)},destroy:function(){var c,b=this;b.grid=null;for(c in b._filters)b._filters.hasOwnProperty(c)&&(b._filters[c].destroy(),b._filters[c]=null);b.listBox&&(b.listBox.destroy(),b.listBox=null),a(d).off(j+b._eventNS),b._filterByField=b._filters=b._slideUp=b._menuWrapper=null}}),Ea=m.extend({init:function(b,c){var a=this;a.grid=c,a.sortExpressions=[],a._eventNS=".shieldGridSorting"+w(),ja(b)?(a.allowUnsort=!0,a.multiple=!1,a.firstAscending=!0,a.ascText="&#9650;",a.descText="&#9660;"):M(b)&&(a.allowUnsort=g(b.allowUnsort)?!0:b.allowUnsort,a.multiple=b.multiple,a.firstAscending=g(b.firstAscending)?!0:b.firstAscending,a.ascText=g(b.ascText)?"&#9650;":b.ascText,a.descText=g(b.descText)?"&#9660;":b.descText),a._initialize()},destroy:function(){var b=this;b.allowUnsort=b.multiple=b.sortExpressions=null,b.length=0,b._click&&(b.grid.headerTable.find(".sui-link").each(function(){a(this).off(j+b._eventNS)}),b._click=null),b.grid=null},_initialize:function(){var b=this,h=b.grid,f=h.dataSource.sort,e=h.columns,i=h.headerTable.find(".sui-headercell");if(b._click=c(b._clickHandler,b),i.each(function(d){var c=a(this),f=c.html();e[d].sortable!==!1&&(c.empty(),a('<a href="#" class="sui-link"></a>').appendTo(c).html(f).on(j+b._eventNS,b._click))}),f)for(var g=0;g<f.length;g++)for(var o=f[g],d=0;d<e.length;d++)if(e[d].sortable!==!1&&o.path==e[d].field){var l=a(i[d]).find(".sui-link"),m="ascending",n="sui-asc",k=b.ascText;o.desc&&(m="descending",k=b.descText,n="sui-desc"),l.addClass(n),a('<span class="sui-'+m+'">'+k+"</span>").appendTo(l)}},_clickHandler:function(f){var b=this,d=a(f.target).closest(".sui-link"),e=b.grid,g=E(d.parent().get(0),e.headerTable.find(".sui-headercell")),c=e.columns[g];return d.hasClass("sui-desc")?b.allowUnsort&&b.firstAscending?b._sortInternal(c,!0,!0):b._sortInternal(c,!1,!1):d.hasClass("sui-asc")?b.allowUnsort&&!b.firstAscending?b._sortInternal(c,!1,!0):b._sortInternal(c,!0,!1):b.firstAscending?b._sortInternal(c,!1,!1):b._sortInternal(c,!0,!1),!1},_sortInternal:function(d,c,f){var h=this,g=h.grid,i=g.dataSource,b=i.sort,k=g.trigger(e,{commandName:ca,cancel:!1,column:d,desc:c,unsort:f});if(!k.cancel){if(b){if(!h.multiple&&b)b.length=0;else{var j=a.grep(b,function(a){return a.path===d.field&&a.desc===(f?c:!c)});if(j.length>0){var l=E(j[0],b);b.splice(l,1)}}f||b.push({path:d.field,desc:c})}else f||(b=i.sort=[{path:d.field,desc:c}]);g._refreshOnSort(),g.trigger(ca,{column:d,desc:c,unsort:f})}},_sort:function(c,f,h){var d,e,l=this,g=l.grid,k=g.dataSource,b=k.sort;if(b&&(d=a.grep(b,function(a){return a.path===c&&a.desc===f})),!d||d.length<=0)if(!l.multiple&&b&&(b.length=0),b){var i=!1,j=a.grep(b,function(a){return a.path===c&&a.desc!=f});j&&j.length>0&&(e=E(j[0],b),b.splice(e,1),i=!0),h||(b.push({path:c,desc:f}),i=!0),i&&g._refreshOnSort()}else h||(k.sort=[{path:c,desc:f}],g._refreshOnSort());else h&&(e=E(d[0],b),b.splice(e,1),g._refreshOnSort())}}),Fa=m.extend({init:function(i,f,e,j){var h,b=this;h=b._eventNS=".shieldGridSelection"+w(),ja(e)?(b.type="row",b.multiple=!1,b.toggle=!1,b.spreadsheet=!0):M(e)&&(b.type=e.type?e.type:"row",b.multiple=e.multiple,b.toggle=e.toggle?e.toggle:!1,b.spreadsheet=g(e.spreadsheet)?!0:e.spreadsheet),b.parentGrid=j,f.addClass(ta),i.addClass("sui-non-selectable"),b.table=f,b.lastSelected=null,f.on(s+h,c(b._mouseDownHandler,b)),f.on(t+h,c(b._mouseMoveHandler,b)),a(d).on(G+h,c(b._mouseUpHandler,b)),C&&f.on(W+h,function(){return!1}),b.multiple&&(b.area=a(d.createElement("span")),b.area.addClass("sui-area sui-area-color"))},destroy:function(){var a=this,b=a._eventNS;a.parentGrid=null,a.type=null,a.multiple=null,a.lastSelected=null,a.toggle=null,a.spreadsheet=null,a.table.off(b),a.x=null,a.y=null,a.table.off(W+b),a.elements=null,a.table=null,a.area&&(a.area.remove(),a.area=null)},select:function(b){var c=this;return b?void b.each(function(){c._selectElement(a(this))}):c.table.find("."+l)},clear:function(){var a=this;"row"==a.type?a._clearSelectedRows():a._clearSelectedCells()},_getParentTable:function(a){return a?"TABLE"==a[0].nodeName.toUpperCase()?a[0]:a.parent()?this._getParentTable(a.parent()):void 0:void 0},_mouseDownHandler:function(g){var e=this,h=g.pageX,i=g.pageY,f=a(g.target);e.x=h,e.y=i,("TD"!=f[0].nodeName.toUpperCase()||e._getParentTable(f)==e.table[0])&&(!(f.hasClass("sui-cell")||f.hasClass("sui-row")||f.hasClass("sui-alt-row"))||f.hasClass("sui-detail-cell")||f.hasClass("sui-detail-row")||f.hasClass("sui-collapse-cell")||f.hasClass("sui-expand-cell")||f.hasClass("sui-expand-cell-disabled")||f.hasClass("sui-indent-cell")||(e.multiple&&e.area.appendTo(d.body).css({left:h+1,top:i+1,width:0,height:0}),a(d).on(t+e._eventNS,c(e._mouseMoveHandler,e)),b.selection(!1),e.elements=Ia(g,e.table)))},_mouseMoveHandler:function(b){var a=this,c=b.pageX,d=b.pageY,e=a.x,f=a.y,g={left:e>c?c:e,top:f>d?d:f,width:v(c-a.x),height:v(d-a.y)};a.multiple&&a.area.css(g),b.preventDefault()},_mouseUpHandler:function(m){var f,h,q,g,c=this,j=c.parentGrid,p=m.ctrlKey,k=c.area,n=c.elements,i=[],l=[],o=[];if(a(d).off(t+c._eventNS),b.selection(!0),n){for(c.elementsToBeSelected=[],"row"==c.type?c._performRowSelection(k,p,n,m):c._performCellSelection(k,p,n,m),g=0;g<c.elementsToBeSelected.length;g++)f=c.elementsToBeSelected[g],!(f.hasClass("sui-cell")||f.hasClass("sui-row")||f.hasClass("sui-alt-row"))||f.hasClass("sui-detail-cell")||f.hasClass("sui-detail-row")||f.hasClass("sui-collapse-cell")||f.hasClass("sui-expand-cell")||f.hasClass("sui-expand-cell-disabled")||f.hasClass("sui-indent-cell")||(i.push(f),h=j._getRowIndex("row"==c.type?f:a(f).parent()),l.push(h),o.push(h>=0?j.dataSource.getDataIndex(h):h));if(q=j.trigger(e,{commandName:na,cancel:!1,toBeSelected:i,viewIndices:l,indices:o}),!q.cancel){for(g=0;g<i.length;g++)c._selectElement(i[g]);j.trigger(na,{selected:i,viewIndices:l,indices:o}),c.elements=null}}k&&k.remove()},_performRowSelection:function(e,f,d,b){var c=this;if(!(a(b.target).hasClass("sui-expand-cell")||a(b.target).hasClass("sui-expand-cell-disabled")||a(b.target).hasClass("sui-collapse-cell")||a(b.target)&&a(b.target).parent()&&(a(b.target).parent().hasClass("sui-expand-cell")||a(b.target).parent().hasClass("sui-expand-cell-disabled")||a(b.target).parent().hasClass("sui-collapse-cell"))))if(e&&0===e.height()&&0===e.width())c.multiple?c._processMultiRowSelection(b,d):c._processSingleRowSelection(b,d);else if(c.multiple){var h=c.table.find(">tbody > tr"),g=null;B(h,function(f,c){var d=a(c),e=d.offset().top;e<b.pageY&&(g=c.rowIndex)}),f||c._clearSelectedRows(),c._selectRowRange(d.row.rowIndex,g,f)}else c._processSingleRowSelection(b,d)},_performCellSelection:function(f,h,g,b){var c=this;if(!(a(b.target).hasClass("sui-expand-cell")||a(b.target).hasClass("sui-expand-cell-disabled")||a(b.target).hasClass("sui-collapse-cell")||a(b.target)&&a(b.target).parent()&&(a(b.target).parent().hasClass("sui-expand-cell")||a(b.target).parent().hasClass("sui-expand-cell-disabled")||a(b.target).parent().hasClass("sui-collapse-cell"))))if(f&&0===f.height()&&0===f.width())c.multiple?c._processMultiCellSelection(b,g):c._processSingleCellSelection(b,g);else if(c.multiple){var d,i=c.table.find(">tbody > tr > td"),e=[];for(B(i,function(u,j){var d=a(j),r=d.get(0).clientWidth,t=d.get(0).clientHeight,g=d.offset().top,h=d.offset().left,p=g+t,m=h+r,k=o(b.pageX,c.x),q=n(b.pageX,c.x),l=o(b.pageY,c.y),s=n(b.pageY,c.y),i=!1,f=!1;l>g?p>l&&(i=!0):s>g&&(i=!0),k>h?m>k&&(f=!0):q>h&&(f=!0),i&&f&&e.push(j)}),h||c._clearSelectedCells(),d=0;d<e.length;d++){var j=a(e[d]);j.hasClass(l)?c._deselectElement(a(e[d])):c.elementsToBeSelected.push(a(e[d]))}}else c._processSingleCellSelection(b,g)},_selectRowRange:function(e,f,g){var b,c,d=this,h=o(e,f),i=n(e,f),j=d.table.find(">tbody > tr");for(b=h;i>=b;b++)c=a(j[b]),g&&c.hasClass(l)?d._deselectElement(c):d.elementsToBeSelected.push(c)},_clearSelectedRows:function(){var b=this,c=b.table.find(">tbody>tr."+l);B(c,function(d,c){b._deselectElement(a(c))})},_clearSelectedCells:function(){var b=this,c=b.table.find(">tbody > tr > td."+l);B(c,function(d,c){b._deselectElement(a(c))})},_processSingleRowSelection:function(h,d){var b=this,e=(b.table,b.toggle),f=b.multiple,c=a(d.row),g=c.hasClass(l);f||b._clearSelectedRows(),e?g?b._deselectElement(c):b.elementsToBeSelected.push(c):(b._clearSelectedRows(),b.elementsToBeSelected.push(c)),b.lastSelected=c},_processMultiRowSelection:function(f,g){var b=this,r=b.table,j=f.ctrlKey,k=f.shiftKey,c=a(g.row);if(j)c.hasClass(l)?(b._deselectElement(c),b.lastSelected=c):(b.elementsToBeSelected.push(c),b.lastSelected=c);else if(k){b.table.find(">tbody tr."+l);if(b.lastSelected){var s=b.lastSelected,d=s.get(0).rowIndex,h=r.find(">tbody > tr"),i=c.get(0).rowIndex,p=o(i,d),q=n(i,d);b._clearSelectedRows();for(var e=p;q>=e;e++)if(e!==d){var m=a(h[e]);b.elementsToBeSelected.push(m)}b.elementsToBeSelected.push(a(h[d]))}else b.elementsToBeSelected.push(c),b.lastSelected=c}else b._processSingleRowSelection(f,g)},_processSingleCellSelection:function(h,d){var b=this,e=(b.table,b.toggle),f=b.multiple,c=a(d.cell),g=c.hasClass(l);b.lastSelected;f||b._clearSelectedCells(),e?g?b._deselectElement(c):b.elementsToBeSelected.push(c):(b._clearSelectedCells(),b.elementsToBeSelected.push(c)),b.lastSelected=c},_processMultiCellSelection:function(h,v){var b=this,A=b.table,w=h.ctrlKey,x=h.shiftKey,c=a(v.cell);if(w)c.hasClass(l)?(b._deselectElement(c),b.lastSelected=c):(b.elementsToBeSelected.push(c),b.lastSelected=c);else if(x)if(b.lastSelected){var d,j=b.lastSelected,s=b.table.get(0),q=s.rows[0].cells.length,m=j.parent().get(0).rowIndex,e=m*q+j.get(0).cellIndex,r=A.find(">tbody > tr > td"),k=c.parent().get(0).rowIndex,t=k*q+c.get(0).cellIndex,g=o(t,e),i=n(t,e);if(b._clearSelectedCells(),b.spreadsheet){var p=j[0].cellIndex,u=c[0].cellIndex;g=o(p,u),i=n(p,u);var y=o(m,k),z=n(m,k);for(d=y;z>=d;d++){var f,B=s.rows[d];for(f=g;i>=f;f++)b.elementsToBeSelected.push(a(B.cells[f]))}}else for(d=g;i>=d;d++)if(d!==e){var C=a(r[d]);b.elementsToBeSelected.push(C)}b.elementsToBeSelected.push(a(r[e]))}else b.elementsToBeSelected.push(c),b.lastSelected=c;else b._processSingleCellSelection(h,v)},_selectElement:function(a){a.addClass(l)},_deselectElement:function(a){a.removeClass(l)}}),ma=m.extend({options:{ns:".shieldGridGroupReorder",returnDuration:50,returnEasing:"ease-out",dragTreshold:20,draggedTemplate:"<div style='border-color:transparent;' class='sui-grid sui-grid-core'><div class='sui-group-panel-indicator'><span class='sui-group-title'>{0}</span><span class='sui-group-close-button'></span></div></div>"},init:function(b){var a=this;a.grid=b,a.options=f(!0,{},ma.fn.options),a._eventNS=a.options.ns+w(),a._events(!0)},_events:function(d){var a=this,b=a.grid.element;d?(a._downProxy=c(a._down,a),b.on(s+a._eventNS,".sui-group-panel-indicator",a._downProxy)):(b.off(s+a._eventNS,".sui-group-panel-indicator",a._downProxy),a._downProxy=null)},_down:function(g){var e=this,f=a(g.target).closest(".sui-group-panel-indicator"),i=f.offset(),h=e.grid.element,j=h.offset(),k=g.pageX,l=g.pageY;return e.dataField=f.attr("data-field"),g.button>1?void 0:(e._moveProxy=c(e._move,e),e._upProxy=c(e._up,e),a(d).on(t+e._eventNS,e._moveProxy).on(G+e._eventNS,e._upProxy),e.start={left:k-i.left,top:l-i.top,x:k,y:l,target:f,index:f.parent().find(".sui-group-panel-indicator").index(f),positions:e._positions(f),gridPosition:{left:j.left,top:j.top,width:h.outerWidth(),height:h.outerHeight()},isRtl:p.isRtl(h)},b.selection(!1),!1)},_move:function(g){var c=this,h=c.options,i=c.dragged,b=c.start,e=g.pageX,f=g.pageY,j=h.dragTreshold;i?(i.css({left:e-b.left,top:f-b.top}),c.hovered=c._index(e,f),c._indicator()):(v(b.x-e)>j||v(b.y-f)>j)&&(c.dragged=a(k(h.draggedTemplate,b.target.html())).css({position:"absolute",left:e-b.left,top:f-b.top,zIndex:999}).find("table").css("width","auto").end().find("th").attr("style",b.target[0].style.cssText).css({width:b.target.width(),height:b.target.height()}).end().appendTo(d.body))},_positions:function(f){
var a,c,d=f.parent().children(".sui-group-panel-indicator"),b=0,e=[];for(b;b<d.length;b++)a=d.eq(b),c=a.offset(),e.push({left:c.left,top:c.top,width:a.outerWidth(),height:a.outerHeight()});return e},_index:function(d,e){var a,c,g,h,f=this.start,b=f.gridPosition;for(c=0;c<f.positions.length;c++)if(a=f.positions[c],g=a.left<=d&&d<=a.left+a.width&&a.top<=e&&e<=a.top+a.height,h=b.left<=d&&d<=b.left+b.width&&b.top<=e&&e<=b.top+b.height,g&&h)return c;return-1},_indicator:function(){var h,f=this,b=f.start,c=f.hovered,g=b.positions[c],e=f.reorderIndicator,j=b.gridPosition.left,k=b.gridPosition.left+b.gridPosition.width,i=b.target.parent().children(".sui-group-panel-indicator"),l=b.isRtl?b.index<c:b.index>c;i.removeClass("sui-reorder-target"),e&&e.hide(),null!=c&&c>-1&&(i.eq(c).addClass("sui-reorder-target"),e||(e=f.reorderIndicator=a("<div class='sui-grid-reorder-indicator'><span class='sui-grid-indicator-top' /><span class='sui-grid-indicator-bottom' /></div>").appendTo(d.body)),c!==b.index&&(h=g.left+(l?0:g.width),e.css({left:o(n(j,h),k),top:g.top,height:g.height}).show()))},_up:function(q){var f,c=this,n=c.options,g=c.grid,k=c.dragged,m=c.start,h=c.hovered,l=c.dataField;if(c._detachDocumentEvents(),k)if(null!=h&&h>-1){if(k.remove(),f=g.trigger(e,{commandName:fa,cancel:!1,index:m.index,newIndex:h}),!f.cancel)for(var i=g.dataSource.group,j=0;j<i.length;j++)if(i[j].field==l){var o=i[j];i[j]=i[h],i[h]=o;break}}else setTimeout(function(){k.remove()},p.transitions?n.returnDuration:0),c.grid.dataSource.group&&(f=g.trigger(e,{commandName:H,cancel:!1,field:l}),f.cancel||(c.grid.ungroup(l),g.trigger(H,f)));c.dragged=c.dataField=c.hovered=h=null,c._indicator(),c.reorderIndicator&&(c.reorderIndicator.remove(),c.reorderIndicator=null),c.start=null,a(d).off(c._eventNS),b.selection(!0),f&&!f.cancel&&(delete f.cancel,delete f.commandName,g.dataSource.read(),g.trigger(fa,f))},_detachDocumentEvents:function(){var b=this;b._moveProxy=b._upProxy=null,a(d).off(b._eventNS)},destroy:function(){var a=this;a.dataField=null,a._detachDocumentEvents(),a._events(!1)}}),Ha=m.extend({options:{ns:".shieldGridColumnGroupReorder",returnDuration:150,returnEasing:"ease-out",dragTreshold:20,draggedTemplate:"<div class='sui-grid sui-grid-core'><div class='sui-gridheader'><table class='sui-table'><thead><tr class='sui-columnheader'><th class='sui-headercell'>{0}</th></tr></thead></table></div></div>"},init:function(b){var a=this;a.grid=b,a.options=f(!0,{},V.fn.options),a._eventNS=a.options.ns+w(),a._events(!0),b.headerTable.addClass("sui-reorderable")},_events:function(d){var a=this,b=a.grid.element;d?(a._downProxy=c(a._down,a),b.on(s+a._eventNS,".sui-headercell",a._downProxy)):(b.off(s+a._eventNS,".sui-headercell",a._downProxy),a._downProxy=null)},_down:function(f){var e=this,g=a(f.target).closest(".sui-headercell"),m=g.offset(),h=e.grid.element,n=h.offset(),k=f.pageX,l=f.pageY;if(!(f.button>1)){var o=g.attr("data-field"),j=e.grid.dataSource.group;if(j)for(var i=0;i<j.length;i++)if(o===j[i].field)return;return a(d).on(t+e._eventNS,c(e._move,e)).on(G+e._eventNS,c(e._up,e)),e.start={left:k-m.left,top:l-m.top,x:k,y:l,target:g,index:1e3,positions:e._positions(g),gridPosition:{left:n.left,top:n.top,width:h.outerWidth(),height:h.outerHeight()},isRtl:p.isRtl(h)},b.selection(!1),!1}},_move:function(g){var c=this,h=c.options,i=c.dragged,b=c.start,e=g.pageX,f=g.pageY,j=h.dragTreshold;i?(i.css({left:e-b.left,top:f-b.top}),c.hovered=c._index(e,f),c._indicator()):(v(b.x-e)>j||v(b.y-f)>j)&&(c.dragged=a(k(h.draggedTemplate,b.target.html())).css({position:"absolute",left:e-b.left,top:f-b.top,zIndex:999}).find("table").css("width","auto").end().find("th").attr("style",b.target[0].style.cssText).css({width:b.target.width(),height:b.target.height()}).end().appendTo(d.body))},_positions:function(f){var a,b,d=this.grid.element.find(".sui-group-panel-indicator"),c=0,e=[];for(c;c<d.length;c++)a=d.eq(c),b=a.offset(),e.push({left:b.left,top:b.top,width:a.outerWidth(),height:a.outerHeight()}),c==d.length-1&&e.push({left:b.left,top:b.top,width:a.outerWidth(),height:a.outerHeight()});return e},_index:function(b,c){var d,f,i,h,j,g=this.start,e=g.gridPosition,a=this.grid.element.find(".sui-group-panel");if(g.positions.length>0){for(f=0;f<g.positions.length;f++)if(d=g.positions[f],i=d.left<=b&&b<=d.left+d.width&&d.top<=c&&c<=d.top+d.height,j=e.left<=b&&b<=e.left+e.width&&e.top<=c&&c<=e.top+e.height,h=a.offset().left<=b&&b<=a.offset().left+a.width()&&a.offset().top<=c&&c<=a.offset().top+a.height(),i&&j)return f}else h=a.offset().left<=b&&b<=a.offset().left+a.width()&&a.offset().top<=c&&c<=a.offset().top+a.height();return h?(this.isOnGroupPanel=!0,this.grid.element.find(".sui-group-panel-indicator").length):-1},_indicator:function(){var h,f=this,b=f.start,c=f.hovered,g=b.positions[c],e=f.reorderIndicator,j=b.gridPosition.left,l=b.gridPosition.left+b.gridPosition.width,k=b.target.parent().children(".sui-group-panel-indicator"),i=b.isRtl?b.index<c:b.index>c;k.removeClass("sui-reorder-target"),e&&e.hide(),null!=c&&c>-1&&(k.eq(c).addClass("sui-reorder-target"),e||(e=f.reorderIndicator=a("<div class='sui-grid-reorder-indicator'><span class='sui-grid-indicator-top' /><span class='sui-grid-indicator-bottom' /></div>").appendTo(d.body)),this.isOnGroupPanel&&(i=!1),g?(h=g.left+(i?0:g.width),this.isOnGroupPanel=null,e.css({left:o(n(j,h),l),top:g.top,height:g.height}).show()):(h=j+(i?b.gridPosition.width:0),this.isOnGroupPanel=null,e.css({left:h,top:b.gridPosition.top,height:f.grid.element.find(".sui-group-panel-empty").outerHeight()}).show()))},_up:function(n){var f,c=this,l=c.options,i=c.grid,j=c.dragged,g=c.start,h=c.hovered;if(j)if(j.css({left:g.x-g.left,top:g.y-g.top,transition:k("left {0} {1}ms, top {0} {1}ms",l.returnEasing,l.returnDuration)}),null!=h&&h>-1){j.remove();var m=g.target.attr("data-field");f=i.trigger(e,{commandName:ga,cancel:!1,field:m,index:h}),f.cancel||i.group(m,h,"asc")}else setTimeout(function(){j.remove()},p.transitions?l.returnDuration:0);c.dragged=c.hovered=h=null,c._indicator(),c.reorderIndicator&&(c.reorderIndicator.remove(),c.reorderIndicator=null),c.start=null,a(d).off(c._eventNS),b.selection(!0),f&&!f.cancel&&(delete f.cancel,delete f.commandName,i.dataSource.read(),i.trigger(ga,f))},destroy:function(){this._events(!1),this.grid.headerTable.removeClass("sui-reorderable")}}),V=m.extend({options:{ns:".shieldGridColumnReorder",returnDuration:150,returnEasing:"ease-out",dragTreshold:20,draggedTemplate:"<div class='sui-grid sui-grid-core'><div class='sui-gridheader'><table class='sui-table'><thead><tr class='sui-columnheader'><th class='sui-headercell'>{0}</th></tr></thead></table></div></div>"},init:function(b){var a=this;a.grid=b,a.options=f(!0,{},V.fn.options),a._eventNS=a.options.ns+w(),a._events(!0),b.headerTable.addClass("sui-reorderable")},_events:function(d){var a=this,b=a.grid.element;d?(a._downProxy=c(a._down,a),b.on(s+a._eventNS,".sui-headercell",a._downProxy)):(b.off(s+a._eventNS,".sui-headercell",a._downProxy),a._downProxy=null)},_down:function(g){var e=this,f=a(g.target).closest(".sui-headercell"),i=f.offset(),h=e.grid.element,j=h.offset(),k=g.pageX,l=g.pageY;if(!(g.button>1))return a(d).on(t+e._eventNS,c(e._move,e)).on(G+e._eventNS,c(e._up,e)),e.start={left:k-i.left,top:l-i.top,x:k,y:l,target:f,index:f.parent().find(".sui-headercell").index(f),positions:e._positions(f),gridPosition:{left:j.left,top:j.top,width:h.outerWidth(),height:h.outerHeight()},isRtl:p.isRtl(h)},b.selection(!1),!1},_move:function(g){var c=this,h=c.options,i=c.dragged,b=c.start,e=g.pageX,f=g.pageY,j=h.dragTreshold;i?(i.css({left:e-b.left,top:f-b.top}),c.hovered=c._index(e,f),c._indicator()):(v(b.x-e)>j||v(b.y-f)>j)&&(c.dragged=a(k(h.draggedTemplate,b.target.html())).css({position:"absolute",left:e-b.left,top:f-b.top,zIndex:999}).find("table").css("width","auto").end().find("th").attr("style",b.target[0].style.cssText).css({width:b.target.width(),height:b.target.height()}).end().appendTo(d.body))},_positions:function(f){var a,c,d=f.parent().children(".sui-headercell"),b=0,e=[];for(b;b<d.length;b++)a=d.eq(b),c=a.offset(),e.push({left:c.left,top:c.top,width:a.outerWidth(),height:a.outerHeight()});return e},_index:function(d,e){var a,c,g,h,f=this.start,b=f.gridPosition;for(c=0;c<f.positions.length;c++)if(a=f.positions[c],g=a.left<=d&&d<=a.left+a.width&&a.top<=e&&e<=a.top+a.height,h=b.left<=d&&d<=b.left+b.width&&b.top<=e&&e<=b.top+b.height,g&&h)return c;return-1},_indicator:function(){var h,f=this,b=f.start,c=f.hovered,g=b.positions[c],e=f.reorderIndicator,j=b.gridPosition.left,k=b.gridPosition.left+b.gridPosition.width,i=b.target.parent().children(".sui-headercell"),l=b.isRtl?b.index<c:b.index>c;i.removeClass("sui-reorder-target"),e&&e.hide(),null!=c&&c>-1&&(i.eq(c).addClass("sui-reorder-target"),e||(e=f.reorderIndicator=a("<div class='sui-grid-reorder-indicator'><span class='sui-grid-indicator-top' /><span class='sui-grid-indicator-bottom' /></div>").appendTo(d.body)),c!==b.index&&(h=g.left+(l?0:g.width),e.css({left:o(n(j,h),k),top:g.top,height:g.height}).show()))},_up:function(m){var f,c=this,j=c.options,l=c.grid,i=c.dragged,g=c.start,h=c.hovered;i&&(i.css({left:g.x-g.left,top:g.y-g.top,transition:k("left {0} {1}ms, top {0} {1}ms",j.returnEasing,j.returnDuration)}),null!=h&&h>-1?(i.remove(),f=l.trigger(e,{commandName:ea,cancel:!1,index:g.index,newIndex:h}),f.cancel||l.reorderColumn(g.index,h)):setTimeout(function(){i.remove()},p.transitions?j.returnDuration:0)),c.dragged=c.hovered=h=null,c._indicator(),c.reorderIndicator&&(c.reorderIndicator.remove(),c.reorderIndicator=null),c.start=null,a(d).off(c._eventNS),b.selection(!0),f&&!f.cancel&&(delete f.cancel,delete f.commandName,l.trigger(ea,f))},destroy:function(){this._events(!1),this.grid.headerTable.removeClass("sui-reorderable")}}),$=T.extend({init:function(){T.fn.init.apply(this,arguments);var a=this;a._eventNS=".shieldGrid"+a.getInstanceId(),a.refresh(),a._dM()},destroy:function(){this._destroyInternal(),T.fn.destroy.call(this)},_destroyInternal:function(){var c,d,e,b=this,f=(b.options,b._eventNS);if(b.contentWrapper){if(b._markedCells){for(d in b._markedCells)b._markedCells.hasOwnProperty(d)&&(b._markedCells[d].length=0);b._markedCells=null}for(a(y).off(_+b._rsNS),b._resize=b._rsNS=null,b.sorting&&(b.sorting.destroy(),b.sorting=null),b.virtualizedContainer&&(b.virtualizedContainer.destroy(),b.virtualizedContainer=null),c=0;c<b.columns;c++)b.columns[c].destroy();if(b.contentWrapper&&b.contentWrapper.off(oa,b._hScrollHandler),b._hScrollHandler=b.scrollableWrapper=null,b._selectable&&(b._selectable.destroy(),b._selectable=null),b.options.scrolling?(b.contentWrapper.parent().remove(),b.headerWrapper.parent().remove()):(b.contentWrapper.remove(),b.headerWrapper.remove()),b._hasDetailTemplate()&&(b.contentTable.off(j,".sui-expand-cell",b._toggleDetailTemplateHandler).off(j,".sui-collapse-cell",b._toggleDetailTemplateHandler),b._toggleDetailTemplateHandler=null),b.popupWindow&&b.popupWindow.destroy(),b._gridColumns&&(b._gridColumns.length=0),b.columns=b._gridColumns=b._windowEditingIndex=b.contentWrapper=b.headerWrapper=b.contentTable=b.hederTable=null,b._buttons){for(c=0;c<b._buttons.length;c++)e=b._buttons[c].button.element,b._buttons[c].button.destroy(),e.remove();b._buttons.length=0}b.pager&&(b.pager.destroy(),b.pager=null,b.pagerWrapper&&(b.pagerWrapper.parent().remove(),b.pagerWrapper=null)),b.loadingPanel&&(b.loadingPanel=null,clearTimeout(b.loadingPanelTimeout),b.loadingPanelTimeout=null),b._columnResizing&&(b._columnResizing.destroy(),b._columnResizing=null),b._toolbar&&(b._toolbar.destroy(),b._toolbar=null),b._editing&&(b._editing.destroy(),b._editing=null),b._columnReorder&&(b._columnReorder.destroy(),b._columnReorder=null),b._sortingInProgress=b._scrollLeft=b._scrollTop=b._populateInsertedItem=b._preventClosingEditors=b._editingInProcess=null,b._filter&&(b._filter.destroy(),b._filter=null),b._groupReorder&&(b._groupReorder.destroy(),b._groupReorder=null),b._columnGroupReorder&&(b._columnGroupReorder.destroy(),b._columnGroupReorder=null),b.dataSource.off(f),b.element.removeClass("sui-grid sui-grid-core").css(Q,"").empty()}},_dM:function(){var b=function(b){return a("<div/>").html(b).text()},c="&#68;&#101;&#109;&#111;&#32;&#86;&#101;&#114;&#115;&#105;&#111;&#110;",e=d.createTextNode(b(c));a(e).insertAfter(a(this.element))},_resizeHandler:function(){this.options.scrolling&&this._scrolling()},_hasDetailTemplate:function(){var a=this.options;return a.detailTemplate||a.events&&a.events.detailCreated},_hasVirtualScrolling:function(){var a=this.options;return a.scrolling&&a.scrolling.virtual&&!a.paging&&!this._hasDetailTemplate()},_canExpandCollapse:function(){return this.options.detailExpandCollapse!==!1},_resolveColumns:function(a){var c=this.columns=[];q.array(a)?B(a,function(b,a){c.push(new Ba(a))}):b.error("Invalid columns declaration. The columns have to be array.",this.options.dieOnError)},_createWrappers:function(){var b=this,e=b.element;b._wrapper();var c=a("<div />").prependTo(e);c.addClass("sui-gridcontent");var d=a("<div />").prependTo(e);d.addClass("sui-gridheader"),b.options.showHeader||(d.css(x,u),c.addClass("sui-no-header")),b.headerWrapper=d,b.contentWrapper=c},_wrapper:function(){var b=this.options.height,a=this.element;a.is("div")||(a=a.wrap("<div/>").parent()),a.addClass("sui-grid sui-grid-core"),a&&a.css(Q,b)},_createGroupPanel:function(){var d,g,e,b=this,h=!1,c=b.dataSource;if(e=b.element.find(".sui-group-panel"),e.length>0&&e.remove(),b.options.grouping.showGroupHeader)if(c.group&&0!==c.group.length){d=a("<div class='sui-group-panel' />"),b.element.prepend(d);for(var f=0;f<c.group.length;f++)g=c.group[f],b._createGroupHeaderIndicator(g,d),h=!0;h&&b.options.grouping.allowDragToGroup&&(b._groupReorder&&b._groupReorder.destroy(),b._groupReorder=new ma(b),b._columnGroupReorder&&b._columnGroupReorder.destroy(),b._columnGroupReorder=new Ha(b))}else b.element.prepend(a("<div class='sui-group-panel sui-group-panel-empty' >"+b.options.grouping.message+"</div>"))},_createGroupHeaderIndicator:function(e,h){var f,g,d,b=this;d=a('<div class="sui-group-panel-indicator" data-field="'+e.field+'"/>').appendTo(h),g="desc"==e.order?a('<span class="sui-descending">&#9660;</span>').appendTo(d):a('<span class="sui-ascending">&#9650;</span>').appendTo(d),a('<span class="sui-group-title">'+e.field+"</span>").appendTo(d),b.options.grouping.allowDragToGroup&&(f=a('<span class="sui-group-close-button">&#10006;</span>').appendTo(d),f.on(j,b._closeButtonClicked=c(b._closeButtonClickedHandler,b))),g.on(j,b._sortButtonClicked=c(b._sortButtonClickedHandler,b))},_sortButtonClickedHandler:function(f){for(var d=this,e=a(f.currentTarget),g=e.parent().attr("data-field"),c=d.dataSource.group,b=0;b<c.length;b++)c[b].field==g&&(e.hasClass("sui-descending")?c[b].order="asc":c[b].order="desc",d.dataSource.read())},_closeButtonClickedHandler:function(f){var c,b=this,g=a(f.currentTarget),d=g.parent().attr("data-field");b.dataSource.group&&(c=b.trigger(e,{commandName:H,cancel:!1,field:d}),c.cancel||(b.ungroup(d),b.trigger(H,c)))},_createHeaderTable:function(){var c=this,d=c.headerWrapper,b=c.element;b.is("table")||(b=d.children("table"),b.length||(b=a("<table/>").appendTo(d))),z&&b.attr("cellspacing",0),b.addClass("sui-table"),c.headerTable=b,c._createTbody(b,!0),c._createThead(b,!0),c._createFakeRow(b,c.columns.length)},_createContentTable:function(){var b=this,f=b.options,e=b.contentWrapper,d=b.element;d.is("table")||(d=e.children("table"),d.length||(d=a("<table />").appendTo(e))),z&&d.attr("cellspacing",0),d.addClass("sui-table"),f.rowHover&&d.addClass("sui-hover"),b._hasDetailTemplate()&&(b._canExpandCollapse()&&d.addClass("sui-expandable"),d.on(j,"> tbody > tr > .sui-expand-cell",b._toggleDetailTemplateHandler=c(b._expandCollapseDetailTemplate,b)),d.on(j,"> tbody > tr > .sui-collapse-cell",b._toggleDetailTemplateHandler)),b.contentTable=d,b._createTbody(b.contentTable,!1)},_createTbody:function(c,d){var b=c.find("> tbody");b.length||(b=a("<tbody/>").appendTo(c)),d&&b.addClass("sui-hide"),c.tbody=b},_createThead:function(g){var e,k,b,i,c,h=this,f=(h.options,h.columns),j="",d=g.find(">thead");if(d.length||(d=a("<thead/>").insertBefore(g.tbody)),b=g.find("tr:has(th):first"),b.length||(b=d.children().first(),b.length||(b=a("<tr/>"))),!b.children().length){for(e=0,k=f.length;k>e;e++)c=f[e],i=c.headerTemplate||c.title||c.field||c,j+="<th "+ka(c.headerAttributes)+' data-field="'+f[e].field+'">'+i+"</th>";b.html(j)}if(b.addClass("sui-columnheader"),b.find("th").addClass("sui-headercell"),f.length&&h._hasDetailTemplate()&&h._canExpandCollapse()){var l=a('<th class="sui-indent-cell" />');z&&l.html("&nbsp;"),l.prependTo(b)}b.appendTo(d),g.thead=d},_createFakeRow:function(e,f){var b=e.find(">tbody");if(b.length){for(var c=a("<tr/>"),d=0;f>d;d++)a("<td/>").appendTo(c);c.appendTo(b)}},_createColgroup:function(f){var d,g,b,e=this,i=e.options,h=e.columns,c=f.find(">colgroup");for(c.length||(c=a("<colgroup/>").prependTo(f)),c.html(""),i.columns.length&&e._hasDetailTemplate()&&e._canExpandCollapse()&&a("<col class='sui-indent-col'/>").appendTo(c),d=0,g=h.length;g>d;d++)b=h[d].width,a(b&&0!==parseInt(b,10)?k('<col style="width:{0}"/>',D(b)?b:b+"px"):"<col />").appendTo(c)},_scrolling:function(){var f,j,k,q,d=this,o=d.element,i=d.dataSource,n=d._hasVirtualScrolling(),g=d.headerWrapper,e=d.contentWrapper,m=g.outerHeight();if(g.parent().hasClass("sui-gridheader sui-scrolldiv")?m=g.parent().outerHeight():(g.addClass("sui-headercontent").removeClass("sui-gridheader"),g.wrap("<div class='sui-gridheader sui-scrolldiv'></div>"),e.addClass("sui-content").removeClass("sui-gridcontent"),e.wrap("<div class='sui-gridcontent sui-scroller'></div>"),z&&(d.headerTable.addClass("sui-table-ie7").removeClass("sui-table"),d.contentTable.addClass("sui-table-ie7").removeClass("sui-table")),a(d.element).find(".sui-scrolldiv").css(p.isRtl(o)?"padding-left":"padding-right",p.scrollbar()-1),j=d.scrollableWrapper=n?e.parent():e,j.on(oa,d._hScrollHandler=c(d._hscroll,d)),d.element.find(".sui-header-locked").prependTo(d.element.find(".sui-gridheader")),d.element.find(".sui-content-locked").prependTo(d.element.find(".sui-gridcontent"))),f=o.innerHeight()-m,d.pagerWrapper&&(f-=d.pagerWrapper.outerHeight()),d._toolbar){var l,r=d.element.find(".sui-toolbar"),s=0;for(l=0;l<r.length;l++)s+=a(r[0]).outerHeight();f-=s+1}var t=d.element.find(".sui-group-panel");if(t.length>0&&(f-=t.outerHeight()),a(e).add(e.parent()).css({height:f,width:"100%"}),n&&i.view&&i.view.length)d.virtualizedContainer?(d.virtualizedContainer.options.total=i.total,d.virtualizedContainer.render()):(k=d._renderRow(0,d.contentTable.tbody,h),q=k.outerHeight(),k.remove(),d.virtualizedContainer=new b.ui.VirtualizedContainer(j,{itemHeight:q,total:i.total,createContainer:function(a){return a.addClass("sui-content").append(d.contentTable).find("tbody").empty()},getItems:c(d._loadVirtualRows,d),skipRender:!0}),d.virtualizedContainer.render()),d.contentWrapper=d.virtualizedContainer.element.children().eq(0);else if(C&&!z&&!xa){var u=e.get(0);u.scrollWidth<=u.clientWidth&&e.css(Q,f+1)}},_loadVirtualRows:function(e,f,g){var a=this,b=a.dataSource,h=null!=b.skip?b.skip:0,i=null!=b.take?b.take:b.view.length,j=100,d=a.virtualizedContainer.container;if(!a._sortingInProgress&&b.remote&&(h>e||f>=h+i))clearTimeout(a._loadWaitTimeout),a._loadWaitTimeout=setTimeout(function(c,e,f){return function(){a._loadWaitTimeout=null,b.skip=c,b.take=e-c,a._loadingVirtualRows=!0,b.read().then(function(){if(!a._loadWaitTimeout){d.empty();for(var g=c;e>g&&g<b.total;g++)a._renderRow(g-c,d,b.view[g-c]);b.one(ia,function(){a._loadWaitTimeout||(a._loadingVirtualRows=!1)}),a.loading(!1),f([],!1)}})}}(e,f,g),j);else{d.empty();for(var c=e;f>c&&c<b.total;c++)a._renderRow(c,d,b.view[c]);g([],!1)}a._checkIfVerticalScroll()},_checkIfVerticalScroll:function(){var a=this,b=a.element.find(".sui-virtualized").get(0),c=a.element.get(0),d=b.scrollHeight>c.scrollHeight;d?(a.headerWrapper.parent().css("padding-right","16px"),a.headerWrapper.removeClass("sui-grid-no-gap")):(a.headerWrapper.parent().css("padding-right","0px"),a.headerWrapper.addClass("sui-grid-no-gap"))},_hscroll:function(h){var a=this,d=a.scrollableWrapper,b=d.get(0),e=a.headerWrapper,c=d.scrollLeft(),g=e.scrollLeft();if(p.isRtl(a.element)&&ua&&b.clientHeight<b.scrollHeight&&(c+=b.offsetWidth-b.clientWidth),c!=g){e.scrollLeft(c);var f=a.element.find(".sui-footer-content");f.length>0&&f.scrollLeft(c)}},_sorting:function(){var a=this,b=a.options.sorting;a.element;b&&a.columns.length&&(a.sorting=new Ea(b,a))},_renderData:function(){var d,f,b=this,h=b.dataSource.view,c=b.options;c.scrolling,g(c.altRows)?!0:c.altRows,c.rowTemplate,c.altRowTemplate,b.contentTable;if(!b._loadingVirtualRows&&(f=b.trigger(e,{commandName:X,cancel:!1}),!f.cancel)){b._sortingInProgress?b._updateGrid():(b.columns.length||(d=[],h.length&&B(h[0],function(a,b){d.push(a)}),c.columns=d,b._resolveColumns(d),b._createThead(b.headerTable,!0)),b._createColgroup(b.headerTable)),b._createColgroup(b.contentTable),b._sortingInProgress=!1,b._renderRows(),b._renderFooter();var i=function(b){return a("<div/>").html(b).text()},j=i("&#83;&#104;&#105;&#101;&#108;&#100;&#85;&#73;");b.loading(!1);var k=i("&#104;&#116;&#116;&#112;&#58;&#47;&#47;&#119;&#119;&#119;&#46;&#115;&#104;&#105;&#101;&#108;&#100;&#117;&#105;&#46;&#99;&#111;&#109;");b.trigger(X);var l=k;b.dmL||(b.dmL=a('<a href="'+l+'" target="_blank"> by '+j+"</a>"),a(b.dmL).css({color:"grey","text-decoration":"none"}).insertAfter(a(this.element)))}},_renderRows:function(){var f,d,b=this,c=b.options,i=b.dataSource,e=i.view,h=b.contentTable;if(b._markedCells){for(var j in b._markedCells)b._markedCells.hasOwnProperty(j)&&(b._markedCells[j].length=0);b._markedCells=null}if(h.tbody.empty(),!e||!e.length)return g(c.noRecordsTemplate)?a("<tr><td colspan='"+b.columns.length+"'>"+(c.noRecordsText||"No records to display")+"</td></tr>").appendTo(h.tbody):a("<td></td>").append(c.noRecordsTemplate).wrap("<tr></tr>").parent().appendTo(h.tbody),void b._initScrolling(c);if(!b._hasVirtualScrolling()||b._sortingInProgress)if(d=i.group,d&&d.length>0){var k=0;for(b._renderGroupedData(e,k,0),b.headerTable.find(">colgroup").find(".sui-indent-col").remove(),b.headerTable.thead.find(".sui-columnheader > .sui-indent-cell").remove(),f=0;f<d.length;f++)a("<col class='sui-indent-col'/>").prependTo(b.headerTable.find(">colgroup")),a("<col class='sui-indent-col'/>").prependTo(b.contentTable.find(">colgroup")),a("<th class='sui-indent-cell'/>").prependTo(b.headerTable.thead.find(".sui-columnheader"));b._addAllIntendCells(),b.contentTable.addClass("sui-grouped-table")}else b._renderRowsAndDetails(e);b._createGroupPanel(),b._initScrolling(c)},_initScrolling:function(a){a.scrolling&&!this._sortingInProgress&&this._scrolling()},_addAllIntendCells:function(){for(var b,g=this,f=g.contentTable.get(0).rows,d=0;d<f.length;d++){var c=a(f[d]),e=parseInt(c.attr("data-group-level"),10);if(c.hasClass("sui-group-header")){if(e>1)for(b=0;e-1>b;b++)a("<td class='sui-indent-cell'/>").prependTo(c)}else for(b=0;e>b;b++)a("<td class='sui-indent-cell sui-group-intend-cell'/>").prependTo(c)}},_renderGroupedData:function(f,d,b){var c=this;c.options.detailExpandCollapse=!1;for(var e=0;e<f.length;e++){var a=f[e];a.hasOwnProperty("field")&&a.hasOwnProperty("items")&&a.hasOwnProperty("value")&&a.hasOwnProperty("order")?(b++,c._renderGroupHeader(a,b),c._renderGroupedData(a.items,d,b),c._renderGroupAggregates(a),b--):(c._renderDataItem(a,d,b),d++)}},_renderGroupAggregates:function(n){if(n.aggregate){var j,f,o,b,h,e=this,g=e.columns,l={},d=n.aggregate;for(b=0;b<g.length;b++)if(f=g[b].groupFooterTemplate){j=a("<tr class='sui-group-footer' />").appendTo(e.contentTable.tbody);break}if(j){for(b=0;b<g.length;b++)if(h=a("<td class='sui-group-footer-cell' />").appendTo(j),f=g[b].groupFooterTemplate){o=g[b].field;for(var c=0;c<d.length;c++)d[c].field==o&&(r(d[c].aggregate)?l.custom=d[c].value:l[d[c].aggregate]=d[c].value);if(r(f)){var m=f.call(e,h,l);i(m)&&!L(m)&&""!==m&&h.html(m)}else h.html(k.call(e,f,l))}var p=e.dataSource.group.length;for(b=0;p>b;b++)j.prepend(a("<td class='sui-indent-cell' />"))}}},_renderGroupHeader:function(d,e){var b=this,g=b.contentTable,h=b.columns.length+b.dataSource.group.length-e+1,i=a("<tr class='sui-group-header' data-group-level='"+e+"' />").appendTo(g),f=a("<td class='sui-group-header-cell' colspan='"+h+"' />").appendTo(i),k=a("<span class='sui-collapse'>&#9662;</span>").appendTo(f);a("<span class='sui-group-header-text'>"+d.field+": "+d.value+"</span>").appendTo(f),k.on(j,b._expandCollapse=c(b._expandCollapseHandler,b))},_expandCollapseHandler:function(g){var f,b=this,c=a(g.currentTarget),d=c.parent().parent();c.hasClass("sui-collapse")?(f=b.trigger(e,{commandName:aa,cancel:!1,row:d}),f.cancel||(b.collapseGroup(d),c.html("&#9656;"),c.removeClass("sui-collapse").addClass("sui-expand"),b.trigger(aa,{row:d}))):(f=b.trigger(e,{commandName:Z,cancel:!1,row:d}),f.cancel||(b.expandGroup(d),c.html("&#9662;"),c.removeClass("sui-expand").addClass("sui-collapse"),b.trigger(Z,{row:d})))},_renderDataItem:function(b,c,d){var a=this,e=a.contentTable;a._renderRow(c,e,b).attr("data-group-level",d)},_renderRowsAndDetails:function(c){var d,a,b=this,e=b.contentTable;for(a=0,d=c.length;d>a;a++)b._renderRow(a,e.tbody,b.dataSource.view[a]),b._hasDetailTemplate()&&!b._canExpandCollapse()&&b._addDetailTemplate(c[a])},_renderRow:function(w,m,h){var p,b,F,o,c=this,E=i(m),d=c.options,B=g(d.altRows)?!0:d.altRows,l=B&&w%2&&d.altRowTemplate?d.altRowTemplate:d.rowTemplate,G=c.columns;if(l)D(l)&&(l=l.replace(/^\s+/,"").replace(/\s+$/,"")),b=a(k(l,h)),E&&m.append(b);else{if(b=a("<tr class='"+(B&&w%2?"sui-alt-row":"sui-row")+"'/>"),arguments.length>3){var z=arguments[3],y=m.find("tr"),H=y.eq(z);y.length==z?m.append(b):b.insertBefore(H)}else E&&m.append(b);for(o=0;o<G.length;o++){var n,s,j=G[o],q=j.columnTemplate,C=j.format,v=j.field,t=j.buttons,f=a("<td "+ka(j.attributes)+" class='sui-cell' />").appendTo(b);if(t)for(s=0;s<t.length;s++)c._buildButton(t[s],f,b.get(0).rowIndex);else q?r(q)?(n=q.call(c,f,h,w),i(n)&&!L(n)&&""!==n&&f.html(n)):f.html(k.call(c,q,h)):C?f.html(k.call(c,C,v?A(h,v):h)):f.html(""+A(h,v));j.visible||f.css(x,u)}}return c._hasDetailTemplate()&&c._canExpandCollapse()&&(F=c.trigger(e,{commandName:pa,cancel:!1,item:h}),F.cancel?p=a("<td class='sui-cell sui-expand-cell-disabled' />"):(p=a("<td class='sui-cell sui-expand-cell' />"),c._setExpandCollapseCellText(p,d.detailExpandText,d.detailCollapseText)),p.prependTo(b)),b},_renderFooter:function(){var f,o,g,s,c,b,m,d=this,h=d.columns,n={},e=d.dataSource.aggregates;for(c=0;c<h.length;c++)if(g=h[c].footerTemplate){if(d.options.scrolling&&d.options.scrolling.virtual){var t=a("<div class='sui-footer' style='padding-right: 16px;' />").appendTo(d.element),u=a("<div class='sui-footer-content' />").appendTo(t),p=a("<table class='sui-table' />").appendTo(u),q=d.element.find(".sui-headercontent > table > colgroup > col"),v=a("<colgroup />").appendTo(p);for(b=0;b<q.length;b++)a(q[b].outerHTML).appendTo(v);o=a("<tbody />").appendTo(p)}else o=a("<tfoot />").appendTo(d.contentTable);f=a("<tr class='sui-grid-footer' />").appendTo(o);break}if(f){for(c=0;c<h.length;c++)if(m=a("<td class='sui-footer-cell' />").appendTo(f),g=h[c].footerTemplate){for(s=h[c].field,b=0;b<e.length;b++)e[b].field==s&&(r(e[b].aggregate)?n.custom=e[b].value:n[e[b].aggregate]=e[b].value);if(r(g)){var l=g.call(d,m,n);i(l)&&!L(l)&&""!==l&&m.html(l)}else m.html(k.call(d,g,n))}var j=f.prev();(j.find(".sui-expand-cell").length>0||j.find(".sui-expand-cell-disabled").length>0||j.find(".sui-indent-cell").length>0||j.find(".sui-collapse-cell").length>0)&&f.prepend(a("<td />"))}},_buildButton:function(d,h,j){var k,e=this,f=d.commandName,i=d.click;if(b.ui.Button){var l=a("<button type='button'>"+d.caption+"</button>").appendTo(h);h.addClass("sui-button-cell"),"delete"===f?(i=e._deleteButtonClicked,g(d.cls)?d.cls="sui-delete":d.cls+=" sui-delete"):"edit"===f&&(e._editing&&(e._editing.type="row"),e._preventClosingEditors=!0,i=e._editButtonClicked,g(d.cls)?d.cls="sui-edit":d.cls+=" sui-edit"),k=new b.ui.Button(l,{cls:d.cls,events:{click:c(i,e,j,h)}}),("delete"==f||"edit"==f)&&(e._buttons||(e._buttons=[]),e._buttons.push({index:j,button:k}))}},_deleteButtonClicked:function(b,g){var a=this,d=a.dataSource,c=a.options.editing?a.options.editing.confirmation:null,f=a.trigger(e,{commandName:ba,cancel:!1,rowIndex:b});if(!f.cancel){if(c&&c["delete"]&&c["delete"].enabled&&!y.confirm(k(c["delete"].template,d.view[b])))return;d.removeAtView(b),a.options.editing&&!a.options.editing.batch&&d.save(!1),a.trigger(ba,{rowIndex:b})}},_editButtonClicked:function(g,d){var c=this,h=c._editing,f=c.dataSource,i=c.trigger(e,{commandName:J,cancel:!1,row:a(d).parent(),cell:d});i.cancel||(c._editingInProcess=!0,f.tracker&&f.tracker.changes&&f.tracker.changes.added&&f.tracker.changes.added.length>0?f.cancel():"popup"!=c.options.editing.mode?(c._closeAllEditedRows(),h&&h.options.enabled&&h._putRowInEditMode(a(c.contentTable.find("tbody > tr")[g])),c._changeEditColumnButtons(g,d)):b.ui.Window&&c._initializePopupForm(g),c.trigger(J,{row:a(d).parent(),cell:d}))},_initializePopupForm:function(m,n){var q,g,k,e=this,h=e._editing,r=e.dataSource;q=a('<div class="sui-modal-popup-edit-window"></div>').appendTo(d.body),g=a('<div class="sui-edit-form-container"></div>'),k=e.options.columns;for(var l=0;l<k.length;l++){var f=k[l];if(f.editable!==!1&&f.field){var s=r.schema.options.fields[f.field].type,p=r.editView(m).data,j=A(p,f.field);e._windowEditingIndex=m,a('<div class="sui-edit-form-label"><label for="'+f.field+'">'+(f.caption?f.caption:f.field)+"</label></div>").appendTo(g);var i=a('<div class="sui-edit-field"></div>').appendTo(g);if(f.editor)h._instantiateCustomEditor(f,i,p,0,!1,f.field);else switch(s){case Number:h._instantiateNumeric(i,j,!1,f.field);break;case Date:h._instantiateDatePicker(i,j,!1,f.field);break;case String:h._instantiateTextBox(i,j,!1,f.field);break;case Boolean:h._instantiateCheckBox(i,j,!1,f.field)}}}var o=a('<div class="sui-update-buttons sui-popup-buttons"></div>').appendTo(g),t=a("<button type='button'>Save</button>").appendTo(o),u=a("<button type='button'>Cancel</button>").appendTo(o);if(b.ui.Button){var v=new b.ui.Button(t,{events:{click:c(e._updateButtonClicked,e)}}),w=new b.ui.Button(u,{events:{click:c(e._cancelButtonClicked,e)}});e._buttons=[],e._buttons.push({index:1e4,button:v}),e._buttons.push({index:1e4,button:w})}g.appendTo(d.body),e.popupWindow=new b.ui.Window(q,{title:n?"Insert":"Edit",draggable:{enabled:!1},events:{close:c(e._cancelButtonClicked,e)},height:a(".sui-edit-form-container").height()+57,modal:!0}),e.popupWindow.content(g),e.popupWindow.resize({width:a(".sui-modal-popup-edit-window").width(),height:a(".sui-edit-form-container").height()+66}),e.trigger(n?wa:va)},_changeEditColumnButtons:function(c,b){var a=this;a._removeButtons(b,c),a._buildButton({caption:"Update",click:a._updateButtonClicked},b,c),a._buildButton({caption:"Cancel",click:a._cancelButtonClicked},b,c),b.addClass("sui-update-buttons")},_removeButtons:function(c,d){for(var a=this,b=a._buttons.length;b--;)a._buttons[b].index==d&&(a._buttons[b].button.destroy(),a._buttons.splice(b,1));c.removeClass("sui-update-buttons").empty()},_updateButtonClicked:function(b,c){var a=this;return g(a._windowEditingIndex)||(b=a._windowEditingIndex),a._updateItem(b,c),a._editing._errorDuringEdit?void(a._editing._errorDuringEdit=!1):(a._putRowInViewMode(b,c),void("popup"===a.options.editing.mode&&a._removePopupWindow()))},_updateItem:function(m,p){var d,c,i,b,k,n,f,a=this,j=a.dataSource,l=(a.pager,[]),o=!0;if(j.group&&j.group.length>0&&"popup"!=a.options.editing.mode)for(k=a.contentTable.find(".sui-row, .sui-alt-row"),n=a.contentTable.find("tr").get(m),f=0;f<k.length;f++)if(k[f]==n){m=f;break}d=j.editView(m);for(b in d.data)d.data.hasOwnProperty(b)&&(null!=d.data[b]&&(o=!1),a._editing._editors[b]&&("custom"==a._editing._editors[b]?(i=a.trigger("getCustomEditorValue",{
field:b,value:null}),c=i.value,a._editing._editors[b]=null):c=a._editing._editors[b].value?a._editing._editors[b].value():a._editing._editors[b].checked?a._editing._editors[b].checked():h,d.data[b]!=c&&l.push(b),(g(c)||null==c)&&(c=a._getDefaultValue(b)),d.set(b,c)));return a._editing._errorDuringEdit?void(l.length=0):(a._editing.options.batch||(i=a.trigger(e,{commandName:O,cancel:!1}),i.cancel||(j.save(!1),a.trigger(O))),a._populateInsertedItem=o,l)},_getDefaultValue:function(c){var a,d=this,b=d.dataSource.schema;if(b&&b.options.fields)switch(b.options.fields[c].type){case Number:a=0;break;case Date:a=new Date;break;case String:a="";break;case Boolean:a=!1}else a="";return a},_closeAllEditedRows:function(c){var d,e,b=this,f=b.contentTable.find(".sui-editable-cell");f.length>0&&(d=f.get(0).parentNode.rowIndex,e=b.contentTable.find(".sui-update-buttons").get(0),b._cancelButtonClicked(d,a(e)),c&&c.length>0&&b._renderUpdateMarkers(c,d))},_cancelButtonClicked:function(f,g){var a=this,b=a.dataSource,i=a.trigger(e,{commandName:N,cancel:!1,rowIndex:f,cell:g});if(!i.cancel){if(b.tracker&&b.tracker.changes&&b.tracker.changes.added&&b.tracker.changes.added.length>0)b.cancel(),"popup"===a.options.editing.mode&&a._removePopupWindow();else if("popup"!=a.options.editing.mode)a._putRowInViewMode(f,g);else{for(var d=a.options.columns,c=0;c<d.length;c++){var h=a._editing._editors[d[c].field];h&&(r(h.destroy)&&a._editing._editors[d[c].field].destroy(),delete a._editing._editors[d[c].field])}a._removePopupWindow()}a.trigger(N)}},_removePopupWindow:function(){var b=this;b._removeButtons(a(".sui-window .sui-update-buttons"),1e4),b.popupWindow.destroy(),a(".sui-modal-popup-edit-window").remove()},_getRowIndex:function(a){return this.contentTable.find(".sui-row, .sui-alt-row").index(a)},_putRowInViewMode:function(d,l){var n,e,f,b,c=this,h=c.dataSource,j=c.contentTable,k=d;if(h.group&&h.group.length>0&&"popup"!=c.options.editing.mode)for(f=j.find(".sui-row, .sui-alt-row"),e=j.find("tr").get(d),b=0;b<f.length;b++)if(f[b]==e){k=b;break}n=h.editView(k).data,l&&"popup"!=c.options.editing.mode&&c._removeButtons(l,d),e=j.find("tr").get(d);var i=parseInt(a(e).attr("data-group-level"),10);for(c._editing._destroyRow(d),e=c._renderRow(k,c.contentTable.tbody,n,d),b=0;i>b;b++)a("<td class='sui-indent-cell sui-group-intend-cell'/>").prependTo(e);if(i&&e.attr("data-group-level",i),c._editing.options.batch){var m=e.find(".sui-cell");if(c._markedCells&&c._markedCells[d]){var g,o,p=c._markedCells[d];for(b=0;b<p.length;b++)g=p[b],o=a(m[g]).html(),a(m[g]).html("<span class='sui-updated-marker' />"+o)}}},_renderUpdateMarkers:function(f,d){var e,c,g,b=this,h=b.columns,i=b.contentTable.find("tbody > tr").eq(d).find(".sui-cell");for(e=0;e<f.length;e++)for(c=0;c<h.length;c++)h[c].field===f[e]&&(g=a(i[c]).html(),a(i[c]).html("<span class='sui-updated-marker' />"+g),b._markedCells?(b._markedCells[d]||(b._markedCells[d]=[]),b._markedCells[d].push(c)):(b._markedCells={},b._markedCells[d]=[],b._markedCells[d].push(c)))},_selection:function(){var a=this,b=a.options;b.selection&&(a._selectable=new Fa(a.headerTable,a.contentTable,b.selection,a))},_filtering:function(){var a=this,b=a.options;b.filtering&&b.filtering.enabled&&(a._filter=new Da(a))},_paging:function(d){var e,c=this,g=c.element;b.ui.Pager&&d&&(M(d)&&d instanceof b.ui.Pager?(c.pager=d,c.pager.dataSource=c.dataSource,c.pager.element.appendTo(g)):(e=a("<div />").appendTo(g),e.addClass("sui-pager"),c.pagerWrapper=e,c.pager=new b.ui.Pager(e.get(0),f({},d,{dataSource:c.dataSource}))))},_reorder:function(){var a=this,b=a.options;b.columnReorder&&(a._columnReorder=new V(a))},_expandCollapseDetailTemplate:function(d){var b=this,c=a(d.target).closest(".sui-row",b.contentTable);c.length||(c=a(d.target).closest(".sui-alt-row",b.contentTable)),b._toggleDetailTemplate(c)},_toggleDetailTemplate:function(c){var d,b=this,g=b.contentTable.find("tr:first").parent().children().not(".sui-detail-row"),h=E(c[0],g),i=b.dataSource.view,e=c.next(),f=b.options;e&&e.hasClass("sui-detail-row")?(e.toggle(),d=a(c.get(0).cells[0]),b._toggleClasses(d,"sui-expand-cell","sui-collapse-cell"),b._setExpandCollapseCellText(d,f.detailExpandText,f.detailCollapseText)):b._addDetailTemplate(i[h],c)},_setExpandCollapseCellText:function(a,d,e){g(e)&&(e="-"),g(d)&&(d="+");var b=this.options.detailCollapseCssClass,c=this.options.detailExpandCssClass;b=g(b)?"":" class = '"+b+"'",c=g(c)?"":" class = '"+c+"'",a.hasClass("sui-collapse-cell")?a.html("<span"+b+">"+e+"</span>"):a.hasClass("sui-expand-cell")&&a.html("<span"+c+">"+d+"</span>")},_addDetailTemplate:function(h,c){var i,b=this,d=b.options,f=a("<tr class='sui-detail-row'/>");b._canExpandCollapse()&&(i=a("<td class='sui-cell sui-indent-cell'/>"),z&&i.html("&nbsp;"),i.appendTo(f));var g=a('<td class="sui-detail-cell" colspan="'+b.columns.length+'"></td>'),l=b.trigger(e,{commandName:da,cancel:!1,detailCell:g,item:h});if(!l.cancel&&(g.appendTo(f),d.detailTemplate&&g.html(k(d.detailTemplate,h)),c?f.insertAfter(c):f.appendTo(b.contentTable.tbody),b.trigger(da,{detailCell:g,item:h}),c)){var j=a(c.get(0).cells[0]);b._toggleClasses(j,"sui-expand-cell","sui-collapse-cell"),b._setExpandCollapseCellText(j,d.detailExpandText,d.detailCollapseText)}},_toggleClasses:function(a,b,c){a.hasClass(b)?(a.removeClass(b),a.addClass(c)):(a.removeClass(c),a.addClass(b))},_resizing:function(){var a=this;a.options.resizing&&a.options.scrolling&&(a._columnResizing=new Y(a))},_initToolbar:function(){var a=this,b=a.options;b.toolbar&&(a._toolbar=new Ja(b.toolbar,a))},_initEditing:function(){var a=this,b=a.options;b.editing&&(a._buttons=[],a._editing=new Aa(b.editing,a))},_refreshOnSort:function(){this._sortingInProgress=!0,this.dataSource.read()},_updateGrid:function(){var c=this,d=b.extend([m],c.options,d);c.sorting&&(c.sorting.destroy(),c.sorting=null),c.headerWrapper.find(".sui-headercell .sui-link").each(function(d,c){var b=a(c);b.parent().html(b.html())}),c.headerWrapper.find('.sui-headercell span[class^="sui-"]').remove(),c._sorting()},_dsStartHandler:function(){this.loading(!0)},refresh:function(e){var h,d=this,i=e?e.dataSource:null,j=d._eventNS;e=b.extend([m],d.options,e),i&&(e.dataSource=i);var k,l=e.scrolling,n=d.pager?d.pager.options:e.paging,f=0;l&&d.contentWrapper&&(f=d.contentWrapper.get(0).scrollLeft),d._destroyInternal(),k=d.dataSource=U.create(e.dataSource),k.on(ia+j,c(d._renderData,d)).on(sa+j,c(d._dsStartHandler,d)),d._resolveColumns(e.columns),d._createWrappers();for(var g=0;g<d.options.columns.length;g++)if(d.options.columns[g].locked){h=!0;break}h&&(a("<div class='sui-header-locked'>").appendTo(d.headerWrapper),a("<div class='sui-content-locked'>").appendTo(d.contentWrapper)),d._createHeaderTable(),d._createContentTable(),d._initToolbar(),d._initEditing(),d._selection(),d._paging(n),d._resizing(),d._reorder(),d._filtering(),d.pager||d.dataSource.read(),d._sorting(),d._rsNS=".rs"+d.getInstanceId(),a(y).on(_+d._rsNS,d._resize=c(d._resizeHandler,d)),f&&(d.contentWrapper.get(0).scrollLeft=f)},_createHeaderFrozenContainer:function(){},loading:function(d,e){var a=this,c=function(){a.loadingPanel&&a.loadingPanel.show()};b.ui.LoadingPanel&&(d?(a.loadingPanel||(a.loadingPanel=new b.ui.LoadingPanel(a.element.get(0))),e?c():a.loadingPanelTimeout=setTimeout(c,50)):a.loadingPanel&&(clearTimeout(a.loadingPanelTimeout),a.loadingPanelTimeout=null,a.loadingPanel.hide()))},select:function(b){var d=this,c=d._selectable;return b=D(b)?d.contentTable.find(b):a(b),b.length?(c.multiple||(c.clear(),b=b.first()),void c.select(b)):c.select()},selectedRowIndices:function(){var b=this,c=[],d=[];return b.contentTable.children("tbody").children(".sui-row, .sui-alt-row").each(function(e){a(this).hasClass(l)&&(c.push(e),d.push(b.dataSource.getDataIndex(e)))}),{view:c,data:d}},clearSelection:function(){this._selectable.clear()},sort:function(a,b,c){this.sorting&&this.sorting._sort(a,b,c)},_getItemRow:function(b){return a(Ga(b)?this.contentTable.children("tbody").children(".sui-row, .sui-alt-row").get(b):b)},expandRow:function(d){var a=this,b=a._getItemRow(d),c=b.next();c.hasClass("sui-detail-row")?c.css(x)==u&&a._toggleDetailTemplate(b):a._toggleDetailTemplate(b)},collapseRow:function(d){var b=this,a=b._getItemRow(d),c=a.next();c.hasClass("sui-detail-row")?c.css(x)!=u&&b._toggleDetailTemplate(a):(b._toggleDetailTemplate(a),a.next().toggle())},reorderColumn:function(b,c){var d,e=this,f=e.element,g=e.columns,h=e.options.columns||[],k=e.headerWrapper,i="before",j=k.find(".sui-indent-cell").length;if(b=+b,c=+c,isNaN(b)||isNaN(c)||0>b||0>c||b>g.length-1||c>g.length-1)throw new Error("Invalid index in column reorder.");b!==c&&(c>b&&(i="after"),d=g.splice(b,1)[0],g.splice(c,0,d),d=h.splice(b,1)[0],h.splice(c,0,d),b+=j,c+=j,f.find(".sui-gridheader col:nth-child("+(b+1)+")").add(f.find(".sui-gridheader .sui-columnheader th:nth-child("+(b+1)+")")).add(f.find(".sui-gridcontent col:nth-child("+(b+1)+")")).add(f.find(".sui-gridcontent tr:not(.sui-detail-row) td:nth-child("+(b+1)+")")).each(function(){a(this).parent().children().eq(c)[i](this)}))},addRow:function(a){return this.dataSource.add(i(a)?a:{})},insertRow:function(b,a){return this.dataSource.insertView(b,i(a)?a:{})},saveChanges:function(){this.dataSource.save()},revertChanges:function(){this.dataSource.cancel()},dataItem:function(a){return this.dataSource.view[a]},editCell:function(b,c){var a=this,d=a.contentTable.find("tbody > tr").eq(b).find("td").eq(c).get(0);a._editingInProcess=!0,a._editing._putCellInEditMode(d,b)},editRow:function(c){var b=this,d=b.contentTable.find("tbody > tr").eq(c).get(0);b._editingInProcess=!0,b._editing._putRowInEditMode(a(d),0)},cancelEditing:function(){var c,d,b=this,e=b.contentTable.find(".sui-editable-cell");e.length>0&&(c=e.get(0).parentNode.rowIndex,d=b.contentTable.find(".sui-update-buttons").get(0),b._putRowInViewMode(c,a(d)))},deleteRow:function(a){this.dataSource.removeAtView(a)},filter:function(){var c=this,a=c.dataSource,b=[].slice.call(arguments);return b.length>0?(a.filter=b[0],void a.read()):a.filter},group:function(b,f,c,d){var a=this,e=a.dataSource.group;e?e.splice(f,0,{field:b,order:c,aggregates:d}):(a.dataSource.group=[],a.dataSource.group.push({field:b,order:c,aggregates:d}))},ungroup:function(d){var a=this,b=a.dataSource.group;a.headerTable.thead.find(".sui-columnheader > .sui-indent-cell").remove();for(var c=0;c<b.length;c++)b[c].field==d&&(b.splice(c,1),0===b.length&&(a.dataSource.group=null),a.dataSource.read())},collapseGroup:function(a){for(var b=!0,c=parseInt(a.attr("data-group-level"),10);b;)if(a=a.next().css(x,u),a.next().length>0){var d=parseInt(a.next().attr("data-group-level"),10);c>=d&&a.next().hasClass("sui-group-header")&&(b=!1)}else b=!1},expandGroup:function(a){for(var b=!0,c=parseInt(a.attr("data-group-level"),10);b;){if(a=a.next().css(x,""),a.hasClass("sui-group-header")&&a.find(".sui-expand").length>0)return;if(a.next().length>0){var d=parseInt(a.next().attr("data-group-level"),10);c>=d&&a.next().hasClass("sui-group-header")&&(b=!1)}else b=!1}},_getColumnByField:function(c){var a,d=this,b=d.columns||[];for(a=0;a<b.length;a++)if(b[a].field===c)return b[a];return h},_getColumnIndexByField:function(c){var a,d=this,b=d.columns||[];for(a=0;a<b.length;a++)if(b[a].field===c)return a;return-1},hideColumn:function(d){var c,b=this,f=b._getColumnByField(d),g=a(b.element),l=a(g.find(".sui-gridheader colgroup").first().find("col"));if(!b._gridColumns){var k=b.columns;for(b._gridColumns=[],c=0;c<k.length;c++)b._gridColumns.push({name:k[c].field,index:c,hidden:!1,col:null})}if(f){if(!f.visible)return;f.visible=!1}var m=a.grep(b._gridColumns,function(a,b){return a.name===d})[0],h=b._getRealIndex(m),i=l[h],j=a(g.find("> .sui-gridcontent colgroup").first().find("col")[h]);for(c=0;c<b._gridColumns.length;c++){var e=b._gridColumns[c];if(e.name===d){e.hidden=!0,e.col=i,e.contentCol=j;break}}a(i).remove(),a(j).remove(),b._changeColumnVisibility(d,"hide")},_getRealIndex:function(b){var c=a.grep(this._gridColumns,function(a,b){return!a.hidden}),d=a.inArray(b,c);return d},_getNextVisibleColumnRealIndex:function(b){var c=a.grep(this._gridColumns,function(a,c){return a.index>b.index&&!a.hidden})[0],d=a.grep(this._gridColumns,function(a,b){return!a.hidden}),e=a.inArray(c,d);return e},showColumn:function(h){var b=this,f=b._getColumnByField(h),d=a(b.element),m=a(d.find(".sui-gridheader colgroup").first().find("col")),l=a(d.find("> .sui-gridcontent colgroup").first().find("col"));if(b._gridColumns){var c=a.grep(b._gridColumns,function(a,b){return a.name===h})[0],g=c.col,j=c.contentCol,e=b._getNextVisibleColumnRealIndex(c),k=a(d.find(".sui-gridheader colgroup").first()),i=a(d.find("> .sui-gridcontent colgroup").first());if(-1===e?(k.append(g),i.append(i)):0===e?(a(g).prependTo(k),a(j).prependTo(i)):(a(g).insertBefore(m[e]),a(j).insertBefore(l[e])),c.hidden=!1,f){if(f.visible)return;f.visible=!0}b._changeColumnVisibility(h,"show")}},_changeColumnVisibility:function(i,e){var b,c,f=this,d=a(f.element),g=d.find(".sui-columnheader").first(),h=f._getColumnIndexByField(i);for(g.length&&a(g.find("th")[h])[e](),b=d.find("> .sui-gridcontent > table > tbody > tr"),0===b.length&&(b=d.find("> .sui-gridcontent > .sui-virtualized > table > tbody > tr")),c=0;c<b.length;c++)a(b[c].cells[h])[e]()},_getVisibleColumnFields:function(){return I(Ca(this.columns,function(a){return a.visible}),function(a){return a.field})},exportExcel:function(){this._doExcelExport()},exportPdf:function(){this._doPdflExport()},_doExcelExport:function(){var d,a,g,m,c,k,o,l,b=this,p=b.options,n=[],j=[];F&&(o=b.trigger(e,{commandName:"exportExcel",cancel:!1,exportOptions:f(!0,{},p.exportOptions)}),o.cancel||(b.loading(!0,!0),setTimeout(function(){d=f(!0,{proxy:h,excel:{fileName:"Untitled",fileFormat:"xlsx",noLegacyFallback:!1,author:h,created:new Date,producer:h,dataSource:h,readDataSource:!1,columnFields:h,header:{enabled:!0,style:{bold:!0},cells:h},worksheet:{name:"Sheet1",columns:h},worksheets:[],worksheetIndex:0}},o.exportOptions),a=d.excel,c=a.columnFields,c||(c=b._getVisibleColumnFields()),k=c.length,a.worksheet.columns||(a.worksheet.columns=I(c,function(a){return{autoWidth:!0}})),m=f(!0,{},a.worksheet),a.header&&a.header.enabled&&(a.header.cells?j.push({cells:a.header.cells}):j.push({cells:I(c,function(d){var c=b._getColumnByField(d);return{type:String,value:i(c)&&c.title?c.title:d,style:a.header.style}})})),g=U.create(a.dataSource?a.dataSource:b.dataSource),l=function(){var s,p,h,o,t=g.view||[],x=t.length,r=[];for(h=0;k>h;h++)r[h]=A(g,"schema.options.fields."+c[h]+".type");for(h=0;x>h;h++){var l,q,v=t[h],u=b.trigger(e,{commandName:"exportExcelRow",cancel:!1,item:v,index:h,row:{}}),w=[];if(!u.cancel){for(l=f(!0,{},u.row),o=0;k>o;o++)q={type:i(l.type)?l.type:r[o],value:i(l.value)?l.value:A(v,c[o])},l.cells&&l.cells[o]&&f(!0,q,l.cells[o]),w.push(q);j.push({index:l.index,height:l.height,cells:w})}}m.rows=j,n=[].slice.call(a.worksheets),n.splice(a.worksheetIndex,0,m),p={created:a.created,author:a.author,worksheets:n},s="xml"==a.fileFormat?new F.ExcelXMLSpreadsheet(p):new F.OOXMLWorkbook(p),s.saveAs({fileName:a.fileName,forceExt:d.forceExt,proxy:d.proxy}),b.loading(!1)},a.readDataSource?g.read().always(l):l()},100)))},_doPdfExport:function(){var d,a,l,c,n,m,k,g,j,b=this,o=b.options;F&&(m=b.trigger(e,{commandName:"exportPdf",cancel:!1,exportOptions:f(!0,{},o.exportOptions)}),m.cancel||(b.loading(!0,!0),setTimeout(function(){d=f(!0,{proxy:h,pdf:{fileName:"Untitled",author:h,created:new Date,size:"a4",orientation:"portrait",fontSize:10,dataSource:h,readDataSource:!1,columnFields:h,header:{enabled:!0,cells:h},margins:{left:72,top:72,bottom:72,right:72}}},m.exportOptions),a=d.pdf,c=a.columnFields,c||(c=b._getVisibleColumnFields()),n=c.length,a.header&&(j=!!a.header.enabled,a.header.cells&&(g=[].concat(a.header.cells))),i(j)||(j=!0),i(g)||(g=I(c,function(a){var c=b._getColumnByField(a);return{field:a,title:c.title||a,width:c.width||h}})),l=U.create(a.dataSource?a.dataSource:b.dataSource),k=function(){var c,i,k,h,n=l.view||[],p=n.length,o=[],m=a.margins;for(c=0;p>c;c++)i=n[c],k=b.trigger(e,{commandName:"exportPdfRow",cancel:!1,item:i,index:c,row:{}}),k.cancel||o.push(f(!0,i,k.row));h=new F.PDFDocument({author:a.author,created:a.created}),h.addPage(a.size,a.orientation),h.table(m.left,m.top,o,g,{margins:m,printHeader:j,fontSize:a.fontSize}),h.saveAs({fileName:a.fileName,forceExt:d.forceExt,proxy:d.proxy}),b.loading(!1)},a.readDataSource?l.read().always(k):k()},100)))}});$.defaults=ha,b.ui.plugin("Grid",$)}(jQuery,shield,this);