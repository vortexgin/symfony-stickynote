!function(aR,aQ,an,aI){function ad(e){var d,f=" ";if(e){if(bl(e)){return e}for(d in e){e.hasOwnProperty(d)&&(f+=d+'="'+e[d]+'"')}}return f}function bm(h,g){var a=aR(h.target).closest(".sui-cell",g);if(!a.length){return null}var j=a[0].parentNode,i=a[0];return null==j||null==i?null:{row:j,cell:i}}var bd,a0=aQ.ui.Widget,aB=aQ.Class,aZ=aQ.DataSource,aD=aQ.format,ax=aQ.support,bi=aQ.exp,bp=aQ.get,ap=aQ.iid,aw=aQ.is,av=aw.func,bl=aw.string,a8=aw.object,ai=aw["boolean"],aF=aw.defined,bD=aw.number,aJ=aw.undefined,a9=aw["null"],aM=document,aq=Math.abs,ay=Math.min,az=Math.max,bo=aR.each,aP=aR.proxy,aK=aR.extend,be=aR.map,bf=aR.grep,bj=aR.inArray,a2=navigator.userAgent,bz=an.opera,bn=/msie/i.test(a2)&&!bz,am=bn&&7===aM.documentMode,ab=bn&&8===aM.documentMode,aT=(bn&&10===aM.documentMode,8===aM.documentMode,/AppleWebKit/.test(a2)),a3=(/Firefox/.test(a2),"height"),bq="sui-selectable",aC="sui-selected",aG="change",by="start",aN="scroll",aL="command",bk="selectionChanged",aX="selectstart",aW="dataBound",au="mousedown",at="mousemove",bh="mouseup",aS="resize",aE="click",bE="dblclick",aA="sort",ah="detailCreated",ac="columnReorder",bA="groupsReorder",bt="group",bg="ungroup",bb="editorCreating",a1="filterWidgetCreating",af="getCustomFilterValue",br="clearFilter",ak="expandButtonCreate",a7="cancel",bc="edit",bC="insert",a6="save",a5="delete",a4="error",bs="collapse",aU="expand",al="editWindowOpen",ag="insertWindowOpen",ao="display",ar="none";bd={columns:[],rowHover:!0,scrolling:!1,paging:!1,columnReorder:!1,showHeader:!0,grouping:{showGroupHeader:!1,allowDragToGroup:!1,message:"Drag a column header here to group by a column"}};var aO=aB.extend({init:function(k,o){var a,j,p,m,n,l=this;for(l._grid=o,n=0;n<k.length;n++){a=k[n],j=a.position?a.position:"top",p=aR("<div class='sui-toolbar'></div>"),"top"===j?(m=o.element.find(".sui-toolbar"),m.length>0?aR(m[0]).after(p):o.element.prepend(p)):(p.addClass("sui-toolbar-bottom"),p.appendTo(o.element)),a.template?l._initializeTemplate(a,p):a.buttons.length>0&&l._buildButtons(p,a)}},_buildButtons:function(j,i){var g,h=this,f=i.buttons;for(g=0;g<f.length;g++){h._buildButton(f[g],j)}},_buildButton:function(k,b){var c,a,n=this,l=k.commandName,m=k.click;aQ.ui.Button&&(c=aR('<button type="button">'+k.caption+"</button>").appendTo(b),"insert"==l?m=n._insertButtonClicked:"save"==l?m=n._saveButtonClicked:"cancel"==l?m=n._cancelButtonClicked:"excel"==l?m=n._excelButtonClicked:"pdf"==l&&(m=n._pdfButtonClicked),a=new aQ.ui.Button(c,{cls:k.cls,events:{click:aP(m,n._grid)}}))},_excelButtonClicked:function(){this._doExcelExport()},_pdfButtonClicked:function(){this._doPdfExport()},_insertButtonClicked:function(c,o){var t,q,s,p,r,v=this,n=v.options,e=n.editing.insertNewRowAt,u=v.dataSource;if(o||(p=v.trigger(aL,{commandName:bC,cancel:!1}),!p.cancel)){if(u.sort&&u.sort.length>0){return u.sort=[],v._sortingInProgress=!0,v.pager&&(u.skip=0,u.take=v.pager.pageSize(),v.pager.refresh(!0)),void u.read().always(aP(v._toolbar._insertButtonClicked,v,c,!0))}v._editingInProcess=!0,s="pagebottom"===e?az(0,v.contentTable.find("tbody > tr").length-1):0,t=u.insertView(s,{});for(r in t.fields){t.fields.hasOwnProperty(r)&&(t.data[r]=null)}v._editing._insertedItems.push(t),q=v.contentTable.find("tbody > tr").eq(s),"popup"!=v.options.editing.mode?v._editing._putRowInEditMode(q,0):v._initializePopupForm(0,!0),v.trigger(bC)}},_saveButtonClicked:function(h){var e,j,g=this,i=g.contentTable.find(".sui-editable-cell");return i.length>0&&(e=i.get(0).parentNode.rowIndex,g._updateItem(e,null),g._errorDuringEdit)?void (g._errorDuringEdit=!1):(j=g.trigger(aL,{commandName:a6,cancel:!1}),void (j.cancel||(g.dataSource.save(),g.trigger(a6))))},_cancelButtonClicked:function(f){var e=this,d=e.trigger(aL,{commandName:a7,cancel:!1});d.cancel||(e.dataSource.cancel(),e.trigger(a7))},_initializeTemplate:function(i,f){var h=this,j=i.template;if(av(j)){var g=j.call(h._grid,f);aF(g)&&!a9(g)&&""!==g&&f.html(g)}else{f.html(j)}},destroy:function(){this._grid=null}}),bB=aB.extend({init:function(c,f){var e=this;e._grid=f,e.options=c,e._eventNS=".shieldGridEditing"+ap(),e._editors={},e._insertedItems=[],c.enabled&&e._initEditing(),e._grid.dataSource.on(a4+e._eventNS,aP(e._dsError,e))},_dsError:function(e){var d=this,f=d._editors[e.path];d._grid.trigger(a4,{type:e.type,path:e.path,value:e.value,editor:f,reason:e.reason}),d._errorDuringEdit=!0},_initEditing:function(){var a=this,c=a.options,g=c.event,d=a._eventNS;aJ(g)||("click"===g?a._grid.element.on(aE+d,".sui-cell",aP(a._editingTriggered,a)):"doubleclick"===g&&a._grid.element.on(bE+d,".sui-cell",aP(a._editingTriggered,a)),aR(aM).on(aE+d,aP(a._documentClicked,a)))},_editingTriggered:function(e){var v,w,B=this,y=e.target,z=aR(e.target).parent(),A=z.get(0).rowIndex,s=B.options,g=s.mode,x=s.type,u=B._grid.dataSource,b=s.batch,a=B._grid.trigger(aL,{commandName:bc,cancel:!1,row:z,cell:y});if(!a.cancel){if(b){if(v=B._grid.contentTable.find(".sui-editable-cell"),v.length>0){if(A=v.get(0).parentNode.rowIndex,"TR"!==z.get(0).nodeName.toUpperCase()||z.get(0).rowIndex==A&&"row"==x){return}var t=B._grid._updateItem(A,y);if(B._errorDuringEdit){return B._errorDuringEdit=!1,void (t=null)}w=z.get(0).rowIndex,B._grid._putRowInViewMode(A,null),!B._grid._populateInsertedItem&&t&&t.length>0&&B._grid._renderUpdateMarkers(t,A),B._grid._populateInsertedItem=!1,w===A&&(y=B._grid.contentTable.find("tbody > tr").eq(A).get(0).cells[y.cellIndex]),A=w}aJ(x)||"cell"===x?B._putCellInEditMode(y,A):"row"===x?B._putRowInEditMode(z,y.cellIndex):aQ.error("Invalid editing.type declaration. The editing.type must be 'row' or 'cell'.",this.options.dieOnError)}else{if(u.tracker&&u.tracker.changes&&u.tracker.changes.added&&u.tracker.changes.added.length>0){"TR"!==z.get(0).nodeName.toUpperCase()||z.get(0).rowIndex==A&&"row"==x||u.cancel()}else{if(aJ(g)||"inline"===g){if(v=B._grid.contentTable.find(".sui-editable-cell"),v.length>0){if(A=v.get(0).parentNode.rowIndex,"TR"!==z.get(0).nodeName.toUpperCase()||z.get(0).rowIndex==A&&"row"==x){return}if(B._grid._updateItem(A,y),B._errorDuringEdit){return void (B._errorDuringEdit=!1)}w=z.get(0).rowIndex,B._grid._closeAllEditedRows(),w===A&&(y=B._grid.contentTable.find("tbody > tr").eq(A).get(0).cells[y.cellIndex]),A=w}aJ(x)||"cell"===x?B._putCellInEditMode(y,A):"row"===x?B._putRowInEditMode(z,y.cellIndex):aQ.error("Invalid editing.type declaration. The editing.type must be 'row' or 'cell'.",this.options.dieOnError)}}}B._grid.trigger(bc,{row:z,cell:y})}},_documentClicked:function(j){var l,n,a=this,i=a.options.batch,m=aR(j.target);if(a._grid._editingInProcess||a._grid._preventClosingEditors){return void (a._grid._editingInProcess=!1)}if(!(m.hasClass("sui-cell")||m.parents().hasClass("sui-cell")||m.parents().hasClass("sui-calendar")||m.parents().hasClass("sui-listbox"))&&(l=this._grid.contentTable.find(".sui-editable-cell"),l.length>0)){n=l.get(0).parentNode.rowIndex;var k=a._grid._updateItem(n,null);if(a._errorDuringEdit){return void (a._errorDuringEdit=!1)}a._grid._putRowInViewMode(n,null),i&&!a._grid._populateInsertedItem&&k&&k.length>0&&a._grid._renderUpdateMarkers(k,n),a._grid._populateInsertedItem=!1}},_getColumnIndex:function(a){return a.cellIndex-aR(a.parentNode).find(".sui-indent-cell, .sui-expand-cell, .sui-expand-cell-disabled, .sui-collapse-cell").length},_putCellInEditMode:function(y,q){var r,s,v,z=this,o=z._getColumnIndex(y),p=z._grid,u=p.dataSource,w=p.columns[o];if(w&&w.field){if(u.group&&u.group.length>0){for(s=z._grid.contentTable.find(".sui-row, .sui-alt-row"),v=0;v<s.length;v++){if(s[v]==y.parentNode){q=v;break}}}r=u.editView(q).data;var n=u.schema.options.fields[w.field].type,t=bp(r,w.field),x=!1;if(arguments.length>2?arguments[2]==o&&(x=!0):x=!0,w.editor){z._instantiateCustomEditor(w,y,r,q,x)}else{switch(n){case Number:z._instantiateNumeric(y,t,x);break;case Date:z._instantiateDatePicker(y,t,x);break;case String:z._instantiateTextBox(y,t,x);break;case Boolean:z._instantiateCheckBox(y,t,x)}}}},_prepareCell:function(a){aR(a).empty().addClass("sui-editable-cell")},_instantiateCustomEditor:function(n,s,m,l,a,q){var p,r,o,t=this;q?r=q:(p=t._getColumnIndex(s),r=t._grid.columns[p].field,t._prepareCell(s)),o=n.editor.call(t._grid,s,m,l,a),aR(s).html(o),t._editors[r]="custom"},_instantiateNumeric:function(s,o,f,p){var r,t,q,u,v=this;p?u=p:(q=v._getColumnIndex(s),u=v._grid.columns[q].field,v._prepareCell(s)),t=aR("<input name='"+u+"' />"),t.appendTo(s);var b=v._grid.trigger(bb,{field:u,options:{}}),a=aK({},b.options,{value:o});aQ.ui.NumericTextBox&&(r=new aQ.ui.NumericTextBox(t,a),f&&r.focus(),v._editors[u]=r)},_instantiateDatePicker:function(s,o,f,p){var r,t,q,u,v=this;p?u=p:(q=v._getColumnIndex(s),u=v._grid.columns[q].field,v._prepareCell(s)),t=aR("<input name='"+u+"' />"),t.appendTo(s);var b=v._grid.trigger(bb,{field:u,options:{}}),a=aK({},b.options,{value:o});aQ.ui.DatePicker&&(r=new aQ.ui.DatePicker(t,a),f&&r.focus(),v._editors[u]=r)},_instantiateTextBox:function(s,o,f,p){var r,t,q,u,v=this;p?u=p:(q=v._getColumnIndex(s),u=v._grid.columns[q].field,v._prepareCell(s)),t=aR("<input type='text' name='"+u+"' />"),t.appendTo(s);var b=v._grid.trigger(bb,{field:u,options:{}}),a=aK({},b.options,{value:o,cls:"sui-input-textbox"});aQ.ui.TextBox&&(r=new aQ.ui.TextBox(t,a),f&&r.focus(),v._editors[u]=r)},_instantiateCheckBox:function(r,q,f,o){var t,s,p,u,v=this;o?u=o:(p=v._getColumnIndex(r),u=v._grid.columns[p].field,v._prepareCell(r)),s=aR("<input type='checkbox' name='"+u+"' />"),s.appendTo(r);var b=v._grid.trigger(bb,{field:u,options:{}}),a=aK({},b.options,{value:q});aQ.ui.CheckBox&&(t=new aQ.ui.CheckBox(s,a),f&&t.focus(),t.checked(q),v._editors[u]=t)},_putRowInEditMode:function(a,h){var k,l,j=this,i=a.find(".sui-cell");for(l=0;l<i.length;l++){j._putCellInEditMode(i[l],a.get(0).rowIndex,h-a.find(".sui-indent-cell, .sui-expand-cell, .sui-expand-cell-disabled, .sui-collapse-cell").length)}k=a.find(".sui-edit"),k.length>0&&j._grid._changeEditColumnButtons(a.get(0).rowIndex,aR(a.find(".sui-button-cell")[0]))},_destroyRow:function(k){var i,m,h=this,l=h._grid,j=l.contentTable.find("tbody > tr").eq(k),n=l.columns;for(i=0;i<n.length;i++){m=h._editors[n[i].field],m&&(av(m.destroy)&&h._editors[n[i].field].destroy(),delete h._editors[n[i].field])}j.remove()},destroy:function(){var h,d,a=this,g=a._eventNS;if(a._grid.dataSource.off(a4+g),a._grid.element.off(g,".sui-cell"),aR(aM).off(aE+g),a._editors){for(h=0;h<a._editors.length;h++){d=a._editors[h].editor.element(),a._editors[h].editor.destroy(),d.remove()}}a._grid=a._errorDuringEdit=a.options=null}}),bu=aB.extend({init:function(d){var c=this;bl(d)?(c.field=d,c.resizable=!0,c.sortable=!0,c.filterable=!0):a8(d)&&(c.field=d.field,c.title=d.title,c.format=d.format,c.width=d.width,c.minWidth=d.minWidth,c.maxWidth=d.maxWidth,c.resizable=aF(d.resizable)?!!d.resizable:!0,c.attributes=d.attributes,c.headerAttributes=d.headerAttributes,c.headerTemplate=d.headerTemplate,c.columnTemplate=d.columnTemplate,c.footerTemplate=d.footerTemplate,c.groupFooterTemplate=d.groupFooterTemplate,c.buttons=d.buttons,c.editor=d.editor,c.customFilter=d.customFilter,c.sortable=aF(d.sortable)?!!d.sortable:!0,c.filterable=aF(d.filterable)?!!d.filterable:!0),c.visible=!0},destroy:function(){var b=this;b.buttons&&(b.buttons.length=0),b.field=b.title=b.editor=b.format=b.width=b.minWidth=b.maxWidth=b.resizable=b.attributes=b.headerAttributes=b.headerTemplate=b.buttons=b.customFilter=b.footerTemplate=b.groupFooterTemplate=b.sortable=b.filterable=b.columnTemplate=null}}),aV=aB.extend({options:{ns:".shieldGridColumnResizing",width:12,offset:6,min:12},init:function(c){var d=this;d.grid=c,d.options=aK(!0,{},aV.fn.options),d._eventNS=d.options.ns+ap(),c.headerTable.on(at+d._eventNS,".sui-headercell",aP(d._showHandle,d))},_showHandle:function(j){if(!this.resizing){var n=this,k=n.options,m=(n.grid,n.handle),l=j.pageX,a=n.params=n._params(aR(j.currentTarget)),c=l>=a.offset.left&&l<=a.offset.left+k.offset&&a.headerIndex>0;a.isRtl&&(c=l>=a.offset.left+a.width-k.offset&&l<=a.offset.left+a.width&&a.headerIndex>0),c&&(a=n.params=n._params(a.header.prev())),a.column&&a.column.resizable&&(l>=a.threshold&&l<=a.edge+k.offset?(m||(m=n.handle=aR('<div class="sui-resizable-handle"/>').on(au+n._eventNS,aP(n._down,n)).appendTo(a.header.parents(".sui-headercontent"))),m.css({top:a.position.top,left:m.parent()[0].scrollLeft+a.handleLeft,width:k.width,height:a.height}).show()):m&&m.hide())}},_params:function(z){var u=this,y=u.options,q=z.offset(),s=z.position(),w=ax.isRtl(u.grid.element),v=z.outerWidth(),r=q.left+(w?y.width:v),o=z.index(),t=z.parent().children("th.sui-headercell").index(z),x=t>-1?u.grid.columns[t]:null,p=x?x.minWidth>=0?+x.minWidth:y.min:null,n=x&&x.maxWidth>=p?+x.maxWidth:null;return{header:z,headerIndex:o,colIndex:t,column:x,min:p,max:n,offset:q,isRtl:w,width:v,current:v,height:z.outerHeight(),edge:r,threshold:r-y.width+(w?-1:1)*y.offset,position:s,handleLeft:s.left+(w?y.width:v)-y.width+(w?-1:1)*y.offset}},_down:function(b){var c,j=this,a=j.grid,d=j.params;if(!(b.button>1)&&d){return c="> colgroup col:nth-child("+(d.headerIndex+1)+")",d.origin=b.pageX,d.cols=aR().add(a.headerTable.find(c)).add(a.contentTable.find(c)),j.resizing=!0,j.handle.hide(),aR(aM).on(at+j._eventNS,aP(j._move,j)).on(bh+j._eventNS,aP(j._up,j)),aQ.selection(!1),!1}},_move:function(i){var j=this,g=j.params,h=(g.isRtl?-1:1)*(i.pageX-g.origin),f=az(g.width+h,g.min);return g.max&&(f=ay(f,g.max)),j.resizing?void (f!==g.current&&g.cols.width(g.current=f)):void j._up()},_up:function(){var l=this,k=l.grid,j=l.params.colIndex,d=l.params.current,b=k.columns[j]||{},a=(k.options.columns||[])[j]||{};l.resizing=!1,l.params=null,b.width=a.width=d+"px",aR(aM).off(l._eventNS),aQ.selection(!0)},destroy:function(){var b=this;b._up(),b.grid.headerTable.off(b._eventNS),b.grid=null,b.handle&&(b.handle.off(b._eventNS).remove(),b.handle=null)}}),aH=aB.extend({init:function(c){var d=this;d.grid=c,d._filters={},d._eventNS=".shieldGridFiltering"+ap(),d._createFilterRow()},_createFilterRow:function(){var d,t,v,w,z,x=this,u=x.grid,a=u.headerTable,j=a.find(">thead"),r=aR("<tr class='sui-filter-row' />"),c=j.find(".sui-indent-cell").length,s=u.dataSource.schema,y=u.columns;for(z=0;c>z;z++){aR('<th class="sui-indent-cell">').appendTo(r)}for(s&&s.options.fields&&(w=s.options.fields),z=0;z<y.length;z++){d=w&&w[y[z].field]?w[y[z].field].type:null,t=y[z].field?y[z].field.replace(/[\"\']/g,"@"):"",v=aR('<th class="sui-filter-cell"  data-field="'+t+'"/>').appendTo(r),y[z].filterable!==!1&&t.length>0&&(x._initializeEditor(v,d,y[z].field,y[z]),x._appendFilterButton(v))}r.appendTo(j),aR(aM).on(aE+x._eventNS,aP(x._documentClicked,x))},_documentClicked:function(h){var j,g,i=this;if(i.listBox&&!aR(h.target).hasClass("sui-filter-button")&&!aR(h.target).hasClass("sui-filter-button-content")){var a=i.listBox.element.parent();if("none"==a.css("display")){return}i._filterByField=null,j=a.height(),g=a.offset().top,i._slideUp?a.animate({height:0,top:g+j},150,function(){a.css({display:ar,height:j})}):a.animate({height:0},150,function(){a.css({display:ar,height:j})})}},_appendFilterButton:function(b){if(aQ.ui.Button){var a=aR('<button type="button"><span class="sui-sprite sui-filter-button-content"></span></button>').appendTo(b);new aQ.ui.Button(a,{cls:"sui-filter-button",events:{click:aP(this._filterButtonClicked,this)}})}},_filterButtonClicked:function(w){var r,v,b,x=this,d=x.grid,f=d.dataSource.schema,u=d.options.filtering,c=u.stringFunc?u.stringFunc:[{func:"eq",name:"Equal to"},{func:"neq",name:"Not equal to"},{func:"con",name:"Contains"},{func:"notcon",name:"Not contains"},{func:"starts",name:"Starts with"},{func:"ends",name:"Ends with"},{func:"gt",name:"Greater than"},{func:"lt",name:"Less than"},{func:"gte",name:"Greater than or equal"},{func:"lte",name:"Less than or equal"},{func:"isnull",name:"Is null"},{func:"notnull",name:"Is not null"}],a=u.nonStingFunc?u.nonStingFunc:[{func:"eq",name:"Equal to"},{func:"neq",name:"Not equal to"},{func:"gt",name:"Greater than"},{func:"lt",name:"Less than"},{func:"gte",name:"Greater than or equal"},{func:"lte",name:"Less than or equal"},{func:"isnull",name:"Is null"},{func:"notnull",name:"Is not null"}],s=w.target.element.parent().attr("data-field").replace(/[@]/g,"'");if(x._filterByField=s,f&&f.options.fields){var t=f.options.fields;r=t&&t[s]&&t[s].type===String?c:a}else{r=c}aQ.ui.ListBox&&(x.listBox||(x._menuWrapper=aR('<div style="display: none;" />').appendTo(aM.body),x.listBox=new aQ.ui.ListBox(x._menuWrapper,aK({},{},{dataSource:{data:r},textTemplate:"{name}",valueTemplate:"{func}",multiple:!1,width:150,maxHeight:300,events:{select:aP(x._selectFilterFunction,x)}})),x.grid.element.parent().hasClass("sui-rtl")?x.listBox.element.parent().addClass("sui-rtl"):x.listBox.element.parent().css(ao,ar)),v=x.listBox.element.parent().height(),x._positionListBox(w),x._slideUp?(b=w.target.element.offset().top-v,x.listBox.element.parent().css({top:w.target.element.offset().top}),x.listBox.element.parent().animate({height:v,top:b-x.listBox.element.parent().innerHeight()},150)):x.listBox.element.parent().animate({height:v},150)),x._selectFilterMenuValue()},_selectFilterMenuValue:function(){var h,j,g=this,i=g._filterByField,l=g.grid.dataSource.filter;if(l&&l.and&&l.and.length>0){h=l.and;for(var k=0;k<h.length;k++){h[k].path===i&&(j=h[k].filter)}}j?g.listBox.values(j):g.listBox.clearSelection()},_selectFilterFunction:function(j){var p,l,r=this,k=!0,q="@@custom"==r._filters[r._filterByField]?"@@custom":r._filters[r._filterByField].value(),o=j.item.func,n={path:r._filterByField,filter:o,value:q};if("@@custom"==q&&(l=r.grid.trigger(af,{field:r._filterByField,value:null}),q=l.value,n={path:r._filterByField,filter:o,value:q}),""!==q&&null!==q||"notnull"==o||"isnull"==o){if(r.grid.dataSource.filter&&r.grid.dataSource.filter.and){p=r.grid.dataSource.filter.and;for(var m=0;m<p.length;m++){p[m].path===r._filterByField&&(p[m]=n,k=!1)}k&&p.push(n)}else{r.grid.dataSource.filter={and:[n]}}r.grid.dataSource.read(),r._addRemoveFilterButton()}},_addRemoveFilterButton:function(){var l,k,c,b=this;if(aQ.ui.Button){l=b.grid.headerTable.find(".sui-filter-row > th");for(var j=0;j<l.length;j++){if(k=aR(l[j]),k.attr("data-field")&&k.attr("data-field").replace(/[@]/g,"'")==b._filterByField){c=l[j];break}}if(0===k.find(".sui-clear-filter-button").length){var a=aR('<button type="button"><span class="sui-sprite sui-clear-filter-button-content"></span></button>').appendTo(c);new aQ.ui.Button(a,{cls:"sui-clear-filter-button",events:{click:aP(this._clearFilterButtonClicked,this)}})}}},_clearFilterButtonClicked:function(k){for(var i,h=this,g=k.target.element.parent().attr("data-field").replace(/[@]/g,"'"),j=h.grid.dataSource.filter.and,l=0;l<j.length;l++){j[l].path==g&&j.splice(l,1)}i=k.target.element,k.target.destroy(),i.remove(),"@@custom"!=h._filters[g]?h._filters[g].value(null):h.grid.trigger(br,{field:g,value:null}),h.grid.dataSource.read()},_positionListBox:function(j){var r=this,o=j.target.element,n=o.offset(),q=n.top,p=n.left,l=r.listBox.element.parent().innerWidth(),k=r.listBox.element.parent().innerHeight(),m=(o.innerWidth(),o.innerHeight());0>p&&(p=1),p+l>an.innerWidth&&(p=an.innerWidth-l-20),r._slideUp=!1,q+k>an.innerHeight&&(q-=k,m=0,r._slideUp=!0),0>q&&(q=n.top,m=o.innerHeight(),r._slideUp=!1),r.listBox.element.parent().css({position:"absolute",zIndex:10002,top:q+m,left:p,height:0,display:""})},_initializeEditor:function(f,h,j,i){var g=this;if(i.customFilter){g._filters[j]="@@custom",i.customFilter.call(g,f)}else{switch(h){case Number:g._instantiateNumeric(f,j);break;case Date:g._instantiateDatePicker(f,j);break;case String:g._instantiateTextBox(f,j);break;default:g._instantiateTextBox(f,j)}}},_instantiateNumeric:function(f,n){var m,l=this,k=aR("<input />");k.appendTo(f);var b=l.grid.trigger(a1,{field:n,options:{}}),a=aK({},b.options);aQ.ui.NumericTextBox&&(m=new aQ.ui.NumericTextBox(k,a),l._filters[n]=m)},_instantiateDatePicker:function(f,n){var m,l=this,k=aR("<input />");k.appendTo(f);var b=l.grid.trigger(a1,{field:n,options:{}}),a=aK({},b.options);aQ.ui.DatePicker&&(m=new aQ.ui.DatePicker(k,a),l._filters[n]=m)},_instantiateTextBox:function(f,n){var m,l=this,k=aR("<input type='text' />");k.appendTo(f);var b=l.grid.trigger(a1,{field:n,options:{}}),a=aK({},b.options);aQ.ui.TextBox&&(m=new aQ.ui.TextBox(k,a),l._filters[n]=m)},destroy:function(){var d,a=this;a.grid=null;for(d in a._filters){a._filters.hasOwnProperty(d)&&(a._filters[d].destroy(),a._filters[d]=null)}a.listBox&&(a.listBox.destroy(),a.listBox=null),aR(aM).off(aE+a._eventNS),a._filterByField=a._filters=a._slideUp=a._menuWrapper=null}}),aj=aB.extend({init:function(d,f){var e=this;e.grid=f,e.sortExpressions=[],e._eventNS=".shieldGridSorting"+ap(),ai(d)?(e.allowUnsort=!0,e.multiple=!1,e.firstAscending=!0,e.ascText="&#9650;",e.descText="&#9660;"):a8(d)&&(e.allowUnsort=aJ(d.allowUnsort)?!0:d.allowUnsort,e.multiple=d.multiple,e.firstAscending=aJ(d.firstAscending)?!0:d.firstAscending,e.ascText=aJ(d.ascText)?"&#9650;":d.ascText,e.descText=aJ(d.descText)?"&#9660;":d.descText),e._initialize()},destroy:function(){var a=this;a.allowUnsort=a.multiple=a.sortExpressions=null,a.length=0,a._click&&(a.grid.headerTable.find(".sui-link").each(function(){aR(this).off(aE+a._eventNS)}),a._click=null),a.grid=null},_initialize:function(){var x=this,s=x.grid,u=s.dataSource.sort,v=s.columns,r=s.headerTable.find(".sui-headercell");if(x._click=aP(x._clickHandler,x),r.each(function(e){var g=aR(this),b=g.html();v[e].sortable!==!1&&(g.empty(),aR('<a href="#" class="sui-link"></a>').appendTo(g).html(b).on(aE+x._eventNS,x._click))}),u){for(var t=0;t<u.length;t++){for(var a=u[t],w=0;w<v.length;w++){if(v[w].sortable!==!1&&a.path==v[w].field){var p=aR(r[w]).find(".sui-link"),j="ascending",c="sui-asc",q=x.ascText;a.desc&&(j="descending",q=x.descText,c="sui-desc"),p.addClass(c),aR('<span class="sui-'+j+'">'+q+"</span>").appendTo(p)}}}}},_clickHandler:function(i){var a=this,k=aR(i.target).closest(".sui-link"),j=a.grid,h=bj(k.parent().get(0),j.headerTable.find(".sui-headercell")),l=j.columns[h];return k.hasClass("sui-desc")?a.allowUnsort&&a.firstAscending?a._sortInternal(l,!0,!0):a._sortInternal(l,!1,!1):k.hasClass("sui-asc")?a.allowUnsort&&!a.firstAscending?a._sortInternal(l,!1,!0):a._sortInternal(l,!0,!1):a.firstAscending?a._sortInternal(l,!1,!1):a._sortInternal(l,!0,!1),!1},_sortInternal:function(r,s,q){var o=this,p=o.grid,n=p.dataSource,t=n.sort,e=p.trigger(aL,{commandName:aA,cancel:!1,column:r,desc:s,unsort:q});if(!e.cancel){if(t){if(!o.multiple&&t){t.length=0}else{var m=aR.grep(t,function(b){return b.path===r.field&&b.desc===(q?s:!s)});if(m.length>0){var a=bj(m[0],t);t.splice(a,1)}}q||t.push({path:r.field,desc:s})}else{q||(t=n.sort=[{path:r.field,desc:s}])}p._refreshOnSort(),p.trigger(aA,{column:r,desc:s,unsort:q})}},_sort:function(u,r,p){var t,s,a=this,q=a.grid,m=q.dataSource,v=m.sort;if(v&&(t=aR.grep(v,function(b){return b.path===u&&b.desc===r})),!t||t.length<=0){if(!a.multiple&&v&&(v.length=0),v){var o=!1,n=aR.grep(v,function(b){return b.path===u&&b.desc!=r});n&&n.length>0&&(s=bj(n[0],v),v.splice(s,1),o=!0),p||(v.push({path:u,desc:r}),o=!0),o&&q._refreshOnSort()}else{p||(m.sort=[{path:u,desc:r}],q._refreshOnSort())}}else{p&&(s=bj(t[0],v),v.splice(s,1),q._refreshOnSort())}}}),ae=aB.extend({init:function(d,k,l,c){var g,a=this;g=a._eventNS=".shieldGridSelection"+ap(),ai(l)?(a.type="row",a.multiple=!1,a.toggle=!1,a.spreadsheet=!0):a8(l)&&(a.type=l.type?l.type:"row",a.multiple=l.multiple,a.toggle=l.toggle?l.toggle:!1,a.spreadsheet=aJ(l.spreadsheet)?!0:l.spreadsheet),a.parentGrid=c,k.addClass(bq),d.addClass("sui-non-selectable"),a.table=k,a.lastSelected=null,k.on(au+g,aP(a._mouseDownHandler,a)),k.on(at+g,aP(a._mouseMoveHandler,a)),aR(aM).on(bh+g,aP(a._mouseUpHandler,a)),bn&&k.on(aX+g,function(){return !1}),a.multiple&&(a.area=aR(aM.createElement("span")),a.area.addClass("sui-area sui-area-color"))},destroy:function(){var d=this,c=d._eventNS;d.parentGrid=null,d.type=null,d.multiple=null,d.lastSelected=null,d.toggle=null,d.spreadsheet=null,d.table.off(c),d.x=null,d.y=null,d.table.off(aX+c),d.elements=null,d.table=null,d.area&&(d.area.remove(),d.area=null)},select:function(a){var d=this;return a?void a.each(function(){d._selectElement(aR(this))}):d.table.find("."+aC)},clear:function(){var b=this;"row"==b.type?b._clearSelectedRows():b._clearSelectedCells()},_getParentTable:function(b){return b?"TABLE"==b[0].nodeName.toUpperCase()?b[0]:b.parent()?this._getParentTable(b.parent()):void 0:void 0},_mouseDownHandler:function(c){var j=this,b=c.pageX,a=c.pageY,d=aR(c.target);j.x=b,j.y=a,("TD"!=d[0].nodeName.toUpperCase()||j._getParentTable(d)==j.table[0])&&(!(d.hasClass("sui-cell")||d.hasClass("sui-row")||d.hasClass("sui-alt-row"))||d.hasClass("sui-detail-cell")||d.hasClass("sui-detail-row")||d.hasClass("sui-collapse-cell")||d.hasClass("sui-expand-cell")||d.hasClass("sui-expand-cell-disabled")||d.hasClass("sui-indent-cell")||(j.multiple&&j.area.appendTo(aM.body).css({left:b+1,top:a+1,width:0,height:0}),aR(aM).on(at+j._eventNS,aP(j._mouseMoveHandler,j)),aQ.selection(!1),j.elements=bm(c,j.table)))},_mouseMoveHandler:function(h){var i=this,n=h.pageX,m=h.pageY,l=i.x,k=i.y,j={left:l>n?n:l,top:k>m?m:k,width:aq(n-i.x),height:aq(m-i.y)};i.multiple&&i.area.css(j),h.preventDefault()},_mouseUpHandler:function(r){var y,w,a,x,z=this,u=z.parentGrid,b=r.ctrlKey,t=z.area,e=z.elements,v=[],s=[],d=[];if(aR(aM).off(at+z._eventNS),aQ.selection(!0),e){for(z.elementsToBeSelected=[],"row"==z.type?z._performRowSelection(t,b,e,r):z._performCellSelection(t,b,e,r),x=0;x<z.elementsToBeSelected.length;x++){y=z.elementsToBeSelected[x],!(y.hasClass("sui-cell")||y.hasClass("sui-row")||y.hasClass("sui-alt-row"))||y.hasClass("sui-detail-cell")||y.hasClass("sui-detail-row")||y.hasClass("sui-collapse-cell")||y.hasClass("sui-expand-cell")||y.hasClass("sui-expand-cell-disabled")||y.hasClass("sui-indent-cell")||(v.push(y),w=u._getRowIndex("row"==z.type?y:aR(y).parent()),s.push(w),d.push(w>=0?u.dataSource.getDataIndex(w):w))}if(a=u.trigger(aL,{commandName:bk,cancel:!1,toBeSelected:v,viewIndices:s,indices:d}),!a.cancel){for(x=0;x<v.length;x++){z._selectElement(v[x])}u.trigger(bk,{selected:v,viewIndices:s,indices:d}),z.elements=null}}t&&t.remove()},_performRowSelection:function(l,k,m,a){var n=this;if(!(aR(a.target).hasClass("sui-expand-cell")||aR(a.target).hasClass("sui-expand-cell-disabled")||aR(a.target).hasClass("sui-collapse-cell")||aR(a.target)&&aR(a.target).parent()&&(aR(a.target).parent().hasClass("sui-expand-cell")||aR(a.target).parent().hasClass("sui-expand-cell-disabled")||aR(a.target).parent().hasClass("sui-collapse-cell")))){if(l&&0===l.height()&&0===l.width()){n.multiple?n._processMultiRowSelection(a,m):n._processSingleRowSelection(a,m)}else{if(n.multiple){var i=n.table.find(">tbody > tr"),j=null;bo(i,function(b,o){var h=aR(o),g=h.offset().top;g<a.pageY&&(j=o.rowIndex)}),k||n._clearSelectedRows(),n._selectRowRange(m.row.rowIndex,j,k)}else{n._processSingleRowSelection(a,m)}}}},_performCellSelection:function(n,l,m,r){var q=this;if(!(aR(r.target).hasClass("sui-expand-cell")||aR(r.target).hasClass("sui-expand-cell-disabled")||aR(r.target).hasClass("sui-collapse-cell")||aR(r.target)&&aR(r.target).parent()&&(aR(r.target).parent().hasClass("sui-expand-cell")||aR(r.target).parent().hasClass("sui-expand-cell-disabled")||aR(r.target).parent().hasClass("sui-collapse-cell")))){if(n&&0===n.height()&&0===n.width()){q.multiple?q._processMultiCellSelection(r,m):q._processSingleCellSelection(r,m)}else{if(q.multiple){var p,k=q.table.find(">tbody > tr > td"),o=[];for(bo(k,function(E,y){var D=aR(y),b=D.get(0).clientWidth,F=D.get(0).clientHeight,B=D.offset().top,A=D.offset().left,e=B+F,v=A+b,x=ay(r.pageX,q.x),c=az(r.pageX,q.x),w=ay(r.pageY,q.y),G=az(r.pageY,q.y),z=!1,C=!1;w>B?e>w&&(z=!0):G>B&&(z=!0),x>A?v>x&&(C=!0):c>A&&(C=!0),z&&C&&o.push(y)}),l||q._clearSelectedCells(),p=0;p<o.length;p++){var a=aR(o[p]);a.hasClass(aC)?q._deselectElement(aR(o[p])):q.elementsToBeSelected.push(aR(o[p]))}}else{q._processSingleCellSelection(r,m)}}}},_selectRowRange:function(o,n,m){var r,q,p=this,l=ay(o,n),k=az(o,n),a=p.table.find(">tbody > tr");for(r=l;k>=r;r++){q=aR(a[r]),m&&q.hasClass(aC)?p._deselectElement(q):p.elementsToBeSelected.push(q)}},_clearSelectedRows:function(){var a=this,d=a.table.find(">tbody>tr."+aC);bo(d,function(b,e){a._deselectElement(aR(e))})},_clearSelectedCells:function(){var a=this,d=a.table.find(">tbody > tr > td."+aC);bo(d,function(b,e){a._deselectElement(aR(e))})},_processSingleRowSelection:function(i,m){var a=this,l=(a.table,a.toggle),k=a.multiple,n=aR(m.row),j=n.hasClass(aC);k||a._clearSelectedRows(),l?j?a._deselectElement(n):a.elementsToBeSelected.push(n):(a._clearSelectedRows(),a.elementsToBeSelected.push(n)),a.lastSelected=n},_processMultiRowSelection:function(y,x){var C=this,a=C.table,u=y.ctrlKey,t=y.shiftKey,B=aR(x.row);if(u){B.hasClass(aC)?(C._deselectElement(B),C.lastSelected=B):(C.elementsToBeSelected.push(B),C.lastSelected=B)}else{if(t){C.table.find(">tbody tr."+aC);if(C.lastSelected){var D=C.lastSelected,A=D.get(0).rowIndex,w=a.find(">tbody > tr"),v=B.get(0).rowIndex,n=ay(v,A),l=az(v,A);C._clearSelectedRows();for(var z=n;l>=z;z++){if(z!==A){var o=aR(w[z]);C.elementsToBeSelected.push(o)}}C.elementsToBeSelected.push(aR(w[A]))}else{C.elementsToBeSelected.push(B),C.lastSelected=B}}else{C._processSingleRowSelection(y,x)}}},_processSingleCellSelection:function(i,m){var a=this,l=(a.table,a.toggle),k=a.multiple,n=aR(m.cell),j=n.hasClass(aC);a.lastSelected;k||a._clearSelectedCells(),l?j?a._deselectElement(n):a.elementsToBeSelected.push(n):(a._clearSelectedCells(),a.elementsToBeSelected.push(n)),a.lastSelected=n},_processMultiCellSelection:function(R,D){var X=this,M=X.table,o=R.ctrlKey,n=R.shiftKey,W=aR(D.cell);if(o){W.hasClass(aC)?(X._deselectElement(W),X.lastSelected=W):(X.elementsToBeSelected.push(W),X.lastSelected=W)}else{if(n){if(X.lastSelected){var V,P=X.lastSelected,G=X.table.get(0),K=G.rows[0].cells.length,N=P.parent().get(0).rowIndex,U=N*K+P.get(0).cellIndex,I=M.find(">tbody > tr > td"),O=W.parent().get(0).rowIndex,F=O*K+W.get(0).cellIndex,S=ay(F,U),Q=az(F,U);if(X._clearSelectedCells(),X.spreadsheet){var L=P[0].cellIndex,E=W[0].cellIndex;S=ay(L,E),Q=az(L,E);var l=ay(N,O),a=az(N,O);for(V=l;a>=V;V++){var T,J=G.rows[V];for(T=S;Q>=T;T++){X.elementsToBeSelected.push(aR(J.cells[T]))}}}else{for(V=S;Q>=V;V++){if(V!==U){var H=aR(I[V]);X.elementsToBeSelected.push(H)}}}X.elementsToBeSelected.push(aR(I[U]))}else{X.elementsToBeSelected.push(W),X.lastSelected=W}}else{X._processSingleCellSelection(R,D)}}},_selectElement:function(b){b.addClass(aC)},_deselectElement:function(b){b.removeClass(aC)}}),bv=aB.extend({options:{ns:".shieldGridGroupReorder",returnDuration:50,returnEasing:"ease-out",dragTreshold:20,draggedTemplate:"<div style='border-color:transparent;' class='sui-grid sui-grid-core'><div class='sui-group-panel-indicator'><span class='sui-group-title'>{0}</span><span class='sui-group-close-button'></span></div></div>"},init:function(c){var d=this;d.grid=c,d.options=aK(!0,{},bv.fn.options),d._eventNS=d.options.ns+ap(),d._events(!0)},_events:function(f){var e=this,c=e.grid.element;f?(e._downProxy=aP(e._down,e),c.on(au+e._eventNS,".sui-group-panel-indicator",e._downProxy)):(c.off(au+e._eventNS,".sui-group-panel-indicator",e._downProxy),e._downProxy=null)},_down:function(n){var p=this,o=aR(n.target).closest(".sui-group-panel-indicator"),d=o.offset(),m=p.grid.element,c=m.offset(),b=n.pageX,a=n.pageY;return p.dataField=o.attr("data-field"),n.button>1?void 0:(p._moveProxy=aP(p._move,p),p._upProxy=aP(p._up,p),aR(aM).on(at+p._eventNS,p._moveProxy).on(bh+p._eventNS,p._upProxy),p.start={left:b-d.left,top:a-d.top,x:b,y:a,target:o,index:o.parent().find(".sui-group-panel-indicator").index(o),positions:p._positions(o),gridPosition:{left:c.left,top:c.top,width:m.outerWidth(),height:m.outerHeight()},isRtl:ax.isRtl(m)},aQ.selection(!1),!1)},_move:function(m){var p=this,l=p.options,k=p.dragged,a=p.start,o=m.pageX,n=m.pageY,d=l.dragTreshold;k?(k.css({left:o-a.left,top:n-a.top}),p.hovered=p._index(o,n),p._indicator()):(aq(a.x-o)>d||aq(a.y-n)>d)&&(p.dragged=aR(aD(l.draggedTemplate,a.target.html())).css({position:"absolute",left:o-a.left,top:n-a.top,zIndex:999}).find("table").css("width","auto").end().find("th").attr("style",a.target[0].style.cssText).css({width:a.target.width(),height:a.target.height()}).end().appendTo(aM.body))},_positions:function(i){var h,l,k=i.parent().children(".sui-group-panel-indicator"),g=0,j=[];for(g;g<k.length;g++){h=k.eq(g),l=h.offset(),j.push({left:l.left,top:l.top,width:h.outerWidth(),height:h.outerHeight()})}return j},_index:function(o,n){var j,p,l,k,m=this.start,i=m.gridPosition;for(p=0;p<m.positions.length;p++){if(j=m.positions[p],l=j.left<=o&&o<=j.left+j.width&&j.top<=n&&n<=j.top+j.height,k=i.left<=o&&o<=i.left+i.width&&i.top<=n&&n<=i.top+i.height,l&&k){return p}}return -1},_indicator:function(){var o,q=this,t=q.start,s=q.hovered,p=t.positions[s],r=q.reorderIndicator,m=t.gridPosition.left,d=t.gridPosition.left+t.gridPosition.width,n=t.target.parent().children(".sui-group-panel-indicator"),a=t.isRtl?t.index<s:t.index>s;n.removeClass("sui-reorder-target"),r&&r.hide(),null!=s&&s>-1&&(n.eq(s).addClass("sui-reorder-target"),r||(r=q.reorderIndicator=aR("<div class='sui-grid-reorder-indicator'><span class='sui-grid-indicator-top' /><span class='sui-grid-indicator-bottom' /></div>").appendTo(aM.body)),s!==t.index&&(o=p.left+(a?0:p.width),r.css({left:ay(az(m,o),d),top:p.top,height:p.height}).show()))},_up:function(a){var w,x=this,d=x.options,v=x.grid,r=x.dragged,e=x.start,u=x.hovered,p=x.dataField;if(x._detachDocumentEvents(),r){if(null!=u&&u>-1){if(r.remove(),w=v.trigger(aL,{commandName:bA,cancel:!1,index:e.index,newIndex:u}),!w.cancel){for(var t=v.dataSource.group,s=0;s<t.length;s++){if(t[s].field==p){var b=t[s];t[s]=t[u],t[u]=b;break}}}}else{setTimeout(function(){r.remove()},ax.transitions?d.returnDuration:0),x.grid.dataSource.group&&(w=v.trigger(aL,{commandName:bg,cancel:!1,field:p}),w.cancel||(x.grid.ungroup(p),v.trigger(bg,w)))}}x.dragged=x.dataField=x.hovered=u=null,x._indicator(),x.reorderIndicator&&(x.reorderIndicator.remove(),x.reorderIndicator=null),x.start=null,aR(aM).off(x._eventNS),aQ.selection(!0),w&&!w.cancel&&(delete w.cancel,delete w.commandName,v.dataSource.read(),v.trigger(bA,w))},_detachDocumentEvents:function(){var a=this;a._moveProxy=a._upProxy=null,aR(aM).off(a._eventNS)},destroy:function(){var b=this;b.dataField=null,b._detachDocumentEvents(),b._events(!1)}}),bw=aB.extend({options:{ns:".shieldGridColumnGroupReorder",returnDuration:150,returnEasing:"ease-out",dragTreshold:20,draggedTemplate:"<div class='sui-grid sui-grid-core'><div class='sui-gridheader'><table class='sui-table'><thead><tr class='sui-columnheader'><th class='sui-headercell'>{0}</th></tr></thead></table></div></div>"},init:function(c){var d=this;d.grid=c,d.options=aK(!0,{},aY.fn.options),d._eventNS=d.options.ns+ap(),d._events(!0),c.headerTable.addClass("sui-reorderable")},_events:function(f){var e=this,c=e.grid.element;f?(e._downProxy=aP(e._down,e),c.on(au+e._eventNS,".sui-headercell",e._downProxy)):(c.off(au+e._eventNS,".sui-headercell",e._downProxy),e._downProxy=null)},_down:function(u){var v=this,t=aR(u.target).closest(".sui-headercell"),c=t.offset(),s=v.grid.element,b=s.offset(),p=u.pageX,d=u.pageY;if(!(u.button>1)){var a=t.attr("data-field"),q=v.grid.dataSource.group;if(q){for(var r=0;r<q.length;r++){if(a===q[r].field){return}}}return aR(aM).on(at+v._eventNS,aP(v._move,v)).on(bh+v._eventNS,aP(v._up,v)),v.start={left:p-c.left,top:d-c.top,x:p,y:d,target:t,index:1000,positions:v._positions(t),gridPosition:{left:b.left,top:b.top,width:s.outerWidth(),height:s.outerHeight()},isRtl:ax.isRtl(s)},aQ.selection(!1),!1}},_move:function(m){var p=this,l=p.options,k=p.dragged,a=p.start,o=m.pageX,n=m.pageY,d=l.dragTreshold;k?(k.css({left:o-a.left,top:n-a.top}),p.hovered=p._index(o,n),p._indicator()):(aq(a.x-o)>d||aq(a.y-n)>d)&&(p.dragged=aR(aD(l.draggedTemplate,a.target.html())).css({position:"absolute",left:o-a.left,top:n-a.top,zIndex:999}).find("table").css("width","auto").end().find("th").attr("style",a.target[0].style.cssText).css({width:a.target.width(),height:a.target.height()}).end().appendTo(aM.body))},_positions:function(i){var h,g,k=this.grid.element.find(".sui-group-panel-indicator"),l=0,j=[];for(l;l<k.length;l++){h=k.eq(l),g=h.offset(),j.push({left:g.left,top:g.top,width:h.outerWidth(),height:h.outerHeight()}),l==k.length-1&&j.push({left:g.left,top:g.top,width:h.outerWidth(),height:h.outerHeight()})}return j},_index:function(s,r){var q,o,l,m,k,n=this.start,p=n.gridPosition,t=this.grid.element.find(".sui-group-panel");if(n.positions.length>0){for(o=0;o<n.positions.length;o++){if(q=n.positions[o],l=q.left<=s&&s<=q.left+q.width&&q.top<=r&&r<=q.top+q.height,k=p.left<=s&&s<=p.left+p.width&&p.top<=r&&r<=p.top+p.height,m=t.offset().left<=s&&s<=t.offset().left+t.width()&&t.offset().top<=r&&r<=t.offset().top+t.height(),l&&k){return o}}}else{m=t.offset().left<=s&&s<=t.offset().left+t.width()&&t.offset().top<=r&&r<=t.offset().top+t.height()}return m?(this.isOnGroupPanel=!0,this.grid.element.find(".sui-group-panel-indicator").length):-1},_indicator:function(){var o,q=this,t=q.start,s=q.hovered,p=t.positions[s],r=q.reorderIndicator,m=t.gridPosition.left,a=t.gridPosition.left+t.gridPosition.width,d=t.target.parent().children(".sui-group-panel-indicator"),n=t.isRtl?t.index<s:t.index>s;d.removeClass("sui-reorder-target"),r&&r.hide(),null!=s&&s>-1&&(d.eq(s).addClass("sui-reorder-target"),r||(r=q.reorderIndicator=aR("<div class='sui-grid-reorder-indicator'><span class='sui-grid-indicator-top' /><span class='sui-grid-indicator-bottom' /></div>").appendTo(aM.body)),this.isOnGroupPanel&&(n=!1),p?(o=p.left+(n?0:p.width),this.isOnGroupPanel=null,r.css({left:ay(az(m,o),a),top:p.top,height:p.height}).show()):(o=m+(n?t.gridPosition.width:0),this.isOnGroupPanel=null,r.css({left:o,top:t.gridPosition.top,height:q.grid.element.find(".sui-group-panel-empty").outerHeight()}).show()))},_up:function(a){var q,r=this,d=r.options,k=r.grid,e=r.dragged,p=r.start,o=r.hovered;if(e){if(e.css({left:p.x-p.left,top:p.y-p.top,transition:aD("left {0} {1}ms, top {0} {1}ms",d.returnEasing,d.returnDuration)}),null!=o&&o>-1){e.remove();var b=p.target.attr("data-field");q=k.trigger(aL,{commandName:bt,cancel:!1,field:b,index:o}),q.cancel||k.group(b,o,"asc")}else{setTimeout(function(){e.remove()},ax.transitions?d.returnDuration:0)}}r.dragged=r.hovered=o=null,r._indicator(),r.reorderIndicator&&(r.reorderIndicator.remove(),r.reorderIndicator=null),r.start=null,aR(aM).off(r._eventNS),aQ.selection(!0),q&&!q.cancel&&(delete q.cancel,delete q.commandName,k.dataSource.read(),k.trigger(bt,q))},destroy:function(){this._events(!1),this.grid.headerTable.removeClass("sui-reorderable")}}),aY=aB.extend({options:{ns:".shieldGridColumnReorder",returnDuration:150,returnEasing:"ease-out",dragTreshold:20,draggedTemplate:"<div class='sui-grid sui-grid-core'><div class='sui-gridheader'><table class='sui-table'><thead><tr class='sui-columnheader'><th class='sui-headercell'>{0}</th></tr></thead></table></div></div>"},init:function(c){var d=this;d.grid=c,d.options=aK(!0,{},aY.fn.options),d._eventNS=d.options.ns+ap(),d._events(!0),c.headerTable.addClass("sui-reorderable")},_events:function(f){var e=this,c=e.grid.element;f?(e._downProxy=aP(e._down,e),c.on(au+e._eventNS,".sui-headercell",e._downProxy)):(c.off(au+e._eventNS,".sui-headercell",e._downProxy),e._downProxy=null)},_down:function(n){var p=this,o=aR(n.target).closest(".sui-headercell"),d=o.offset(),m=p.grid.element,c=m.offset(),b=n.pageX,a=n.pageY;if(!(n.button>1)){return aR(aM).on(at+p._eventNS,aP(p._move,p)).on(bh+p._eventNS,aP(p._up,p)),p.start={left:b-d.left,top:a-d.top,x:b,y:a,target:o,index:o.parent().find(".sui-headercell").index(o),positions:p._positions(o),gridPosition:{left:c.left,top:c.top,width:m.outerWidth(),height:m.outerHeight()},isRtl:ax.isRtl(m)},aQ.selection(!1),!1}},_move:function(m){var p=this,l=p.options,k=p.dragged,a=p.start,o=m.pageX,n=m.pageY,d=l.dragTreshold;k?(k.css({left:o-a.left,top:n-a.top}),p.hovered=p._index(o,n),p._indicator()):(aq(a.x-o)>d||aq(a.y-n)>d)&&(p.dragged=aR(aD(l.draggedTemplate,a.target.html())).css({position:"absolute",left:o-a.left,top:n-a.top,zIndex:999}).find("table").css("width","auto").end().find("th").attr("style",a.target[0].style.cssText).css({width:a.target.width(),height:a.target.height()}).end().appendTo(aM.body))},_positions:function(i){var h,l,k=i.parent().children(".sui-headercell"),g=0,j=[];for(g;g<k.length;g++){h=k.eq(g),l=h.offset(),j.push({left:l.left,top:l.top,width:h.outerWidth(),height:h.outerHeight()})}return j},_index:function(o,n){var j,p,l,k,m=this.start,i=m.gridPosition;for(p=0;p<m.positions.length;p++){if(j=m.positions[p],l=j.left<=o&&o<=j.left+j.width&&j.top<=n&&n<=j.top+j.height,k=i.left<=o&&o<=i.left+i.width&&i.top<=n&&n<=i.top+i.height,l&&k){return p}}return -1},_indicator:function(){var o,q=this,t=q.start,s=q.hovered,p=t.positions[s],r=q.reorderIndicator,m=t.gridPosition.left,d=t.gridPosition.left+t.gridPosition.width,n=t.target.parent().children(".sui-headercell"),a=t.isRtl?t.index<s:t.index>s;n.removeClass("sui-reorder-target"),r&&r.hide(),null!=s&&s>-1&&(n.eq(s).addClass("sui-reorder-target"),r||(r=q.reorderIndicator=aR("<div class='sui-grid-reorder-indicator'><span class='sui-grid-indicator-top' /><span class='sui-grid-indicator-bottom' /></div>").appendTo(aM.body)),s!==t.index&&(o=p.left+(a?0:p.width),r.css({left:ay(az(m,o),d),top:p.top,height:p.height}).show()))},_up:function(a){var o,p=this,d=p.options,b=p.grid,e=p.dragged,n=p.start,k=p.hovered;e&&(e.css({left:n.x-n.left,top:n.y-n.top,transition:aD("left {0} {1}ms, top {0} {1}ms",d.returnEasing,d.returnDuration)}),null!=k&&k>-1?(e.remove(),o=b.trigger(aL,{commandName:ac,cancel:!1,index:n.index,newIndex:k}),o.cancel||b.reorderColumn(n.index,k)):setTimeout(function(){e.remove()},ax.transitions?d.returnDuration:0)),p.dragged=p.hovered=k=null,p._indicator(),p.reorderIndicator&&(p.reorderIndicator.remove(),p.reorderIndicator=null),p.start=null,aR(aM).off(p._eventNS),aQ.selection(!0),o&&!o.cancel&&(delete o.cancel,delete o.commandName,b.trigger(ac,o))},destroy:function(){this._events(!1),this.grid.headerTable.removeClass("sui-reorderable")}}),bx=a0.extend({init:function(){a0.fn.init.apply(this,arguments);var b=this;b._eventNS=".shieldGrid"+b.getInstanceId(),b.refresh(),b._dM()},destroy:function(){this._destroyInternal(),a0.fn.destroy.call(this)},_destroyInternal:function(){var j,i,h,a=this,g=(a.options,a._eventNS);if(a.contentWrapper){if(a._markedCells){for(i in a._markedCells){a._markedCells.hasOwnProperty(i)&&(a._markedCells[i].length=0)}a._markedCells=null}for(aR(an).off(aS+a._rsNS),a._resize=a._rsNS=null,a.sorting&&(a.sorting.destroy(),a.sorting=null),a.virtualizedContainer&&(a.virtualizedContainer.destroy(),a.virtualizedContainer=null),j=0;j<a.columns;j++){a.columns[j].destroy()}if(a.contentWrapper&&a.contentWrapper.off(aN,a._hScrollHandler),a._hScrollHandler=a.scrollableWrapper=null,a._selectable&&(a._selectable.destroy(),a._selectable=null),a.options.scrolling?(a.contentWrapper.parent().remove(),a.headerWrapper.parent().remove()):(a.contentWrapper.remove(),a.headerWrapper.remove()),a._hasDetailTemplate()&&(a.contentTable.off(aE,".sui-expand-cell",a._toggleDetailTemplateHandler).off(aE,".sui-collapse-cell",a._toggleDetailTemplateHandler),a._toggleDetailTemplateHandler=null),a.popupWindow&&a.popupWindow.destroy(),a._gridColumns&&(a._gridColumns.length=0),a.columns=a._gridColumns=a._windowEditingIndex=a.contentWrapper=a.headerWrapper=a.contentTable=a.hederTable=null,a._buttons){for(j=0;j<a._buttons.length;j++){h=a._buttons[j].button.element,a._buttons[j].button.destroy(),h.remove()}a._buttons.length=0}a.pager&&(a.pager.destroy(),a.pager=null,a.pagerWrapper&&(a.pagerWrapper.parent().remove(),a.pagerWrapper=null)),a.loadingPanel&&(a.loadingPanel=null,clearTimeout(a.loadingPanelTimeout),a.loadingPanelTimeout=null),a._columnResizing&&(a._columnResizing.destroy(),a._columnResizing=null),a._toolbar&&(a._toolbar.destroy(),a._toolbar=null),a._editing&&(a._editing.destroy(),a._editing=null),a._columnReorder&&(a._columnReorder.destroy(),a._columnReorder=null),a._sortingInProgress=a._scrollLeft=a._scrollTop=a._populateInsertedItem=a._preventClosingEditors=a._editingInProcess=null,a._filter&&(a._filter.destroy(),a._filter=null),a._groupReorder&&(a._groupReorder.destroy(),a._groupReorder=null),a._columnGroupReorder&&(a._columnGroupReorder.destroy(),a._columnGroupReorder=null),a.dataSource.off(g),a.element.removeClass("sui-grid sui-grid-core").css(a3,"").empty()}},_dM:function(){var a=function(c){return aR("<div/>").html(c).text()},f="&#68;&#101;&#109;&#111;&#32;&#86;&#101;&#114;&#115;&#105;&#111;&#110;",d=aM.createTextNode(a(f));aR(d).insertAfter(aR(this.element))},_resizeHandler:function(){this.options.scrolling&&this._scrolling()},_hasDetailTemplate:function(){var b=this.options;return b.detailTemplate||b.events&&b.events.detailCreated},_hasVirtualScrolling:function(){var b=this.options;return b.scrolling&&b.scrolling.virtual&&!b.paging&&!this._hasDetailTemplate()},_canExpandCollapse:function(){return this.options.detailExpandCollapse!==!1},_resolveColumns:function(b){var d=this.columns=[];aw.array(b)?bo(b,function(c,e){d.push(new bu(e))}):aQ.error("Invalid columns declaration. The columns have to be array.",this.options.dieOnError)},_createWrappers:function(){var a=this,f=a.element;a._wrapper();var h=aR("<div />").prependTo(f);h.addClass("sui-gridcontent");var g=aR("<div />").prependTo(f);g.addClass("sui-gridheader"),a.options.showHeader||(g.css(ao,ar),h.addClass("sui-no-header")),a.headerWrapper=g,a.contentWrapper=h},_wrapper:function(){var c=this.options.height,d=this.element;d.is("div")||(d=d.wrap("<div/>").parent()),d.addClass("sui-grid sui-grid-core"),d&&d.css(a3,c)},_createGroupPanel:function(){var m,j,l,a=this,i=!1,n=a.dataSource;if(l=a.element.find(".sui-group-panel"),l.length>0&&l.remove(),a.options.grouping.showGroupHeader){if(n.group&&0!==n.group.length){m=aR("<div class='sui-group-panel' />"),a.element.prepend(m);for(var k=0;k<n.group.length;k++){j=n.group[k],a._createGroupHeaderIndicator(j,m),i=!0}i&&a.options.grouping.allowDragToGroup&&(a._groupReorder&&a._groupReorder.destroy(),a._groupReorder=new bv(a),a._columnGroupReorder&&a._columnGroupReorder.destroy(),a._columnGroupReorder=new bw(a))}else{a.element.prepend(aR("<div class='sui-group-panel sui-group-panel-empty' >"+a.options.grouping.message+"</div>"))}}},_createGroupHeaderIndicator:function(k,c){var j,i,l,a=this;l=aR('<div class="sui-group-panel-indicator" data-field="'+k.field+'"/>').appendTo(c),i="desc"==k.order?aR('<span class="sui-descending">&#9660;</span>').appendTo(l):aR('<span class="sui-ascending">&#9650;</span>').appendTo(l),aR('<span class="sui-group-title">'+k.field+"</span>").appendTo(l),a.options.grouping.allowDragToGroup&&(j=aR('<span class="sui-group-close-button">&#10006;</span>').appendTo(l),j.on(aE,a._closeButtonClicked=aP(a._closeButtonClickedHandler,a))),i.on(aE,a._sortButtonClicked=aP(a._sortButtonClickedHandler,a))},_sortButtonClickedHandler:function(i){for(var k=this,j=aR(i.currentTarget),h=j.parent().attr("data-field"),l=k.dataSource.group,a=0;a<l.length;a++){l[a].field==h&&(j.hasClass("sui-descending")?l[a].order="asc":l[a].order="desc",k.dataSource.read())}},_closeButtonClickedHandler:function(h){var j,a=this,e=aR(h.currentTarget),i=e.parent().attr("data-field");a.dataSource.group&&(j=a.trigger(aL,{commandName:bg,cancel:!1,field:i}),j.cancel||(a.ungroup(i),a.trigger(bg,j)))},_createHeaderTable:function(){var f=this,e=f.headerWrapper,a=f.element;a.is("table")||(a=e.children("table"),a.length||(a=aR("<table/>").appendTo(e))),am&&a.attr("cellspacing",0),a.addClass("sui-table"),f.headerTable=a,f._createTbody(a,!0),f._createThead(a,!0),f._createFakeRow(a,f.columns.length)},_createContentTable:function(){var a=this,c=a.options,g=a.contentWrapper,h=a.element;h.is("table")||(h=g.children("table"),h.length||(h=aR("<table />").appendTo(g))),am&&h.attr("cellspacing",0),h.addClass("sui-table"),c.rowHover&&h.addClass("sui-hover"),a._hasDetailTemplate()&&(a._canExpandCollapse()&&h.addClass("sui-expandable"),h.on(aE,"> tbody > tr > .sui-expand-cell",a._toggleDetailTemplateHandler=aP(a._expandCollapseDetailTemplate,a)),h.on(aE,"> tbody > tr > .sui-collapse-cell",a._toggleDetailTemplateHandler)),a.contentTable=h,a._createTbody(a.contentTable,!1)},_createTbody:function(f,e){var a=f.find("> tbody");a.length||(a=aR("<tbody/>").appendTo(f)),e&&a.addClass("sui-hide"),f.tbody=a},_createThead:function(q){var s,m,v,o,u,p=this,r=(p.options,p.columns),n="",t=q.find(">thead");if(t.length||(t=aR("<thead/>").insertBefore(q.tbody)),v=q.find("tr:has(th):first"),v.length||(v=t.children().first(),v.length||(v=aR("<tr/>"))),!v.children().length){for(s=0,m=r.length;m>s;s++){u=r[s],o=u.headerTemplate||u.title||u.field||u,n+="<th "+ad(u.headerAttributes)+' data-field="'+r[s].field+'">'+o+"</th>"}v.html(n)}if(v.addClass("sui-columnheader"),v.find("th").addClass("sui-headercell"),r.length&&p._hasDetailTemplate()&&p._canExpandCollapse()){var a=aR('<th class="sui-indent-cell" />');am&&a.html("&nbsp;"),a.prependTo(v)}v.appendTo(t),q.thead=t},_createFakeRow:function(h,g){var a=h.find(">tbody");if(a.length){for(var j=aR("<tr/>"),i=0;g>i;i++){aR("<td/>").appendTo(j)}j.appendTo(a)}},_createColgroup:function(m){var o,l,a,n=this,j=n.options,k=n.columns,p=m.find(">colgroup");for(p.length||(p=aR("<colgroup/>").prependTo(m)),p.html(""),j.columns.length&&n._hasDetailTemplate()&&n._canExpandCollapse()&&aR("<col class='sui-indent-col'/>").appendTo(p),o=0,l=k.length;l>o;o++){a=k[o].width,aR(a&&0!==parseInt(a,10)?aD('<col style="width:{0}"/>',bl(a)?a:a+"px"):"<col />").appendTo(p)}},_scrolling:function(){var A,x,w,b,C=this,c=C.element,y=C.dataSource,h=C._hasVirtualScrolling(),z=C.headerWrapper,B=C.contentWrapper,p=z.outerHeight();if(z.parent().hasClass("sui-gridheader sui-scrolldiv")?p=z.parent().outerHeight():(z.addClass("sui-headercontent").removeClass("sui-gridheader"),z.wrap("<div class='sui-gridheader sui-scrolldiv'></div>"),B.addClass("sui-content").removeClass("sui-gridcontent"),B.wrap("<div class='sui-gridcontent sui-scroller'></div>"),am&&(C.headerTable.addClass("sui-table-ie7").removeClass("sui-table"),C.contentTable.addClass("sui-table-ie7").removeClass("sui-table")),aR(C.element).find(".sui-scrolldiv").css(ax.isRtl(c)?"padding-left":"padding-right",ax.scrollbar()-1),x=C.scrollableWrapper=h?B.parent():B,x.on(aN,C._hScrollHandler=aP(C._hscroll,C)),C.element.find(".sui-header-locked").prependTo(C.element.find(".sui-gridheader")),C.element.find(".sui-content-locked").prependTo(C.element.find(".sui-gridcontent"))),A=c.innerHeight()-p,C.pagerWrapper&&(A-=C.pagerWrapper.outerHeight()),C._toolbar){var v,a=C.element.find(".sui-toolbar"),F=0;for(v=0;v<a.length;v++){F+=aR(a[0]).outerHeight()}A-=F+1}var E=C.element.find(".sui-group-panel");if(E.length>0&&(A-=E.outerHeight()),aR(B).add(B.parent()).css({height:A,width:"100%"}),h&&y.view&&y.view.length){C.virtualizedContainer?(C.virtualizedContainer.options.total=y.total,C.virtualizedContainer.render()):(w=C._renderRow(0,C.contentTable.tbody,aI),b=w.outerHeight(),w.remove(),C.virtualizedContainer=new aQ.ui.VirtualizedContainer(x,{itemHeight:b,total:y.total,createContainer:function(d){return d.addClass("sui-content").append(C.contentTable).find("tbody").empty()},getItems:aP(C._loadVirtualRows,C),skipRender:!0}),C.virtualizedContainer.render()),C.contentWrapper=C.virtualizedContainer.element.children().eq(0)}else{if(bn&&!am&&!ab){var D=B.get(0);D.scrollWidth<=D.clientWidth&&B.css(a3,A+1)}}},_loadVirtualRows:function(p,o,n){var t=this,s=t.dataSource,m=null!=s.skip?s.skip:0,l=null!=s.take?s.take:s.view.length,k=100,q=t.virtualizedContainer.container;if(!t._sortingInProgress&&s.remote&&(m>p||o>=m+l)){clearTimeout(t._loadWaitTimeout),t._loadWaitTimeout=setTimeout(function(d,b,a){return function(){t._loadWaitTimeout=null,s.skip=d,s.take=b-d,t._loadingVirtualRows=!0,s.read().then(function(){if(!t._loadWaitTimeout){q.empty();for(var c=d;b>c&&c<s.total;c++){t._renderRow(c-d,q,s.view[c-d])}s.one(aG,function(){t._loadWaitTimeout||(t._loadingVirtualRows=!1)}),t.loading(!1),a([],!1)}})}}(p,o,n),k)}else{q.empty();for(var r=p;o>r&&r<s.total;r++){t._renderRow(r,q,s.view[r])}n([],!1)}t._checkIfVerticalScroll()},_checkIfVerticalScroll:function(){var f=this,e=f.element.find(".sui-virtualized").get(0),h=f.element.get(0),g=e.scrollHeight>h.scrollHeight;g?(f.headerWrapper.parent().css("padding-right","16px"),f.headerWrapper.removeClass("sui-grid-no-gap")):(f.headerWrapper.parent().css("padding-right","0px"),f.headerWrapper.addClass("sui-grid-no-gap"))},_hscroll:function(k){var j=this,o=j.scrollableWrapper,i=o.get(0),n=j.headerWrapper,p=o.scrollLeft(),l=n.scrollLeft();if(ax.isRtl(j.element)&&aT&&i.clientHeight<i.scrollHeight&&(p+=i.offsetWidth-i.clientWidth),p!=l){n.scrollLeft(p);var m=j.element.find(".sui-footer-content");m.length>0&&m.scrollLeft(p)}},_sorting:function(){var d=this,c=d.options.sorting;d.element;c&&d.columns.length&&(d.sorting=new aj(c,d))},_renderData:function(){var p,o,r=this,n=r.dataSource.view,q=r.options;q.scrolling,aJ(q.altRows)?!0:q.altRows,q.rowTemplate,q.altRowTemplate,r.contentTable;if(!r._loadingVirtualRows&&(o=r.trigger(aL,{commandName:aW,cancel:!1}),!o.cancel)){r._sortingInProgress?r._updateGrid():(r.columns.length||(p=[],n.length&&bo(n[0],function(d,c){p.push(d)}),q.columns=p,r._resolveColumns(p),r._createThead(r.headerTable,!0)),r._createColgroup(r.headerTable)),r._createColgroup(r.contentTable),r._sortingInProgress=!1,r._renderRows(),r._renderFooter();var m=function(c){return aR("<div/>").html(c).text()},g=m("&#83;&#104;&#105;&#101;&#108;&#100;&#85;&#73;");r.loading(!1);var e=m("&#104;&#116;&#116;&#112;&#58;&#47;&#47;&#119;&#119;&#119;&#46;&#115;&#104;&#105;&#101;&#108;&#100;&#117;&#105;&#46;&#99;&#111;&#109;");r.trigger(aW);var a=e;r.dmL||(r.dmL=aR('<a href="'+a+'" target="_blank"> by '+g+"</a>"),aR(r.dmL).css({color:"grey","text-decoration":"none"}).insertAfter(aR(this.element)))}},_renderRows:function(){var n,p,r=this,q=r.options,l=r.dataSource,o=l.view,m=r.contentTable;if(r._markedCells){for(var g in r._markedCells){r._markedCells.hasOwnProperty(g)&&(r._markedCells[g].length=0)}r._markedCells=null}if(m.tbody.empty(),!o||!o.length){return aJ(q.noRecordsTemplate)?aR("<tr><td colspan='"+r.columns.length+"'>"+(q.noRecordsText||"No records to display")+"</td></tr>").appendTo(m.tbody):aR("<td></td>").append(q.noRecordsTemplate).wrap("<tr></tr>").parent().appendTo(m.tbody),void r._initScrolling(q)}if(!r._hasVirtualScrolling()||r._sortingInProgress){if(p=l.group,p&&p.length>0){var a=0;for(r._renderGroupedData(o,a,0),r.headerTable.find(">colgroup").find(".sui-indent-col").remove(),r.headerTable.thead.find(".sui-columnheader > .sui-indent-cell").remove(),n=0;n<p.length;n++){aR("<col class='sui-indent-col'/>").prependTo(r.headerTable.find(">colgroup")),aR("<col class='sui-indent-col'/>").prependTo(r.contentTable.find(">colgroup")),aR("<th class='sui-indent-cell'/>").prependTo(r.headerTable.thead.find(".sui-columnheader"))}r._addAllIntendCells(),r.contentTable.addClass("sui-grouped-table")}else{r._renderRowsAndDetails(o)}}r._createGroupPanel(),r._initScrolling(q)},_initScrolling:function(b){b.scrolling&&!this._sortingInProgress&&this._scrolling()},_addAllIntendCells:function(){for(var a,h=this,i=h.contentTable.get(0).rows,k=0;k<i.length;k++){var l=aR(i[k]),j=parseInt(l.attr("data-group-level"),10);if(l.hasClass("sui-group-header")){if(j>1){for(a=0;j-1>a;a++){aR("<td class='sui-indent-cell'/>").prependTo(l)}}}else{for(a=0;j>a;a++){aR("<td class='sui-indent-cell sui-group-intend-cell'/>").prependTo(l)}}}},_renderGroupedData:function(i,k,g){var l=this;l.options.detailExpandCollapse=!1;for(var j=0;j<i.length;j++){var h=i[j];h.hasOwnProperty("field")&&h.hasOwnProperty("items")&&h.hasOwnProperty("value")&&h.hasOwnProperty("order")?(g++,l._renderGroupHeader(h,g),l._renderGroupedData(h.items,k,g),l._renderGroupAggregates(h),g--):(l._renderDataItem(h,k,g),k++)}},_renderGroupAggregates:function(k){if(k.aggregate){var s,v,i,z,t,w=this,u=w.columns,r={},x=k.aggregate;for(z=0;z<u.length;z++){if(v=u[z].groupFooterTemplate){s=aR("<tr class='sui-group-footer' />").appendTo(w.contentTable.tbody);break}}if(s){for(z=0;z<u.length;z++){if(t=aR("<td class='sui-group-footer-cell' />").appendTo(s),v=u[z].groupFooterTemplate){i=u[z].field;for(var y=0;y<x.length;y++){x[y].field==i&&(av(x[y].aggregate)?r.custom=x[y].value:r[x[y].aggregate]=x[y].value)}if(av(v)){var q=v.call(w,t,r);aF(q)&&!a9(q)&&""!==q&&t.html(q)}else{t.html(aD.call(w,v,r))}}}var a=w.dataSource.group.length;for(z=0;a>z;z++){s.prepend(aR("<td class='sui-indent-cell' />"))}}}},_renderGroupHeader:function(p,o){var a=this,m=a.contentTable,l=a.columns.length+a.dataSource.group.length-o+1,j=aR("<tr class='sui-group-header' data-group-level='"+o+"' />").appendTo(m),n=aR("<td class='sui-group-header-cell' colspan='"+l+"' />").appendTo(j),c=aR("<span class='sui-collapse'>&#9662;</span>").appendTo(n);aR("<span class='sui-group-header-text'>"+p.field+": "+p.value+"</span>").appendTo(n),c.on(aE,a._expandCollapse=aP(a._expandCollapseHandler,a))},_expandCollapseHandler:function(e){var h,a=this,j=aR(e.currentTarget),i=j.parent().parent();j.hasClass("sui-collapse")?(h=a.trigger(aL,{commandName:bs,cancel:!1,row:i}),h.cancel||(a.collapseGroup(i),j.html("&#9656;"),j.removeClass("sui-collapse").addClass("sui-expand"),a.trigger(bs,{row:i}))):(h=a.trigger(aL,{commandName:aU,cancel:!1,row:i}),h.cancel||(a.expandGroup(i),j.html("&#9662;"),j.removeClass("sui-expand").addClass("sui-collapse"),a.trigger(aU,{row:i})))},_renderDataItem:function(f,j,i){var g=this,h=g.contentTable;g._renderRow(j,h,f).attr("data-group-level",i)},_renderRowsAndDetails:function(j){var i,g,f=this,h=f.contentTable;for(g=0,i=j.length;i>g;g++){f._renderRow(g,h.tbody,f.dataSource.view[g]),f._hasDetailTemplate()&&!f._canExpandCollapse()&&f._addDetailTemplate(j[g])}},_renderRow:function(i,O,R){var L,V,u,M,U=this,A=aF(O),T=U.options,K=aJ(T.altRows)?!0:T.altRows,P=K&&i%2&&T.altRowTemplate?T.altRowTemplate:T.rowTemplate,r=U.columns;if(P){bl(P)&&(P=P.replace(/^\s+/,"").replace(/\s+$/,"")),V=aR(aD(P,R)),A&&O.append(V)}else{if(V=aR("<tr class='"+(K&&i%2?"sui-alt-row":"sui-row")+"'/>"),arguments.length>3){var a=arguments[3],e=O.find("tr"),g=e.eq(a);e.length==a?O.append(V):V.insertBefore(g)}else{A&&O.append(V)}for(M=0;M<r.length;M++){var N,D,Q=r[M],J=Q.columnTemplate,I=Q.format,k=Q.field,x=Q.buttons,S=aR("<td "+ad(Q.attributes)+" class='sui-cell' />").appendTo(V);if(x){for(D=0;D<x.length;D++){U._buildButton(x[D],S,V.get(0).rowIndex)}}else{J?av(J)?(N=J.call(U,S,R,i),aF(N)&&!a9(N)&&""!==N&&S.html(N)):S.html(aD.call(U,J,R)):I?S.html(aD.call(U,I,k?bp(R,k):R)):S.html(""+bp(R,k))}Q.visible||S.css(ao,ar)}}return U._hasDetailTemplate()&&U._canExpandCollapse()&&(u=U.trigger(aL,{commandName:ak,cancel:!1,item:R}),u.cancel?L=aR("<td class='sui-cell sui-expand-cell-disabled' />"):(L=aR("<td class='sui-cell sui-expand-cell' />"),U._setExpandCollapseCellText(L,T.detailExpandText,T.detailCollapseText)),L.prependTo(V)),V},_renderFooter:function(){var F,y,E,r,I,J,A,H=this,D=H.columns,z={},G=H.dataSource.aggregates;for(I=0;I<D.length;I++){if(E=D[I].footerTemplate){if(H.options.scrolling&&H.options.scrolling.virtual){var k=aR("<div class='sui-footer' style='padding-right: 16px;' />").appendTo(H.element),i=aR("<div class='sui-footer-content' />").appendTo(k),x=aR("<table class='sui-table' />").appendTo(i),w=H.element.find(".sui-headercontent > table > colgroup > col"),a=aR("<colgroup />").appendTo(x);for(J=0;J<w.length;J++){aR(w[J].outerHTML).appendTo(a)}y=aR("<tbody />").appendTo(x)}else{y=aR("<tfoot />").appendTo(H.contentTable)}F=aR("<tr class='sui-grid-footer' />").appendTo(y);break}}if(F){for(I=0;I<D.length;I++){if(A=aR("<td class='sui-footer-cell' />").appendTo(F),E=D[I].footerTemplate){for(r=D[I].field,J=0;J<G.length;J++){G[J].field==r&&(av(G[J].aggregate)?z.custom=G[J].value:z[G[J].aggregate]=G[J].value)}if(av(E)){var B=E.call(H,A,z);aF(B)&&!a9(B)&&""!==B&&A.html(B)}else{A.html(aD.call(H,E,z))}}}var C=F.prev();(C.find(".sui-expand-cell").length>0||C.find(".sui-expand-cell-disabled").length>0||C.find(".sui-indent-cell").length>0||C.find(".sui-collapse-cell").length>0)&&F.prepend(aR("<td />"))}},_buildButton:function(p,m,c){var b,o=this,n=p.commandName,g=p.click;if(aQ.ui.Button){var a=aR("<button type='button'>"+p.caption+"</button>").appendTo(m);m.addClass("sui-button-cell"),"delete"===n?(g=o._deleteButtonClicked,aJ(p.cls)?p.cls="sui-delete":p.cls+=" sui-delete"):"edit"===n&&(o._editing&&(o._editing.type="row"),o._preventClosingEditors=!0,g=o._editButtonClicked,aJ(p.cls)?p.cls="sui-edit":p.cls+=" sui-edit"),b=new aQ.ui.Button(a,{cls:p.cls,events:{click:aP(g,o,c,m)}}),("delete"==n||"edit"==n)&&(o._buttons||(o._buttons=[]),o._buttons.push({index:c,button:b}))}},_deleteButtonClicked:function(e,i){var h=this,k=h.dataSource,l=h.options.editing?h.options.editing.confirmation:null,j=h.trigger(aL,{commandName:a5,cancel:!1,rowIndex:e});if(!j.cancel){if(l&&l["delete"]&&l["delete"].enabled&&!an.confirm(aD(l["delete"].template,k.view[e]))){return}k.removeAtView(e),h.options.editing&&!h.options.editing.batch&&k.save(!1),h.trigger(a5,{rowIndex:e})}},_editButtonClicked:function(e,k){var l=this,b=l._editing,j=l.dataSource,a=l.trigger(aL,{commandName:bc,cancel:!1,row:aR(k).parent(),cell:k});a.cancel||(l._editingInProcess=!0,j.tracker&&j.tracker.changes&&j.tracker.changes.added&&j.tracker.changes.added.length>0?j.cancel():"popup"!=l.options.editing.mode?(l._closeAllEditedRows(),b&&b.options.enabled&&b._putRowInEditMode(aR(l.contentTable.find("tbody > tr")[e])),l._changeEditColumnButtons(e,k)):aQ.ui.Window&&l._initializePopupForm(e),l.trigger(bc,{row:aR(k).parent(),cell:k}))},_initializePopupForm:function(D,C){var z,J,F,L=this,I=L._editing,y=L.dataSource;z=aR('<div class="sui-modal-popup-edit-window"></div>').appendTo(aM.body),J=aR('<div class="sui-edit-form-container"></div>'),F=L.options.columns;for(var E=0;E<F.length;E++){var K=F[E];if(K.editable!==!1&&K.field){var x=y.schema.options.fields[K.field].type,A=y.editView(D).data,G=bp(A,K.field);L._windowEditingIndex=D,aR('<div class="sui-edit-form-label"><label for="'+K.field+'">'+(K.caption?K.caption:K.field)+"</label></div>").appendTo(J);var H=aR('<div class="sui-edit-field"></div>').appendTo(J);if(K.editor){I._instantiateCustomEditor(K,H,A,0,!1,K.field)}else{switch(x){case Number:I._instantiateNumeric(H,G,!1,K.field);break;case Date:I._instantiateDatePicker(H,G,!1,K.field);break;case String:I._instantiateTextBox(H,G,!1,K.field);break;case Boolean:I._instantiateCheckBox(H,G,!1,K.field)}}}}var B=aR('<div class="sui-update-buttons sui-popup-buttons"></div>').appendTo(J),d=aR("<button type='button'>Save</button>").appendTo(B),c=aR("<button type='button'>Cancel</button>").appendTo(B);if(aQ.ui.Button){var b=new aQ.ui.Button(d,{events:{click:aP(L._updateButtonClicked,L)}}),a=new aQ.ui.Button(c,{events:{click:aP(L._cancelButtonClicked,L)}});L._buttons=[],L._buttons.push({index:10000,button:b}),L._buttons.push({index:10000,button:a})}J.appendTo(aM.body),L.popupWindow=new aQ.ui.Window(z,{title:C?"Insert":"Edit",draggable:{enabled:!1},events:{close:aP(L._cancelButtonClicked,L)},height:aR(".sui-edit-form-container").height()+57,modal:!0}),L.popupWindow.content(J),L.popupWindow.resize({width:aR(".sui-modal-popup-edit-window").width(),height:aR(".sui-edit-form-container").height()+66}),L.trigger(C?ag:al)},_changeEditColumnButtons:function(f,d){var e=this;e._removeButtons(d,f),e._buildButton({caption:"Update",click:e._updateButtonClicked},d,f),e._buildButton({caption:"Cancel",click:e._cancelButtonClicked},d,f),d.addClass("sui-update-buttons")},_removeButtons:function(h,g){for(var f=this,e=f._buttons.length;e--;){f._buttons[e].index==g&&(f._buttons[e].button.destroy(),f._buttons.splice(e,1))}h.removeClass("sui-update-buttons").empty()},_updateButtonClicked:function(d,f){var e=this;return aJ(e._windowEditingIndex)||(d=e._windowEditingIndex),e._updateItem(d,f),e._editing._errorDuringEdit?void (e._editing._errorDuringEdit=!1):(e._putRowInViewMode(d,f),void ("popup"===e.options.editing.mode&&e._removePopupWindow()))},_updateItem:function(q,e){var w,x,u,y,s,h,v,z=this,t=z.dataSource,r=(z.pager,[]),g=!0;if(t.group&&t.group.length>0&&"popup"!=z.options.editing.mode){for(s=z.contentTable.find(".sui-row, .sui-alt-row"),h=z.contentTable.find("tr").get(q),v=0;v<s.length;v++){if(s[v]==h){q=v;break}}}w=t.editView(q);for(y in w.data){w.data.hasOwnProperty(y)&&(null!=w.data[y]&&(g=!1),z._editing._editors[y]&&("custom"==z._editing._editors[y]?(u=z.trigger("getCustomEditorValue",{field:y,value:null}),x=u.value,z._editing._editors[y]=null):x=z._editing._editors[y].value?z._editing._editors[y].value():z._editing._editors[y].checked?z._editing._editors[y].checked():aI,w.data[y]!=x&&r.push(y),(aJ(x)||null==x)&&(x=z._getDefaultValue(y)),w.set(y,x)))}return z._editing._errorDuringEdit?void (r.length=0):(z._editing.options.batch||(u=z.trigger(aL,{commandName:a6,cancel:!1}),u.cancel||(t.save(!1),z.trigger(a6))),z._populateInsertedItem=g,r)},_getDefaultValue:function(h){var f,g=this,e=g.dataSource.schema;if(e&&e.options.fields){switch(e.options.fields[h].type){case Number:f=0;break;case Date:f=new Date;break;case String:f="";break;case Boolean:f=!1}}else{f=""}return f},_closeAllEditedRows:function(j){var i,h,a=this,g=a.contentTable.find(".sui-editable-cell");g.length>0&&(i=g.get(0).parentNode.rowIndex,h=a.contentTable.find(".sui-update-buttons").get(0),a._cancelButtonClicked(i,aR(h)),j&&j.length>0&&a._renderUpdateMarkers(j,i))},_cancelButtonClicked:function(n,m){var j=this,e=j.dataSource,k=j.trigger(aL,{commandName:a7,cancel:!1,rowIndex:n,cell:m});if(!k.cancel){if(e.tracker&&e.tracker.changes&&e.tracker.changes.added&&e.tracker.changes.added.length>0){e.cancel(),"popup"===j.options.editing.mode&&j._removePopupWindow()}else{if("popup"!=j.options.editing.mode){j._putRowInViewMode(n,m)}else{for(var o=j.options.columns,p=0;p<o.length;p++){var l=j._editing._editors[o[p].field];l&&(av(l.destroy)&&j._editing._editors[o[p].field].destroy(),delete j._editing._editors[o[p].field])}j._removePopupWindow()}}j.trigger(a7)}},_removePopupWindow:function(){var a=this;a._removeButtons(aR(".sui-window .sui-update-buttons"),10000),a.popupWindow.destroy(),aR(".sui-modal-popup-edit-window").remove()},_getRowIndex:function(b){return this.contentTable.find(".sui-row, .sui-alt-row").index(b)},_putRowInViewMode:function(B,t){var r,A,z,D,C=this,x=C.dataSource,v=C.contentTable,u=B;if(x.group&&x.group.length>0&&"popup"!=C.options.editing.mode){for(z=v.find(".sui-row, .sui-alt-row"),A=v.find("tr").get(B),D=0;D<z.length;D++){if(z[D]==A){u=D;break}}}r=x.editView(u).data,t&&"popup"!=C.options.editing.mode&&C._removeButtons(t,B),A=v.find("tr").get(B);var w=parseInt(aR(A).attr("data-group-level"),10);for(C._editing._destroyRow(B),A=C._renderRow(u,C.contentTable.tbody,r,B),D=0;w>D;D++){aR("<td class='sui-indent-cell sui-group-intend-cell'/>").prependTo(A)}if(w&&A.attr("data-group-level",w),C._editing.options.batch){var s=A.find(".sui-cell");if(C._markedCells&&C._markedCells[B]){var y,q,a=C._markedCells[B];for(D=0;D<a.length;D++){y=a[D],q=aR(s[y]).html(),aR(s[y]).html("<span class='sui-updated-marker' />"+q)}}}},_renderUpdateMarkers:function(m,o){var n,p,l,a=this,k=a.columns,j=a.contentTable.find("tbody > tr").eq(o).find(".sui-cell");for(n=0;n<m.length;n++){for(p=0;p<k.length;p++){k[p].field===m[n]&&(l=aR(j[p]).html(),aR(j[p]).html("<span class='sui-updated-marker' />"+l),a._markedCells?(a._markedCells[o]||(a._markedCells[o]=[]),a._markedCells[o].push(p)):(a._markedCells={},a._markedCells[o]=[],a._markedCells[o].push(p)))}}},_selection:function(){var d=this,c=d.options;c.selection&&(d._selectable=new ae(d.headerTable,d.contentTable,c.selection,d))},_filtering:function(){var d=this,c=d.options;c.filtering&&c.filtering.enabled&&(d._filter=new aH(d))},_paging:function(f){var b,h=this,a=h.element;aQ.ui.Pager&&f&&(a8(f)&&f instanceof aQ.ui.Pager?(h.pager=f,h.pager.dataSource=h.dataSource,h.pager.element.appendTo(a)):(b=aR("<div />").appendTo(a),b.addClass("sui-pager"),h.pagerWrapper=b,h.pager=new aQ.ui.Pager(b.get(0),aK({},f,{dataSource:h.dataSource}))))},_reorder:function(){var d=this,c=d.options;c.columnReorder&&(d._columnReorder=new aY(d))},_expandCollapseDetailTemplate:function(e){var a=this,f=aR(e.target).closest(".sui-row",a.contentTable);f.length||(f=aR(e.target).closest(".sui-alt-row",a.contentTable)),a._toggleDetailTemplate(f)},_toggleDetailTemplate:function(p){var o,a=this,l=a.contentTable.find("tr:first").parent().children().not(".sui-detail-row"),k=bj(p[0],l),j=a.dataSource.view,n=p.next(),m=a.options;n&&n.hasClass("sui-detail-row")?(n.toggle(),o=aR(p.get(0).cells[0]),a._toggleClasses(o,"sui-expand-cell","sui-collapse-cell"),a._setExpandCollapseCellText(o,m.detailExpandText,m.detailCollapseText)):a._addDetailTemplate(j[k],p)},_setExpandCollapseCellText:function(g,i,h){aJ(h)&&(h="-"),aJ(i)&&(i="+");var f=this.options.detailCollapseCssClass,j=this.options.detailExpandCssClass;f=aJ(f)?"":" class = '"+f+"'",j=aJ(j)?"":" class = '"+j+"'",g.hasClass("sui-collapse-cell")?g.html("<span"+f+">"+h+"</span>"):g.hasClass("sui-expand-cell")&&g.html("<span"+j+">"+i+"</span>")},_addDetailTemplate:function(m,q){var k,r=this,p=r.options,o=aR("<tr class='sui-detail-row'/>");r._canExpandCollapse()&&(k=aR("<td class='sui-cell sui-indent-cell'/>"),am&&k.html("&nbsp;"),k.appendTo(o));var n=aR('<td class="sui-detail-cell" colspan="'+r.columns.length+'"></td>'),a=r.trigger(aL,{commandName:ah,cancel:!1,detailCell:n,item:m});if(!a.cancel&&(n.appendTo(o),p.detailTemplate&&n.html(aD(p.detailTemplate,m)),q?o.insertAfter(q):o.appendTo(r.contentTable.tbody),r.trigger(ah,{detailCell:n,item:m}),q)){var e=aR(q.get(0).cells[0]);r._toggleClasses(e,"sui-expand-cell","sui-collapse-cell"),r._setExpandCollapseCellText(e,p.detailExpandText,p.detailCollapseText)}},_toggleClasses:function(e,d,f){e.hasClass(d)?(e.removeClass(d),e.addClass(f)):(e.removeClass(f),e.addClass(d))},_resizing:function(){var b=this;b.options.resizing&&b.options.scrolling&&(b._columnResizing=new aV(b))},_initToolbar:function(){var d=this,c=d.options;c.toolbar&&(d._toolbar=new aO(c.toolbar,d))},_initEditing:function(){var d=this,c=d.options;c.editing&&(d._buttons=[],d._editing=new bB(c.editing,d))},_refreshOnSort:function(){this._sortingInProgress=!0,this.dataSource.read()},_updateGrid:function(){var b=this,a=aQ.extend([aB],b.options,a);b.sorting&&(b.sorting.destroy(),b.sorting=null),b.headerWrapper.find(".sui-headercell .sui-link").each(function(f,g){var e=aR(g);e.parent().html(e.html())}),b.headerWrapper.find('.sui-headercell span[class^="sui-"]').remove(),b._sorting()},_dsStartHandler:function(){this.loading(!0)},refresh:function(s){var p,t=this,o=s?s.dataSource:null,m=t._eventNS;s=aQ.extend([aB],t.options,s),o&&(s.dataSource=o);var c,b=s.scrolling,a=t.pager?t.pager.options:s.paging,r=0;b&&t.contentWrapper&&(r=t.contentWrapper.get(0).scrollLeft),t._destroyInternal(),c=t.dataSource=aZ.create(s.dataSource),c.on(aG+m,aP(t._renderData,t)).on(by+m,aP(t._dsStartHandler,t)),t._resolveColumns(s.columns),t._createWrappers();for(var q=0;q<t.options.columns.length;q++){if(t.options.columns[q].locked){p=!0;break}}p&&(aR("<div class='sui-header-locked'>").appendTo(t.headerWrapper),aR("<div class='sui-content-locked'>").appendTo(t.contentWrapper)),t._createHeaderTable(),t._createContentTable(),t._initToolbar(),t._initEditing(),t._selection(),t._paging(a),t._resizing(),t._reorder(),t._filtering(),t.pager||t.dataSource.read(),t._sorting(),t._rsNS=".rs"+t.getInstanceId(),aR(an).on(aS+t._rsNS,t._resize=aP(t._resizeHandler,t)),r&&(t.contentWrapper.get(0).scrollLeft=r)},_createHeaderFrozenContainer:function(){},loading:function(g,f){var b=this,h=function(){b.loadingPanel&&b.loadingPanel.show()};aQ.ui.LoadingPanel&&(g?(b.loadingPanel||(b.loadingPanel=new aQ.ui.LoadingPanel(b.element.get(0))),f?h():b.loadingPanelTimeout=setTimeout(h,50)):b.loadingPanel&&(clearTimeout(b.loadingPanelTimeout),b.loadingPanelTimeout=null,b.loadingPanel.hide()))},select:function(a){var e=this,f=e._selectable;return a=bl(a)?e.contentTable.find(a):aR(a),a.length?(f.multiple||(f.clear(),a=a.first()),void f.select(a)):f.select()},selectedRowIndices:function(){var a=this,f=[],e=[];return a.contentTable.children("tbody").children(".sui-row, .sui-alt-row").each(function(b){aR(this).hasClass(aC)&&(f.push(b),e.push(a.dataSource.getDataIndex(b)))}),{view:f,data:e}},clearSelection:function(){this._selectable.clear()},sort:function(e,d,f){this.sorting&&this.sorting._sort(e,d,f)},_getItemRow:function(a){return aR(bD(a)?this.contentTable.children("tbody").children(".sui-row, .sui-alt-row").get(a):a)},expandRow:function(g){var f=this,e=f._getItemRow(g),h=e.next();h.hasClass("sui-detail-row")?h.css(ao)==ar&&f._toggleDetailTemplate(e):f._toggleDetailTemplate(e)},collapseRow:function(g){var e=this,f=e._getItemRow(g),h=f.next();h.hasClass("sui-detail-row")?h.css(ao)!=ar&&e._toggleDetailTemplate(f):(e._toggleDetailTemplate(f),f.next().toggle())},reorderColumn:function(t,s){var r,q=this,p=q.element,o=q.columns,n=q.options.columns||[],a=q.headerWrapper,m="before",l=a.find(".sui-indent-cell").length;if(t=+t,s=+s,isNaN(t)||isNaN(s)||0>t||0>s||t>o.length-1||s>o.length-1){throw new Error("Invalid index in column reorder.")}t!==s&&(s>t&&(m="after"),r=o.splice(t,1)[0],o.splice(s,0,r),r=n.splice(t,1)[0],n.splice(s,0,r),t+=l,s+=l,p.find(".sui-gridheader col:nth-child("+(t+1)+")").add(p.find(".sui-gridheader .sui-columnheader th:nth-child("+(t+1)+")")).add(p.find(".sui-gridcontent col:nth-child("+(t+1)+")")).add(p.find(".sui-gridcontent tr:not(.sui-detail-row) td:nth-child("+(t+1)+")")).each(function(){aR(this).parent().children().eq(s)[m](this)}))},addRow:function(b){return this.dataSource.add(aF(b)?b:{})},insertRow:function(c,d){return this.dataSource.insertView(c,aF(d)?d:{})},saveChanges:function(){this.dataSource.save()},revertChanges:function(){this.dataSource.cancel()},dataItem:function(b){return this.dataSource.view[b]},editCell:function(e,h){var f=this,g=f.contentTable.find("tbody > tr").eq(e).find("td").eq(h).get(0);f._editingInProcess=!0,f._editing._putCellInEditMode(g,e)},editRow:function(f){var a=this,e=a.contentTable.find("tbody > tr").eq(f).get(0);a._editingInProcess=!0,a._editing._putRowInEditMode(aR(e),0)},cancelEditing:function(){var h,g,a=this,f=a.contentTable.find(".sui-editable-cell");f.length>0&&(h=f.get(0).parentNode.rowIndex,g=a.contentTable.find(".sui-update-buttons").get(0),a._putRowInViewMode(h,aR(g)))},deleteRow:function(b){this.dataSource.removeAtView(b)},filter:function(){var f=this,e=f.dataSource,d=[].slice.call(arguments);return d.length>0?(e.filter=d[0],void e.read()):e.filter},group:function(g,i,l,k){var h=this,j=h.dataSource.group;j?j.splice(i,0,{field:g,order:l,aggregates:k}):(h.dataSource.group=[],h.dataSource.group.push({field:g,order:l,aggregates:k}))},ungroup:function(g){var f=this,e=f.dataSource.group;f.headerTable.thead.find(".sui-columnheader > .sui-indent-cell").remove();for(var h=0;h<e.length;h++){e[h].field==g&&(e.splice(h,1),0===e.length&&(f.dataSource.group=null),f.dataSource.read())}},collapseGroup:function(f){for(var e=!0,h=parseInt(f.attr("data-group-level"),10);e;){if(f=f.next().css(ao,ar),f.next().length>0){var g=parseInt(f.next().attr("data-group-level"),10);h>=g&&f.next().hasClass("sui-group-header")&&(e=!1)}else{e=!1}}},expandGroup:function(f){for(var e=!0,h=parseInt(f.attr("data-group-level"),10);e;){if(f=f.next().css(ao,""),f.hasClass("sui-group-header")&&f.find(".sui-expand").length>0){return}if(f.next().length>0){var g=parseInt(f.next().attr("data-group-level"),10);h>=g&&f.next().hasClass("sui-group-header")&&(e=!1)}else{e=!1}}},_getColumnByField:function(h){var f,g=this,e=g.columns||[];for(f=0;f<e.length;f++){if(e[f].field===h){return e[f]}}return aI},_getColumnIndexByField:function(h){var f,g=this,e=g.columns||[];for(f=0;f<e.length;f++){if(e[f].field===h){return f}}return -1},hideColumn:function(v){var w,x=this,t=x._getColumnByField(v),s=aR(x.element),n=aR(s.find(".sui-gridheader colgroup").first().find("col"));if(!x._gridColumns){var o=x.columns;for(x._gridColumns=[],w=0;w<o.length;w++){x._gridColumns.push({name:o[w].field,index:w,hidden:!1,col:null})}}if(t){if(!t.visible){return}t.visible=!1}var a=aR.grep(x._gridColumns,function(d,c){return d.name===v})[0],r=x._getRealIndex(a),q=n[r],p=aR(s.find("> .sui-gridcontent colgroup").first().find("col")[r]);for(w=0;w<x._gridColumns.length;w++){var u=x._gridColumns[w];if(u.name===v){u.hidden=!0,u.col=q,u.contentCol=p;break}}aR(q).remove(),aR(p).remove(),x._changeColumnVisibility(v,"hide")},_getRealIndex:function(a){var f=aR.grep(this._gridColumns,function(d,c){return !d.hidden}),e=aR.inArray(a,f);return e},_getNextVisibleColumnRealIndex:function(a){var h=aR.grep(this._gridColumns,function(b,d){return b.index>a.index&&!b.hidden})[0],g=aR.grep(this._gridColumns,function(d,c){return !d.hidden}),f=aR.inArray(h,g);return f},showColumn:function(r){var x=this,t=x._getColumnByField(r),v=aR(x.element),a=aR(v.find(".sui-gridheader colgroup").first().find("col")),n=aR(v.find("> .sui-gridcontent colgroup").first().find("col"));if(x._gridColumns){var w=aR.grep(x._gridColumns,function(d,c){return d.name===r})[0],s=w.col,p=w.contentCol,u=x._getNextVisibleColumnRealIndex(w),o=aR(v.find(".sui-gridheader colgroup").first()),q=aR(v.find("> .sui-gridcontent colgroup").first());if(-1===u?(o.append(s),q.append(q)):0===u?(aR(s).prependTo(o),aR(p).prependTo(q)):(aR(s).insertBefore(a[u]),aR(p).insertBefore(n[u])),w.hidden=!1,t){if(t.visible){return}t.visible=!0}x._changeColumnVisibility(r,"show")}},_changeColumnVisibility:function(j,n){var a,p,m=this,o=aR(m.element),l=o.find(".sui-columnheader").first(),k=m._getColumnIndexByField(j);for(l.length&&aR(l.find("th")[k])[n](),a=o.find("> .sui-gridcontent > table > tbody > tr"),0===a.length&&(a=o.find("> .sui-gridcontent > .sui-virtualized > table > tbody > tr")),p=0;p<a.length;p++){aR(a[p].cells[k])[n]()}},_getVisibleColumnFields:function(){return be(bf(this.columns,function(b){return b.visible}),function(b){return b.field})},exportExcel:function(){this._doExcelExport()},exportPdf:function(){this._doPdflExport()},_doExcelExport:function(){var u,x,t,i,v,r,f,q,w=this,e=w.options,h=[],s=[];bi&&(f=w.trigger(aL,{commandName:"exportExcel",cancel:!1,exportOptions:aK(!0,{},e.exportOptions)}),f.cancel||(w.loading(!0,!0),setTimeout(function(){u=aK(!0,{proxy:aI,excel:{fileName:"Untitled",fileFormat:"xlsx",noLegacyFallback:!1,author:aI,created:new Date,producer:aI,dataSource:aI,readDataSource:!1,columnFields:aI,header:{enabled:!0,style:{bold:!0},cells:aI},worksheet:{name:"Sheet1",columns:aI},worksheets:[],worksheetIndex:0}},f.exportOptions),x=u.excel,v=x.columnFields,v||(v=w._getVisibleColumnFields()),r=v.length,x.worksheet.columns||(x.worksheet.columns=be(v,function(b){return{autoWidth:!0}})),i=aK(!0,{},x.worksheet),x.header&&x.header.enabled&&(x.header.cells?s.push({cells:x.header.cells}):s.push({cells:be(v,function(a){var b=w._getColumnByField(a);return{type:String,value:aF(b)&&b.title?b.title:a,style:x.header.style}})})),t=aZ.create(x.dataSource?x.dataSource:w.dataSource),q=function(){var A,c,j,d,z=t.view||[],k=z.length,a=[];for(j=0;r>j;j++){a[j]=bp(t,"schema.options.fields."+v[j]+".type")}for(j=0;k>j;j++){var g,b,n=z[j],y=w.trigger(aL,{commandName:"exportExcelRow",cancel:!1,item:n,index:j,row:{}}),m=[];if(!y.cancel){for(g=aK(!0,{},y.row),d=0;r>d;d++){b={type:aF(g.type)?g.type:a[d],value:aF(g.value)?g.value:bp(n,v[d])},g.cells&&g.cells[d]&&aK(!0,b,g.cells[d]),m.push(b)}s.push({index:g.index,height:g.height,cells:m})}}i.rows=s,h=[].slice.call(x.worksheets),h.splice(x.worksheetIndex,0,i),c={created:x.created,author:x.author,worksheets:h},A="xml"==x.fileFormat?new bi.ExcelXMLSpreadsheet(c):new bi.OOXMLWorkbook(c),A.saveAs({fileName:x.fileName,forceExt:u.forceExt,proxy:u.proxy}),w.loading(!1)},x.readDataSource?t.read().always(q):q()},100)))},_doPdfExport:function(){var s,v,i,t,f,h,p,r,q,u=this,e=u.options;bi&&(h=u.trigger(aL,{commandName:"exportPdf",cancel:!1,exportOptions:aK(!0,{},e.exportOptions)}),h.cancel||(u.loading(!0,!0),setTimeout(function(){s=aK(!0,{proxy:aI,pdf:{fileName:"Untitled",author:aI,created:new Date,size:"a4",orientation:"portrait",fontSize:10,dataSource:aI,readDataSource:!1,columnFields:aI,header:{enabled:!0,cells:aI},margins:{left:72,top:72,bottom:72,right:72}}},h.exportOptions),v=s.pdf,t=v.columnFields,t||(t=u._getVisibleColumnFields()),f=t.length,v.header&&(q=!!v.header.enabled,v.header.cells&&(r=[].concat(v.header.cells))),aF(q)||(q=!0),aF(r)||(r=be(t,function(b){var d=u._getColumnByField(b);return{field:b,title:d.title||b,width:d.width||aI}})),i=aZ.create(v.dataSource?v.dataSource:u.dataSource),p=function(){var x,d,b,g,w=i.view||[],j=w.length,l=[],a=v.margins;for(x=0;j>x;x++){d=w[x],b=u.trigger(aL,{commandName:"exportPdfRow",cancel:!1,item:d,index:x,row:{}}),b.cancel||l.push(aK(!0,d,b.row))}g=new bi.PDFDocument({author:v.author,created:v.created}),g.addPage(v.size,v.orientation),g.table(a.left,a.top,l,r,{margins:a,printHeader:q,fontSize:v.fontSize}),g.saveAs({fileName:v.fileName,forceExt:s.forceExt,proxy:s.proxy}),u.loading(!1)},v.readDataSource?i.read().always(p):p()},100)))}});bx.defaults=bd,aQ.ui.plugin("Grid",bx)}(jQuery,shield,this);