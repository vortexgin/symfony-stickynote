var noteTPL='<div class="panel panel-default col col-md-2 col-xs-12"><div class="panel-heading"><input type="hidden" name="id"><input type="text" name="name" class="form-control" placeholder="Title"><a href="#" class="move"><i class="fa fa-arrows-alt"></i></a><a href="#" class="close"><i class="fa fa-window-close"></i></a></div><div class="panel-body"><textarea name="message" class="form-control" rows="3" placeholder="Content"></textarea></div><div class="panel-footer hide"><span class="updated"></span><button class="save btn btn-primary">Save</button></div></div>';var noteZindex=1;function deleteNote(){$(this).parent(".panel-heading").parent(".panel").hide("puff",{percent:133},250)}function saveNote(){var f=$(this).parent(".panel-footer").parent(".panel").find("input[name=id]"),b=$(this).parent(".panel-footer").parent(".panel").find("input[name=name]"),c=$(this).parent(".panel-footer").parent(".panel").find("textarea[name=message]");var d={name:b.val(),message:c.val()},e="POST",a="/api/v1/sticky";if(!empty(f.val())){e="PATCH";a+="/"+f.val()}$.ajax({url:a,method:e,data:d,beforeSend:function(){$("body").swidget().show()},complete:function(){$("body").swidget().hide()},success:function(h,i,g){toastr.success("Save success")},error:function(g){toastr.error(g.responseJSON.message)}})}function loadNote(){$.ajax({url:"/api/v1/sticky",method:"GET",beforeSend:function(){$("body").swidget().show()},complete:function(){$("body").swidget().hide()},success:function(b,c,a){b.sticky.forEach(function(e,d){newNote(e)},this)}})}function activeNote(){var a=$(this).parent().parent(".panel").find(".panel-footer");if(a.hasClass("hide")){a.removeClass("hide")}}function deactiveNote(){var a=$(this).find(".panel-footer");if(!a.hasClass("hide")){a.addClass("hide")}}function newNote(e){var f=e.id||"",c=e.name||"",d=e.message||"",a=e.updated_at||e.created_at;var b=$(noteTPL).hide().appendTo("#board").show("fade",300).draggable().on("dragstart",function(){$(this).css("z-index",++noteZindex)}).on("dragstop",function(){console.log($(this).offset())});b.find("input[name=id]").val(f);b.find("input[name=name]").val(c);b.find("textarea[name=message]").val(d);b.find(".updated").html(a);$(".close").click(deleteNote);$(".save").click(saveNote);$(".panel-heading input, .panel-body textarea").focus(activeNote)}$(document).ready(function(){$("body").shieldLoadingPanel({text:"loading..."});$("#board").height($(document).height());$("#addNew").click(newNote);loadNote();newNote({});return false});